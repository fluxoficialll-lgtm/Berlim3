import{u as e,a,r as i,j as r,c as t}from"./index-DHTLMDH8.js";import{m as o}from"./marketplaceService-i91M9rHq.js";import{p as n}from"./postService-D2IH4U_j.js";import{g as s}from"./idGenerator-C-_CWH9r.js";const l=[{id:"Eletrônicos",icon:"fa-mobile-screen",label:"Eletrônicos"},{id:"Moda",icon:"fa-shirt",label:"Moda"},{id:"Comida",icon:"fa-utensils",label:"Comida"},{id:"Casa",icon:"fa-couch",label:"Casa"},{id:"Automotivo",icon:"fa-car",label:"Automotivo"},{id:"Imóveis",icon:"fa-building",label:"Imóveis"},{id:"Serviços",icon:"fa-screwdriver-wrench",label:"Serviços"},{id:"Infoprodutos",icon:"fa-graduation-cap",label:"Infoprodutos"},{id:"Vagas de Emprego",icon:"fa-briefcase",label:"Empregos"}],d=()=>{const d=e(),c=a().state;null==c||c.type;const[p,u]=i.useState(""),[x,m]=i.useState(""),[f,g]=i.useState("Eletrônicos"),[h,b]=i.useState(""),[v,j]=i.useState(""),[w,y]=i.useState(null),[N,k]=i.useState(null),[C,S]=i.useState([]),[I,z]=i.useState(!1),E=i.useRef(null),A=i.useRef(null);return r.jsxs("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-hidden",children:[r.jsx("style",{children:"\n        * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }\n        header { display:flex; align-items:center; justify-content:space-between; padding:16px; background: #0c0f14; position:fixed; width:100%; top:0; z-index:10; border-bottom:1px solid rgba(255,255,255,0.1); height: 65px; }\n        header .back-btn { background:none; border:none; color:#fff; font-size:20px; cursor:pointer; padding-right: 15px; }\n        main { padding-top: 85px; padding-bottom: 40px; width: 100%; max-width: 600px; margin: 0 auto; padding-left: 20px; padding-right: 20px; flex-grow: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }\n        .section-label { font-size: 14px; font-weight: 600; color: #00c2ff; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.5px; }\n        .form-section { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); border-radius: 16px; padding: 20px; margin-bottom: 24px; }\n        .main-cover-upload { width: 100%; aspect-ratio: 16/9; background: #1a1e26; border: 2px dashed rgba(255,255,255,0.1); border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; overflow: hidden; position: relative; transition: 0.3s; }\n        .main-cover-upload img { width: 100%; height: 100%; object-fit: cover; }\n        .gallery-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; }\n        .gallery-item { width: 70px; height: 70px; border-radius: 8px; flex-shrink: 0; background: #111; position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }\n        .gallery-item img, .gallery-item video { width: 100%; height: 100%; object-fit: cover; }\n        .remove-media { position: absolute; top: 2px; right: 2px; background: rgba(0,0,0,0.7); color: #ff4d4d; border: none; width: 18px; height: 18px; border-radius: 50%; font-size: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; }\n        .input-group { margin-bottom: 20px; }\n        .input-wrapper input, .input-wrapper textarea, .input-wrapper select { width: 100%; background: #14171d; border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 14px; color: #fff; font-size: 15px; outline: none; transition: 0.3s; }\n        .cat-chip { padding: 8px 16px; border-radius: 20px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #aaa; font-size: 13px; white-space: nowrap; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 6px; }\n        .cat-chip.active { background: rgba(0,194,255,0.15); border-color: #00c2ff; color: #00c2ff; font-weight: 600; }\n        .submit-btn { width: 100%; padding: 16px; background: #00c2ff; color: #000; border: none; border-radius: 12px; font-weight: 700; font-size: 16px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,194,255,0.3); transition: 0.3s; }\n        .submit-btn:disabled { opacity: 0.6; cursor: not-allowed; }\n      "}),r.jsxs("header",{children:[r.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?d(-1):d("/marketplace")},className:"back-btn",children:r.jsx("i",{className:"fa-solid fa-arrow-left"})}),r.jsx("h1",{className:"text-lg font-bold",children:"Anunciar Produto"}),r.jsx("div",{style:{width:"20px"}})]}),r.jsx("main",{children:r.jsxs("form",{onSubmit:async e=>{var a,i;if(e.preventDefault(),p&&x&&w&&!I){z(!0);try{const e=t.getCurrentUser();if(!e)return;let r=w||"";N&&(r=await n.uploadMedia(N,"marketplace"));const l=[];let c;for(const a of C){const e=await n.uploadMedia(a.file,"marketplace");"video"!==a.type||c?l.push(e):c=e}const u=x.replace(/\./g,"").replace(",","."),m=parseFloat(u),g={id:s(),title:p,price:m,category:f,location:h,description:v,image:r,images:l,video:c,sellerId:e.id,sellerName:(null==(a=e.profile)?void 0:a.name)||"Usuário",sellerAvatar:null==(i=e.profile)?void 0:i.photoUrl,timestamp:Date.now(),soldCount:0};await o.createItem(g),d("/marketplace")}catch(r){alert("Erro ao publicar anúncio no servidor.")}finally{z(!1)}}},children:[r.jsxs("div",{className:"form-section",children:[r.jsx("div",{className:"section-label",children:"Fotos & Vídeo"}),r.jsxs("div",{className:"main-cover-upload",onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},children:[w?r.jsx("img",{src:w,alt:"Capa"}):r.jsxs("div",{className:"text-center text-gray-500",children:[r.jsx("i",{className:"fa-solid fa-camera block text-2xl mb-2"}),"Capa Principal"]}),r.jsx("input",{type:"file",ref:E,hidden:!0,accept:"image/*",onChange:e=>{var a;const i=null==(a=e.target.files)?void 0:a[0];if(i){k(i);const e=new FileReader;e.onload=e=>{var a;return y(null==(a=e.target)?void 0:a.result)},e.readAsDataURL(i)}}})]}),r.jsxs("div",{className:"gallery-scroll mt-4",children:[C.map((e,a)=>r.jsxs("div",{className:"gallery-item",children:["video"===e.type?r.jsx("video",{src:e.url}):r.jsx("img",{src:e.url}),r.jsx("button",{type:"button",className:"remove-media",onClick:()=>{return e=a,void S(a=>a.filter((a,i)=>i!==e));var e},children:r.jsx("i",{className:"fa-solid fa-xmark"})})]},a)),C.length<5&&r.jsx("div",{className:"gallery-item flex items-center justify-center cursor-pointer border-dashed",onClick:()=>{var e;return null==(e=A.current)?void 0:e.click()},children:r.jsx("i",{className:"fa-solid fa-plus text-gray-500"})}),r.jsx("input",{type:"file",ref:A,hidden:!0,accept:"image/*,video/*",multiple:!0,onChange:e=>{const a=e.target.files;if(!a)return;const i=Array.from(a).slice(0,5).map(e=>({file:e,url:URL.createObjectURL(e),type:e.type.startsWith("video/")?"video":"image"}));S(e=>[...e,...i])}})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsx("div",{className:"section-label",children:"Informações"}),r.jsx("div",{className:"input-group",children:r.jsx("div",{className:"input-wrapper",children:r.jsx("input",{type:"text",placeholder:"Título do Produto",value:p,onChange:e=>u(e.target.value),required:!0})})}),r.jsx("div",{className:"input-group",children:r.jsx("div",{className:"input-wrapper",children:r.jsx("input",{type:"text",placeholder:"Preço (Ex: 150,00)",value:x,onChange:e=>{let a=e.target.value;if(a=a.replace(/\D/g,""),""===a)return void m("");const i=parseFloat(a)/100;m(i.toLocaleString("pt-BR",{minimumFractionDigits:2}))},required:!0})})}),r.jsx("div",{className:"input-group",children:r.jsx("div",{className:"input-wrapper",children:r.jsx("select",{value:f,onChange:e=>g(e.target.value),children:l.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))})})}),r.jsx("div",{className:"input-group",children:r.jsx("div",{className:"input-wrapper",children:r.jsx("input",{type:"text",placeholder:"Cidade / Estado",value:h,onChange:e=>b(e.target.value),required:!0})})}),r.jsx("div",{className:"input-group",children:r.jsx("div",{className:"input-wrapper",children:r.jsx("textarea",{rows:3,placeholder:"Descrição detalhada",value:v,onChange:e=>j(e.target.value),required:!0})})})]}),r.jsx("button",{type:"submit",className:"submit-btn",disabled:!p||!x||!w||I,children:I?r.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Publicar Agora"})]})})]})};export{d as CreateMarketplaceItem};
