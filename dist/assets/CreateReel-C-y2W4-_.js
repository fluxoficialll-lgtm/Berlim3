import{u as e,a,r as i,c as t,g as o,j as n,h as l}from"./index-DHTLMDH8.js";import{r as s}from"./reelsService-JonFHPfl.js";import{c as r}from"./contentSafetyService-ChNoyba1.js";import"./MarketEngine-BDpNjeDI.js";import"./postService-D2IH4U_j.js";const d={Brasil:{"Ceará":["Fortaleza","Eusébio","Aquiraz","Sobral"],"São Paulo":["São Paulo","Campinas","Santos","Guarulhos"],"Rio de Janeiro":["Rio de Janeiro","Niterói","Cabo Frio"],"Minas Gerais":["Belo Horizonte","Uberlândia","Ouro Preto"]},"Estados Unidos":{California:["Los Angeles","San Francisco","San Diego"],"New York":["New York City","Buffalo"],Florida:["Miami","Orlando"]}},c=()=>{const c=e(),p=a().state,u=(null==p?void 0:p.isAd)||!1,[x,m]=i.useState(null),[g,f]=i.useState(null),[h,v]=i.useState(""),[b,j]=i.useState(""),[y,w]=i.useState(!0),[N,k]=i.useState(!1),[C,S]=i.useState(""),[z,I]=i.useState(""),[A,E]=i.useState(!1),[F,B]=i.useState(""),[G,P]=i.useState(""),[R,D]=i.useState(""),[O,T]=i.useState("Global"),[U,L]=i.useState(!1),[$,M]=i.useState([]),[V,J]=i.useState(null),[Y,_]=i.useState(!0),q=t.getCurrentUser();i.useEffect(()=>{const e=!!x,a=h.trim().length>0,i=!u||C&&parseFloat(C)>=10;let t=!0;V&&"inactive"===V.status&&(t=!1),w(!(e&&(a||V&&t))||!i||N)},[x,h,N,C,u,V]),i.useEffect(()=>{const e=t.getCurrentUserEmail();if(e){const a=o.getGroupsSync().filter(a=>a.creatorEmail===e);M(a)}},[]);const H=Object.keys(d),W=F?Object.keys(d[F]||{}):[],K=F&&G&&d[F][G]||[];return n.jsxs("div",{className:"h-screen flex flex-col bg-[#0c0f14] text-white font-['Inter'] overflow-hidden",children:[n.jsx("style",{children:"\n        header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid rgba(255,255,255,0.1); height: 60px; z-index: 50; background: #0c0f14; }\n        header button { background: none; border: none; font-size: 16px; color: #fff; cursor: pointer; }\n        header .publish-btn { background: #00c2ff; color: #000; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 14px; opacity: 1; transition: opacity 0.3s; }\n        header .publish-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #333; color: #777; }\n\n        main { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; align-items: center; }\n\n        .video-upload-area {\n            width: 180px; aspect-ratio: 9/16; background: #1a1e26; border-radius: 12px;\n            display: flex; flex-direction: column; align-items: center; justify-content: center;\n            border: 2px dashed rgba(255,255,255,0.1); cursor: pointer; position: relative; overflow: hidden;\n            transition: border-color 0.3s; margin-top: 10px;\n        }\n        .video-upload-area:hover { border-color: #00c2ff; }\n        .video-upload-area video { width: 100%; height: 100%; object-fit: cover; }\n        .placeholder { display: flex; flex-direction: column; align-items: center; gap: 10px; color: #555; }\n        .placeholder i { font-size: 30px; color: #00c2ff; }\n        .placeholder span { font-size: 12px; font-weight: 600; }\n\n        .input-group { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 10px; }\n        .input-field {\n            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);\n            border-radius: 10px; padding: 12px 15px; color: #fff; font-size: 14px; outline: none;\n            width: 100%; transition: 0.3s;\n        }\n        .input-field:focus { border-color: #00c2ff; background: rgba(255,255,255,0.08); }\n        textarea.input-field { resize: vertical; min-height: 80px; }\n\n        .settings-list { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 2px; }\n        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; }\n        .setting-left { display: flex; align-items: center; gap: 10px; color: #fff; font-size: 15px; font-weight: 500; }\n        .setting-icon { color: #888; width: 20px; text-align: center; }\n        .setting-value { color: #00c2ff; font-size: 14px; margin-right: 10px; font-weight: 600; }\n        .chevron { color: #555; font-size: 12px; }\n\n        .ad-box { width: 100%; max-width: 400px; background: rgba(255,215,0,0.05); border: 1px solid rgba(255,215,0,0.2); border-radius: 10px; padding: 15px; }\n        \n        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; display: flex; align-items: center; justify-content: center; }\n        .modal { background: #1a1e26; width: 90%; max-width: 350px; border-radius: 16px; padding: 20px; border: 1px solid #333; }\n        .modal select { width: 100%; background: #0c0f14; border: 1px solid #333; color: #fff; padding: 10px; border-radius: 8px; margin-bottom: 10px; outline: none; }\n        .modal-actions { display: flex; gap: 10px; margin-top: 15px; }\n        .modal-btn { flex: 1; padding: 10px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer; }\n        .save-btn { background: #00c2ff; color: #000; }\n        .cancel-btn { background: transparent; border: 1px solid #555; color: #aaa; }\n        \n        .group-list { max-height: 200px; overflow-y: auto; }\n        .group-item { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; display: flex; align-items: center; gap: 10px; }\n      "}),n.jsxs("header",{children:[n.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?c(-1):c("/reels")},children:"Cancelar"}),n.jsx("span",{style:{fontWeight:700,fontSize:"16px"},children:"Novo Reel"}),n.jsx("button",{className:"publish-btn",disabled:y,onClick:e=>{e.preventDefault(),!y&&x&&(k(!0),setTimeout(async()=>{var e,a;try{const i=await s.uploadVideo(x),t=`${b} ${h}`,o=await r.analyzeContent(t,[{url:i,type:"video"}]);let n=!1;o.isAdult&&(n=!0);const d=(null==(e=null==q?void 0:q.profile)?void 0:e.name)?`@${q.profile.name}`:"@usuario",p=null==(a=null==q?void 0:q.profile)?void 0:a.photoUrl,m={id:Date.now().toString(),type:"video",authorId:(null==q?void 0:q.id)||"",username:d,avatar:p,title:b,text:h,video:i,time:"Agora",timestamp:Date.now(),isPublic:!0,isAdultContent:n,views:0,likes:0,comments:0,liked:!1,location:"Global"===O?void 0:O,relatedGroupId:null==V?void 0:V.id};await s.addReel(m),(null==V?void 0:V.isVip)&&Y&&!u&&await l.createCampaign({id:Date.now().toString(),ownerId:(null==q?void 0:q.id)||"",name:`Auto-Boost (Reel): ${V.name}`,ownerEmail:(null==q?void 0:q.email)||"",scheduleType:"continuous",budget:0,pricingModel:"commission",trafficObjective:"conversions",creative:{text:h||b,mediaUrl:i,mediaType:"video"},campaignObjective:"group_joins",destinationType:"group",targetGroupId:V.id,optimizationGoal:"group_joins",placements:["feed","reels","marketplace"],ctaButton:"Entrar",status:"active",timestamp:Date.now()}),c("/reels")}catch(i){alert("Erro ao publicar.")}finally{k(!1)}},50))},children:N?"...":u?"Confirmar":"Publicar"})]}),n.jsxs("main",{children:[u&&n.jsxs("div",{className:"ad-box",children:[n.jsx("div",{style:{color:"#FFD700",fontSize:"12px",fontBlack:"900",marginBottom:"5px"},children:"IMPULSIONAMENTO PUBLICITÁRIO"}),n.jsx("input",{type:"number",className:"input-field",placeholder:"Investimento (Min R$ 10,00)",value:C,onChange:e=>S(e.target.value),style:{borderColor:"#FFD700"}}),n.jsx("input",{type:"text",className:"input-field",placeholder:"Link de Ação",value:z,onChange:e=>I(e.target.value),style:{marginTop:"10px",borderColor:"#FFD700"}})]}),n.jsxs("div",{className:"video-upload-area",onClick:()=>{var e;return null==(e=document.getElementById("videoInput"))?void 0:e.click()},children:[g?n.jsx("video",{src:g,controls:!1,autoPlay:!0,muted:!0,loop:!0}):n.jsxs("div",{className:"placeholder",children:[n.jsx("i",{className:"fa-solid fa-plus"}),n.jsx("span",{children:"Selecionar Vídeo"})]}),n.jsx("input",{type:"file",id:"videoInput",hidden:!0,accept:"video/*",onChange:e=>{var a;const i=null==(a=e.target.files)?void 0:a[0];i&&(m(i),f(URL.createObjectURL(i)))}})]}),n.jsxs("div",{className:"input-group",children:[n.jsx("input",{type:"text",className:"input-field",placeholder:"Título (Opcional)",value:b,onChange:e=>j(e.target.value),maxLength:50}),n.jsx("textarea",{className:"input-field",placeholder:"Escreva uma legenda...",value:h,onChange:e=>v(e.target.value),maxLength:2200})]}),n.jsxs("div",{className:"settings-list",children:[n.jsxs("div",{className:"setting-item",onClick:()=>E(!0),children:[n.jsxs("div",{className:"setting-left",children:[n.jsx("i",{className:"fa-solid fa-location-dot setting-icon"}),n.jsx("span",{children:"Direcionamento Regional"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("span",{className:"setting-value",children:O}),n.jsx("i",{className:"fa-solid fa-chevron-right chevron"})]})]}),n.jsxs("div",{className:"setting-item",onClick:()=>L(!0),children:[n.jsxs("div",{className:"setting-left",children:[n.jsx("i",{className:"fa-solid fa-users setting-icon"}),n.jsx("span",{children:"Vincular Comunidade"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("span",{className:"setting-value",style:{color:V?"#00ff82":"#555"},children:V?V.name.substring(0,15)+"...":"Nenhum"}),V&&n.jsx("i",{className:"fa-solid fa-xmark",style:{marginLeft:"5px",color:"#ff4d4d"},onClick:e=>{e.stopPropagation(),J(null)}}),!V&&n.jsx("i",{className:"fa-solid fa-chevron-right chevron"})]})]})]})]}),A&&n.jsx("div",{className:"modal-overlay",onClick:()=>E(!1),children:n.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[n.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:"Alcance do Reel"}),n.jsxs("select",{value:F,onChange:e=>{B(e.target.value),P(""),D("")},children:[n.jsx("option",{value:"",children:"Global (Todos)"}),H.map(e=>n.jsx("option",{value:e,children:e},e))]}),F&&n.jsxs("select",{value:G,onChange:e=>{P(e.target.value),D("")},children:[n.jsx("option",{value:"",children:"Todo o País"}),W.map(e=>n.jsx("option",{value:e,children:e},e))]}),G&&n.jsxs("select",{value:R,onChange:e=>D(e.target.value),children:[n.jsx("option",{value:"",children:"Todo o Estado"}),K.map(e=>n.jsx("option",{value:e,children:e},e))]}),n.jsxs("div",{className:"modal-actions",children:[n.jsx("button",{className:"modal-btn cancel-btn",onClick:()=>{T("Global"),E(!1)},children:"Resetar"}),n.jsx("button",{className:"modal-btn save-btn",onClick:()=>{let e="Global";R?e=`${R}, ${G}`:G?e=`${G}, Brasil`:F&&(e="Brasil"===F?"Global":F),T(e),E(!1)},children:"Aplicar"})]})]})}),U&&n.jsx("div",{className:"modal-overlay",onClick:()=>L(!1),children:n.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[n.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:"Selecionar Grupo"}),n.jsx("div",{className:"group-list",children:$.length>0?$.map(e=>n.jsxs("div",{className:"group-item",onClick:()=>{J(e),L(!1)},children:[n.jsx("i",{className:"fa-solid "+(e.isVip?"fa-crown text-[#FFD700]":"fa-users text-[#ccc]")}),n.jsx("span",{style:{color:"#fff",fontSize:"14px"},children:e.name})]},e.id)):n.jsx("div",{style:{textAlign:"center",color:"#555"},children:"Nenhum grupo encontrado."})}),n.jsx("div",{className:"modal-actions",children:n.jsx("button",{className:"modal-btn cancel-btn",onClick:()=>L(!1),children:"Fechar"})})]})})]})};export{c as CreateReel};
