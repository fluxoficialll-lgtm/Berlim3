import{u as e,a as o,e as n,r as t,c as s,x as a,i,j as l}from"./index-DHTLMDH8.js";import{p as r}from"./postService-D2IH4U_j.js";import{m as c}from"./marketplaceService-i91M9rHq.js";import{F as d}from"./FeedItem-BC1rcV7f.js";import{F as p}from"./Footer-BFwWYumu.js";import{a as f,A as x}from"./UserBadge-LRTOy28m.js";import{M as m}from"./MainHeader-BXRD-tws.js";import{U as u}from"./UserAvatar-C2eAn2V1.js";import{P as g,a as h,b}from"./ProfileProductsGrid-SOfxnRNx.js";import"./ProductCard-3eLZPLqu.js";const v=({type:e,data:o,onClose:n,onUserClick:t})=>e?l.jsxs("div",{className:"follow-modal-overlay fixed inset-0 bg-black/80 z-[100] flex items-center justify-center animate-fade-in",onClick:n,children:[l.jsx("style",{children:"\n                .follow-modal {\n                    background: #1a1e26;\n                    width: 90%;\n                    max-width: 350px;\n                    border-radius: 20px;\n                    height: 70vh;\n                    display: flex;\n                    flex-direction: column;\n                    overflow: hidden;\n                    border: 1px solid rgba(255, 255, 255, 0.1);\n                    box-shadow: 0 10px 40px rgba(0,0,0,0.6);\n                    animation: popIn 0.3s ease;\n                }\n                .follow-header {\n                    padding: 18px 20px;\n                    border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n                    display: flex;\n                    justify-content: space-between;\n                    align-items: center;\n                    background: rgba(255, 255, 255, 0.02);\n                }\n                .follow-header h3 {\n                    font-size: 16px;\n                    font-weight: 700;\n                    margin: 0;\n                    color: #00c2ff;\n                    text-transform: uppercase;\n                    letter-spacing: 1px;\n                }\n                .close-modal-btn {\n                    background: none;\n                    border: none;\n                    color: #888;\n                    font-size: 24px;\n                    cursor: pointer;\n                    line-height: 1;\n                }\n                .follow-list {\n                    flex-grow: 1;\n                    overflow-y: auto;\n                    padding: 10px 0;\n                }\n                .follow-item {\n                    display: flex;\n                    align-items: center;\n                    padding: 12px 20px;\n                    border-bottom: 1px solid rgba(255, 255, 255, 0.03);\n                    cursor: pointer;\n                    transition: background 0.2s;\n                }\n                .follow-item:hover {\n                    background: rgba(255, 255, 255, 0.05);\n                }\n                .f-avatar {\n                    width: 44px;\n                    height: 44px;\n                    border-radius: 50%;\n                    object-fit: cover;\n                    margin-right: 15px;\n                    background: #333;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    color: #555;\n                    border: 2px solid rgba(0, 194, 255, 0.2);\n                }\n                .f-info {\n                    display: flex;\n                    flex-direction: column;\n                }\n                .f-name {\n                    font-size: 14px;\n                    font-weight: 600;\n                    color: #fff;\n                }\n                .f-username {\n                    font-size: 12px;\n                    color: #888;\n                }\n                .empty-state {\n                    padding: 40px 20px;\n                    text-align: center;\n                    color: #555;\n                    font-size: 14px;\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    gap: 10px;\n                }\n                .empty-state i {\n                    font-size: 40px;\n                    opacity: 0.3;\n                }\n            "}),l.jsxs("div",{className:"follow-modal",onClick:e=>e.stopPropagation(),children:[l.jsxs("div",{className:"follow-header",children:[l.jsx("h3",{children:"followers"===e?"Seguidores":"Seguindo"}),l.jsx("button",{className:"close-modal-btn",onClick:n,children:"×"})]}),l.jsx("div",{className:"follow-list no-scrollbar",children:o.length>0?o.map((e,o)=>l.jsxs("div",{className:"follow-item",onClick:()=>t(e.username),children:[e.avatar?l.jsx("img",{src:e.avatar,className:"f-avatar",alt:e.name}):l.jsx("div",{className:"f-avatar",children:l.jsx("i",{className:"fa-solid fa-user"})}),l.jsxs("div",{className:"f-info",children:[l.jsx("span",{className:"f-name",children:e.name}),l.jsxs("span",{className:"f-username",children:["@",e.username]})]}),l.jsx("i",{className:"fa-solid fa-chevron-right ml-auto text-gray-700 text-xs"})]},o)):l.jsxs("div",{className:"empty-state",children:[l.jsx("i",{className:"fa-solid "+("followers"===e?"fa-users":"fa-user-plus")}),l.jsx("p",{children:"Nenhum usuário encontrado."})]})})]})]}):null,w=({onHomeClick:o})=>{const n=e();return l.jsx(m,{leftContent:l.jsx("button",{onClick:()=>n("/rank"),className:"bg-none border-none text-[#00c2ff] text-lg cursor-pointer",children:l.jsx("i",{className:"fa-solid fa-trophy"})}),rightContent:l.jsx("button",{onClick:()=>n("/settings"),className:"bg-none border-none text-[#00c2ff] text-lg cursor-pointer",children:l.jsx("i",{className:"fa-solid fa-gear"})}),onLogoClick:o})},j=({avatar:e,nickname:o,username:n,bio:t,website:s,stats:a,onAvatarClick:i,onFollowersClick:r,onFollowingClick:c,onEditClick:d,onShareClick:p})=>l.jsxs("div",{className:"profile-card-box",children:[l.jsx(u,{src:e,size:"xl",isVip:!1,onClick:i,alt:o,className:"mb-4"}),l.jsx(f,{nickname:o,handle:n,size:"lg",className:"items-center",onClick:d}),l.jsxs("div",{className:"profile-stats-container",children:[l.jsxs("div",{className:"stat-box",children:[l.jsx("span",{className:"stat-value",children:a.posts}),l.jsx("span",{className:"stat-label",children:"Posts"})]}),l.jsxs("div",{className:"stat-box",onClick:r,children:[l.jsx("span",{className:"stat-value",children:a.followers}),l.jsx("span",{className:"stat-label",children:"Seguidores"})]}),l.jsxs("div",{className:"stat-box",onClick:c,children:[l.jsx("span",{className:"stat-value",children:a.following}),l.jsx("span",{className:"stat-label",children:"Seguindo"})]})]}),l.jsx("p",{className:"profile-bio",children:t}),s&&l.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"profile-link",children:[l.jsx("i",{className:"fa-solid fa-link"}),s.replace(/^https?:\/\//,"").replace(/\/$/,"")]}),l.jsxs("div",{className:"profile-actions",children:[l.jsxs("button",{onClick:d,children:[l.jsx("i",{className:"fa-solid fa-pen"})," Editar Perfil"]}),l.jsxs("button",{onClick:p,children:[l.jsx("i",{className:"fa-solid fa-share-nodes"})," Compartilhar"]})]})]}),k=()=>{const{navigate:f,activeTab:m,setActiveTab:u,myPosts:k,myProducts:y,user:C,followersCount:N,followingCount:S,followListType:P,followListData:z,isPreviewOpen:U,setIsPreviewOpen:F,scrollRef:L,deletePost:T,handleLike:I,handleShowFollowList:O,closeFollowList:$,navigateToUserProfile:A,handleShare:E,handleUserClick:_,handleVote:D,handleNickname:V,handleUsername:W,displayBio:B,displayAvatar:R,displayWebsite:H}=(()=>{var l,d,p,f,x,m;const u=e(),g=o(),{showConfirm:h}=n(),[b,v]=t.useState("posts"),[w,j]=t.useState([]),[k,y]=t.useState([]),[C,N]=t.useState(null),[S,P]=t.useState(0),[z,U]=t.useState(0),[F,L]=t.useState(null),[T,I]=t.useState([]),[O,$]=t.useState(!1),A=t.useRef(null),E=t.useCallback(()=>{const e=s.getCurrentUser();if(!e)return;N(e);const o=r.getUserPosts(e.id)||[];j(o.sort((e,o)=>o.timestamp-e.timestamp));const n=c.getItems().filter(o=>o.sellerId===e.email||o.sellerId===e.id)||[];if(y(n.sort((e,o)=>o.timestamp-e.timestamp)),e.profile&&e.profile.name){const o=a.getFollowers(e.profile.name);P(o.length)}if(e.id){const o=a.getFollowing(e.id);U(o.length)}},[]);t.useEffect(()=>{g.state&&g.state.activeTab&&v(g.state.activeTab)},[g.state]),t.useEffect(()=>{if(!s.getCurrentUserEmail())return void u("/");E();const e=i.subscribe("posts",E),o=i.subscribe("relationships",E),n=i.subscribe("users",E);return()=>{e(),o(),n()}},[u,E]);const _=()=>{L(null),I([])},D=(null==(l=null==C?void 0:C.profile)?void 0:l.nickname)||(null==(d=null==C?void 0:C.profile)?void 0:d.name)||"Usuário",V=(null==(p=null==C?void 0:C.profile)?void 0:p.name)?`@${C.profile.name}`:"@usuario",W=(null==(f=null==C?void 0:C.profile)?void 0:f.bio)||"Sem biografia definida.",B=null==(x=null==C?void 0:C.profile)?void 0:x.photoUrl,R=null==(m=null==C?void 0:C.profile)?void 0:m.website;return{navigate:u,activeTab:b,setActiveTab:v,myPosts:w,myProducts:k,user:C,followersCount:S,followingCount:z,followListType:F,followListData:T,isPreviewOpen:O,setIsPreviewOpen:$,scrollRef:A,deletePost:async(e,o)=>{o.stopPropagation(),await h("Excluir Post","Tem certeza que deseja excluir este post permanentemente?","Excluir","Cancelar")&&await r.deletePost(e)},handleLike:e=>{r.toggleLike(e),j(o=>o.map(o=>{if(o.id===e){const e=!o.liked;return{...o,liked:e,likes:o.likes+(o.liked?-1:1)}}return o}))},handleShowFollowList:e=>{var o;if(!C)return;let n=[];"followers"===e&&(null==(o=C.profile)?void 0:o.name)?n=a.getFollowers(C.profile.name):"following"===e&&C.id&&(n=a.getFollowing(C.id)),I(n),L(e)},closeFollowList:_,navigateToUserProfile:e=>{_();const o=e.replace("@","");u(`/user/${o}`)},handleShare:async e=>{const o=`${window.location.origin}/#/post/${e.id}`;if(navigator.share)try{await navigator.share({title:`Post de ${e.username}`,text:(e.text||"").substring(0,100),url:o})}catch(n){}else navigator.clipboard.writeText(o),alert("Link copiado!");r.incrementShare(e.id)},handleUserClick:e=>{u(`/user/${e.replace("@","")}`)},handleVote:(e,o)=>{j(n=>n.map(n=>{if(n.id===e&&n.pollOptions&&null==n.votedOptionIndex){const e=[...n.pollOptions];return e[o].votes+=1,{...n,pollOptions:e,votedOptionIndex:o}}return n}))},handleNickname:D,handleUsername:V,displayBio:W,displayAvatar:B,displayWebsite:R}})();return l.jsxs("div",{className:"profile-page h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-hidden",children:[l.jsx("style",{children:"\n        main { flex-grow: 1; overflow-y: auto; padding-top: 80px; padding-bottom: 100px; scroll-behavior: smooth; }\n        .profile-card-box { background: rgba(30, 35, 45, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 24px; padding: 30px 20px; width: 90%; max-width: 400px; display: flex; flex-direction: column; align-items: center; margin: 0 auto 20px auto; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); }\n        .profile-avatar { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 4px solid #00c2ff; margin-bottom: 15px; background: #1e2531; cursor: pointer; }\n        .profile-avatar-placeholder { width: 100px; height: 100px; border-radius: 50%; border: 4px solid #00c2ff; margin-bottom: 15px; background: #1e2531; display: flex; align-items: center; justify-content: center; font-size: 40px; color: #00c2ff; }\n        .profile-nickname { font-size: 24px; font-weight: 800; color: #fff; margin-bottom: 2px; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }\n        .profile-handle { font-size: 14px; color: #00c2ff; margin-bottom: 15px; font-weight: 500; }\n        .profile-stats-container { display: flex; justify-content: space-around; width: 100%; margin: 20px 0; border-top: 1px solid rgba(255,255,255,0.1); border-bottom: 1px solid rgba(255,255,255,0.1); padding: 15px 0; }\n        .stat-box { display: flex; flex-direction: column; align-items: center; cursor: pointer; flex: 1; }\n        .stat-value { font-size: 18px; font-weight: 800; color: #fff; }\n        .stat-label { font-size: 11px; color: #aaa; text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; }\n        .profile-bio { font-size: 14px; color: #e0e0e0; text-align: center; line-height: 1.5; margin-bottom: 15px; max-width: 90%; }\n        .profile-link { font-size: 13px; color: #00c2ff; display: flex; align-items: center; gap: 5px; background: rgba(0,194,255,0.1); padding: 5px 12px; border-radius: 20px; text-decoration: none; }\n        .profile-actions { display: flex; gap: 10px; width: 100%; justify-content: center; margin-top: 10px; }\n        .profile-actions button { flex: 1; max-width: 140px; padding: 12px; border-radius: 12px; font-weight: 700; font-size: 14px; border: none; cursor: pointer; background: #1e2531; color: #fff; border: 1px solid #555; }\n        .gallery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; }\n        .gallery-item { position: relative; aspect-ratio: 9/16; cursor: pointer; background: #000; }\n        .gallery-item img, .reel-thumbnail { width: 100%; height: 100%; object-fit: cover; }\n        .reel-icon { position: absolute; bottom: 5px; left: 5px; color: #fff; font-size: 12px; display: flex; align-items: center; gap: 4px; text-shadow: 0 1px 2px rgba(0,0,0,0.8); }\n        .no-content { text-align: center; color: #666; padding: 30px 0; font-size: 14px; width: 100%; }\n      "}),l.jsx(w,{onHomeClick:()=>{var e;return null==(e=L.current)?void 0:e.scrollTo({top:0,behavior:"smooth"})}}),l.jsx("main",{className:"flex-grow w-full overflow-y-auto no-scrollbar",ref:L,children:l.jsxs("div",{style:{width:"100%",maxWidth:"500px",margin:"0 auto",paddingTop:"10px",paddingBottom:"100px"},children:[l.jsx(j,{avatar:R,nickname:V,username:W,bio:B,website:H,stats:{posts:k.length,followers:N,following:S},onAvatarClick:()=>F(!0),onFollowersClick:()=>O("followers"),onFollowingClick:()=>O("following"),onEditClick:()=>f("/edit-profile"),onShareClick:()=>alert("Compartilhar")}),l.jsxs("div",{className:"profile-tabs-container",children:[l.jsx(g,{activeTab:m,setActiveTab:u,hasProducts:y.length>0}),l.jsxs("div",{className:"tab-content",children:["posts"===m&&l.jsx("div",{className:"post-list animate-fade-in px-3",children:k.filter(e=>"text"===e.type||"poll"===e.type).length>0?k.filter(e=>"text"===e.type||"poll"===e.type).map(e=>l.jsx(d,{post:e,currentUserId:null==C?void 0:C.id,onLike:I,onDelete:(e,o)=>T(o,e),onUserClick:_,onCommentClick:e=>f(`/post/${e}`),onShare:E,onVote:D,onCtaClick:e=>(null==e?void 0:e.startsWith("http"))?window.open(e,"_blank"):f(e||"")},e.id)):l.jsx("div",{className:"no-content",children:"Sem posts."})}),"products"===m&&l.jsx(h,{products:y,onProductClick:e=>f(`/marketplace/product/${e}`)}),"fotos"===m&&l.jsx("div",{className:"post-list animate-fade-in px-3",children:k.filter(e=>"photo"===e.type).length>0?k.filter(e=>"photo"===e.type).map(e=>l.jsx(d,{post:e,currentUserId:null==C?void 0:C.id,onLike:I,onDelete:(e,o)=>T(o,e),onUserClick:_,onCommentClick:e=>f(`/post/${e}`),onShare:E,onVote:D,onCtaClick:e=>(null==e?void 0:e.startsWith("http"))?window.open(e,"_blank"):f(e||"")},e.id)):l.jsx("div",{className:"no-content",children:"Sem fotos."})}),"reels"===m&&l.jsx(b,{reels:k.filter(e=>"video"===e.type),onReelClick:e=>f(`/reels/${e.id}`,{state:{authorId:e.authorId}}),onDelete:(e,o)=>T(e,o)})]})]})]})}),l.jsx(p,{}),l.jsx(v,{type:P,data:z,onClose:$,onUserClick:A}),l.jsx(x,{isOpen:U,onClose:()=>F(!1),imageSrc:R||"",username:V})]})};export{k as Profile};
