import{r as e,j as a,u as t}from"./index-DHTLMDH8.js";const r=()=>new Promise((e,a)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>e({latitude:a.coords.latitude,longitude:a.coords.longitude}),e=>a(e),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):a(new Error("Geolocalização não suportada."))}),s=async e=>{var a,t;try{const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e.latitude}&lon=${e.longitude}&zoom=10&addressdetails=1`,{headers:{"Accept-Language":"pt-BR"}}),s=await r.json(),i=s.address;return{city:i.city||i.town||i.village||i.municipality,state:i.state,stateCode:null==(a=i["ISO3166-2-lvl4"])?void 0:a.split("-")[1],country:i.country,countryCode:null==(t=i.country_code)?void 0:t.toUpperCase(),displayName:s.display_name}}catch(r){throw new Error("Falha ao identificar endereço.")}},i="flux_user_geo_filter",n=({value:e,onChange:t})=>a.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 animate-fade-in",children:[a.jsx("style",{children:"\n                .radius-input-manual {\n                    background: rgba(0, 0, 0, 0.3);\n                    border: 1px solid rgba(0, 194, 255, 0.2);\n                    color: #fff;\n                    font-size: 20px;\n                    font-weight: 900;\n                    width: 80px;\n                    text-align: center;\n                    padding: 4px;\n                    border-radius: 8px;\n                    outline: none;\n                    transition: all 0.3s;\n                }\n                .radius-input-manual:focus {\n                    border-color: #00c2ff;\n                    box-shadow: 0 0 15px rgba(0, 194, 255, 0.2);\n                }\n                /* Remove setas do input number */\n                .radius-input-manual::-webkit-inner-spin-button,\n                .radius-input-manual::-webkit-outer-spin-button {\n                    -webkit-appearance: none;\n                    margin: 0;\n                }\n            "}),a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{className:"text-left",children:[a.jsx("h3",{className:"text-[10px] font-black text-[#00c2ff] uppercase tracking-[2px]",children:"Raio de Alcance"}),a.jsx("p",{className:"text-[9px] text-gray-600 font-bold uppercase",children:"Ajuste o zoom do feed"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",className:"radius-input-manual",value:e,onChange:e=>{let a=parseInt(e.target.value);isNaN(a)&&(a=0),a>500&&(a=500),t(a)},onBlur:()=>{e<1&&t(1)},min:"1",max:"500"}),a.jsx("span",{className:"text-xs font-black text-gray-500 uppercase",children:"KM"})]})]}),a.jsx("input",{type:"range",min:"1",max:"500",value:e,onChange:e=>t(parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-[#00c2ff]"}),a.jsxs("div",{className:"flex justify-between mt-3 text-[8px] font-black text-gray-700 uppercase tracking-widest",children:[a.jsx("span",{children:"Local (1km)"}),a.jsx("span",{children:"Regional (500km)"})]}),a.jsx("div",{className:"mt-6 p-4 bg-black/20 rounded-xl border border-white/5",children:a.jsxs("p",{className:"text-[11px] text-gray-400 leading-relaxed italic text-center",children:[a.jsx("i",{className:"fa-solid fa-circle-info text-[#00c2ff] mr-1 opacity-50"}),"Conteúdos criados dentro de ",a.jsxs("strong",{className:"text-white",children:[e,"km"]})," aparecerão prioritariamente no seu feed."]})})]}),l=()=>{const l=t(),{currentFilter:c,loading:o,captureGps:d,updateFilter:x,clearFilter:p}=(()=>{const[a,t]=e.useState(!1),[n,l]=e.useState(()=>{const e=localStorage.getItem(i);return e?JSON.parse(e):{type:"global"}}),c=e.useCallback(e=>{l(e),localStorage.setItem(i,JSON.stringify(e))},[]);return{currentFilter:n,loading:a,captureGps:async()=>{t(!0);try{const e=await r(),a={type:"radius",radius:50,coords:e,targetAddress:await s(e)};return c(a),a}catch(e){throw e}finally{t(!1)}},updateFilter:c,clearFilter:()=>{c({type:"global"})}}})(),[f,u]=e.useState("feed"),[m,b]=e.useState("territory"),g=e=>{x({...c,type:e})},h=!!c.targetAddress,y=c.targetAddress;return a.jsxs("div",{className:"min-h-screen bg-[#0c0f14] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[a.jsx("style",{children:"\n        .placement-card-item {\n            background: rgba(255, 255, 255, 0.02);\n            border: 1px solid rgba(255, 255, 255, 0.05);\n            border-radius: 18px;\n            padding: 14px 18px;\n            display: flex;\n            align-items: center;\n            gap: 16px;\n            cursor: pointer;\n            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .placement-card-item.active {\n            background: rgba(0, 194, 255, 0.08);\n            border-color: #00c2ff;\n        }\n        .p-icon-box {\n            width: 44px; height: 44px; border-radius: 12px;\n            background: rgba(255, 255, 255, 0.05);\n            display: flex; align-items: center; justify-content: center;\n            color: #555; font-size: 18px;\n        }\n        .active .p-icon-box { background: #00c2ff; color: #000; }\n\n        .territory-grid { display: grid; grid-template-columns: 1fr; gap: 8px; }\n        .territory-btn {\n            background: rgba(255, 255, 255, 0.03);\n            border: 1px solid rgba(255, 255, 255, 0.08);\n            padding: 18px 20px;\n            border-radius: 20px;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            transition: all 0.3s ease;\n            cursor: pointer;\n        }\n        .territory-btn.active {\n            background: rgba(0, 194, 255, 0.1);\n            border-color: #00c2ff;\n            box-shadow: 0 0 20px rgba(0, 194, 255, 0.1);\n        }\n        .t-label { font-size: 10px; font-weight: 900; text-transform: uppercase; color: #555; letter-spacing: 2px; margin-bottom: 2px; }\n        .t-name { font-size: 16px; font-weight: 800; color: #fff; }\n        .territory-btn.active .t-label { color: #00c2ff; }\n\n        .radius-toggle-btn {\n            width: 100%; padding: 14px; background: rgba(255,255,255,0.02);\n            border: 1px dashed rgba(255,255,255,0.1); border-radius: 16px;\n            color: #888; font-size: 11px; font-weight: 800; text-transform: uppercase;\n            letter-spacing: 1px; margin-top: 10px; cursor: pointer; transition: 0.3s;\n        }\n        .radius-toggle-btn:hover { border-color: #00c2ff; color: #fff; }\n        .radius-toggle-btn.active { background: #00c2ff1a; border: 1px solid #00c2ff; color: #00c2ff; }\n      "}),a.jsxs("header",{className:"flex items-center p-[16px_32px] bg-[#0c0f14] fixed w-full z-10 border-b border-white/10 top-0 h-[65px]",children:[a.jsx("button",{onClick:()=>l("/feed"),className:"text-white text-[22px] pr-[15px]",children:a.jsx("i",{className:"fa-solid fa-xmark"})}),a.jsx("h1",{className:"text-[18px] font-bold text-[#00c2ff] uppercase tracking-tighter",children:"Explorar Mapa Flux"})]}),a.jsxs("main",{className:"pt-[90px] pb-10 w-full max-w-[500px] mx-auto px-5 flex flex-col gap-6",children:[a.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[32px] p-8 text-center relative overflow-hidden group",children:[o&&a.jsxs("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm z-10 flex flex-col items-center justify-center",children:[a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-3xl text-[#00c2ff] mb-3"}),a.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Localizando..."})]}),h?a.jsxs("div",{className:"animate-fade-in flex flex-col gap-6",children:[a.jsx("div",{className:"text-left mb-2",children:a.jsx("h3",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[3px] ml-1",children:"Alcance por Território"})}),"territory"===m?a.jsxs("div",{className:"territory-grid",children:[a.jsxs("div",{className:"territory-btn "+("city"===c.type?"active":""),onClick:()=>g("city"),children:[a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"t-label",children:"Local"}),a.jsx("div",{className:"t-name",children:(null==y?void 0:y.city)||"Sua Cidade"})]}),a.jsx("i",{className:"fa-solid fa-city text-gray-600"})]}),a.jsxs("div",{className:"territory-btn "+("state"===c.type?"active":""),onClick:()=>g("state"),children:[a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"t-label",children:"Regional"}),a.jsx("div",{className:"t-name",children:(null==y?void 0:y.state)||"Seu Estado"})]}),a.jsx("i",{className:"fa-solid fa-map text-gray-600"})]}),a.jsxs("div",{className:"territory-btn "+("country"===c.type?"active":""),onClick:()=>g("country"),children:[a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"t-label",children:"Nacional"}),a.jsx("div",{className:"t-name",children:(null==y?void 0:y.country)||"Seu País"})]}),a.jsx("i",{className:"fa-solid fa-flag text-gray-600"})]})]}):a.jsx("div",{className:"animate-fade-in",children:a.jsx(n,{value:c.radius||50,onChange:e=>{x({...c,type:"radius",radius:e})}})}),a.jsxs("button",{className:"radius-toggle-btn "+("custom_radius"===m?"active":""),onClick:()=>b("territory"===m?"custom_radius":"territory"),children:[a.jsx("i",{className:`fa-solid ${"territory"===m?"fa-radar":"fa-arrow-left"} mr-2`}),"territory"===m?"Ajustar Raio (KM)":"Voltar para Territórios"]})]}):a.jsxs("div",{className:"py-4",children:[a.jsx("div",{className:"w-20 h-20 bg-[#00c2ff1a] rounded-[30px] flex items-center justify-center mx-auto mb-6 border border-[#00c2ff33]",children:a.jsx("i",{className:"fa-solid fa-satellite text-3xl text-[#00c2ff]"})}),a.jsx("h2",{className:"text-lg font-bold mb-2",children:"GPS Desconectado"}),a.jsx("p",{className:"text-xs text-gray-500 px-10 leading-relaxed mb-8",children:"Ative o sinal para ver conteúdos reais baseados no seu território atual."}),a.jsx("button",{onClick:async()=>{try{await d(),b("territory")}catch(e){alert("Não foi possível acessar seu GPS. Verifique as permissões do seu navegador.")}},className:"w-full py-4 bg-[#00c2ff] text-black font-black rounded-2xl shadow-xl uppercase text-xs tracking-widest active:scale-95 transition-all",children:"Ativar Localização"})]})]}),h&&a.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[32px] p-6 animate-fade-in",children:[a.jsx("h3",{className:"text-[10px] font-black text-[#00c2ff] uppercase tracking-[2px] mb-4 ml-1",children:"O que deseja filtrar?"}),a.jsx("div",{className:"flex flex-col gap-2",children:[{id:"feed",label:"Feed",icon:"fa-newspaper",desc:"Posts e enquetes"},{id:"reels",label:"Reels",icon:"fa-clapperboard",desc:"Vídeos curtos"},{id:"marketplace",label:"Mercado",icon:"fa-cart-shopping",desc:"Ofertas e vendas"}].map(e=>a.jsxs("div",{className:"placement-card-item "+(f===e.id?"active":""),onClick:()=>u(e.id),children:[a.jsx("div",{className:"p-icon-box",children:a.jsx("i",{className:`fa-solid ${e.icon}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-sm font-bold text-white",children:e.label}),a.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-medium",children:e.desc})]}),f===e.id&&a.jsx("i",{className:"fa-solid fa-circle-check text-[#00c2ff]"})]},e.id))})]}),h&&a.jsx("button",{onClick:()=>{if(c.coords&&c.targetAddress){let e="Global";const a=c.targetAddress;"city"===c.type?e=a.city||"Minha Cidade":"state"===c.type?e=a.state||"Meu Estado":"country"===c.type?e=a.country||"Meu País":"radius"===c.type&&(e=`${c.radius}km de você`),localStorage.setItem("feed_location_filter",e)}switch(f){case"reels":l("/reels");break;case"marketplace":l("/marketplace");break;default:l("/feed")}},className:"w-full py-5 bg-[#00c2ff] text-black font-black rounded-2xl shadow-xl uppercase text-sm tracking-widest active:scale-95 transition-all",children:"Confirmar Filtro"}),a.jsxs("div",{className:"mt-4 pt-6 border-t border-white/5 space-y-4",children:[a.jsxs("button",{onClick:()=>{p(),localStorage.removeItem("feed_location_filter"),l("/feed")},className:"w-full bg-white/5 text-white border border-white/10 p-4 rounded-xl font-bold text-sm flex items-center justify-center gap-3 transition-all hover:bg-red-500/10 hover:border-red-500/30",children:[a.jsx("i",{className:"fa-solid fa-earth-americas text-[#00c2ff]"}),"Limpar Filtro (Ver Global)"]}),a.jsx("p",{className:"text-center text-[10px] text-gray-700 font-black uppercase tracking-[3px]",children:"Flux Territory Intelligence v3.0"})]})]})]})};export{l as LocationSelector};
