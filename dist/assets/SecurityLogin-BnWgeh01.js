import{u as e,r as n,c as s,i,j as t}from"./index-DHTLMDH8.js";const o=()=>{const o=e(),[r,a]=n.useState({saveLoginInfo:!0}),[d,l]=n.useState(""),[c,p]=n.useState(""),[x,g]=n.useState(""),[h,u]=n.useState(""),[b,f]=n.useState(""),[m,v]=n.useState(!1),[w,j]=n.useState([]);n.useEffect(()=>{const e=s.getCurrentUser();e&&e.securitySettings&&a(e.securitySettings),j(s.getUserSessions());const n=i.subscribe("users",()=>{j(s.getUserSessions())});return()=>n()},[]);return t.jsxs("div",{className:"h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-hidden",children:[t.jsx("style",{children:"\n            * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter', sans-serif; }\n            header {\n                display:flex; align-items:center; padding:16px;\n                background: #0c0f14; position:fixed; width:100%; top:0; z-index:10;\n                border-bottom:1px solid rgba(255,255,255,0.1); height: 65px;\n            }\n            header .back-btn {\n                background:none; border:none; color:#fff; font-size:24px; cursor:pointer; padding-right: 15px;\n            }\n            header h1 { font-size:20px; font-weight:600; }\n            \n            main { \n                padding-top: 85px; padding-bottom: 40px; width: 100%; max-width: 600px; \n                margin: 0 auto; padding-left: 20px; padding-right: 20px;\n                overflow-y: auto; flex-grow: 1; -webkit-overflow-scrolling: touch;\n            }\n            \n            .settings-section {\n                background: rgba(255,255,255,0.05); border-radius: 12px; overflow: hidden;\n                border: 1px solid rgba(255,255,255,0.05); margin-bottom: 25px;\n            }\n            \n            .setting-row {\n                display: flex; align-items: center; justify-content: space-between;\n                padding: 16px; border-bottom: 1px solid rgba(255,255,255,0.05);\n            }\n            .setting-row:last-child { border-bottom: none; }\n            \n            .label-title { font-size: 16px; font-weight: 500; color: #fff; }\n            .label-desc { font-size: 13px; color: #888; margin-top: 2px; }\n            \n            /* Switch */\n            .switch { position: relative; display: inline-block; width: 44px; height: 24px; }\n            .switch input { opacity: 0; width: 0; height: 0; }\n            .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #333; transition: .4s; border-radius: 24px; }\n            .slider:before { position: absolute; content: \"\"; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }\n            input:checked + .slider { background-color: #00c2ff; }\n            input:checked + .slider:before { transform: translateX(20px); }\n            \n            .section-title {\n                font-size: 14px; color: #00c2ff; margin-bottom: 10px; text-transform: uppercase; font-weight: 700; padding-left: 5px;\n            }\n\n            /* Password Form */\n            .password-form { padding: 20px; }\n            .input-group { margin-bottom: 15px; }\n            .input-group label { display: block; font-size: 13px; color: #aaa; margin-bottom: 5px; }\n            .input-group input {\n                width: 100%; padding: 12px; background: #111; border: 1px solid #333;\n                border-radius: 8px; color: #fff; outline: none; transition: 0.3s;\n            }\n            .input-group input:focus { border-color: #00c2ff; }\n            \n            .save-btn {\n                width: 100%; padding: 12px; background: #00c2ff; color: #000;\n                border: none; border-radius: 8px; font-weight: 700; cursor: pointer;\n                transition: 0.3s;\n            }\n            .save-btn:hover { background: #0099cc; }\n            .save-btn:disabled { opacity: 0.7; cursor: not-allowed; }\n\n            .alert-box {\n                padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 13px;\n            }\n            .alert-error { background: rgba(255, 77, 77, 0.1); color: #ff4d4d; border: 1px solid rgba(255, 77, 77, 0.3); }\n            .alert-success { background: rgba(0, 255, 130, 0.1); color: #00ff82; border: 1px solid rgba(0, 255, 130, 0.3); }\n\n            /* Login Activity */\n            .session-item {\n                display: flex; align-items: center; padding: 15px;\n                border-bottom: 1px solid rgba(255,255,255,0.05);\n            }\n            .session-item:last-child { border-bottom: none; }\n            .session-icon { font-size: 24px; color: #aaa; margin-right: 15px; }\n            .session-info h4 { font-size: 15px; font-weight: 600; color: #fff; }\n            .session-info p { font-size: 12px; color: #888; margin-top: 2px; }\n            .active-now { color: #00ff82; font-size: 11px; font-weight: 700; margin-top: 4px; display: flex; align-items: center; gap: 4px; }\n            .active-dot { width: 6px; height: 6px; background: #00ff82; border-radius: 50%; }\n            \n            .revoke-btn {\n                background: transparent; color: #ff4d4d; border: 1px solid #ff4d4d;\n                padding: 4px 10px; border-radius: 12px; font-size: 11px; cursor: pointer;\n                transition: 0.2s;\n            }\n            .revoke-btn:hover { background: rgba(255, 77, 77, 0.1); }\n        "}),t.jsxs("header",{children:[t.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?o(-1):o("/settings")},className:"back-btn",children:t.jsx("i",{className:"fa-solid fa-arrow-left"})}),t.jsx("h1",{children:"Segurança e Login"})]}),t.jsxs("main",{children:[t.jsx("div",{className:"section-title",children:"Alterar Senha"}),t.jsx("div",{className:"settings-section",children:t.jsxs("div",{className:"password-form",children:[h&&t.jsx("div",{className:"alert-box alert-error",children:h}),b&&t.jsx("div",{className:"alert-box alert-success",children:b}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),u(""),f(""),v(!0),c.length<6)return u("A nova senha deve ter pelo menos 6 caracteres."),void v(!1);if(c!==x)return u("As novas senhas não coincidem."),void v(!1);try{await s.changePassword(d,c),f("Senha alterada com sucesso!"),l(""),p(""),g("")}catch(n){u(n.message||"Erro ao alterar senha.")}finally{v(!1)}},children:[t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Senha Atual"}),t.jsx("input",{type:"password",value:d,onChange:e=>l(e.target.value),required:!0})]}),t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Nova Senha"}),t.jsx("input",{type:"password",value:c,onChange:e=>p(e.target.value),required:!0})]}),t.jsxs("div",{className:"input-group",children:[t.jsx("label",{children:"Confirmar Nova Senha"}),t.jsx("input",{type:"password",value:x,onChange:e=>g(e.target.value),required:!0})]}),t.jsx("button",{type:"submit",className:"save-btn",disabled:m,children:m?"Alterando...":"Alterar Senha"})]})]})}),t.jsx("div",{className:"section-title",children:"Preferências"}),t.jsx("div",{className:"settings-section",children:t.jsxs("div",{className:"setting-row",children:[t.jsxs("div",{children:[t.jsx("div",{className:"label-title",children:"Salvar Login"}),t.jsx("div",{className:"label-desc",children:"Manter dados para login rápido."})]}),t.jsxs("label",{className:"switch",children:[t.jsx("input",{type:"checkbox",checked:r.saveLoginInfo,onChange:()=>(e=>{const n={...r,[e]:!r[e]};a(n),s.updateSecuritySettings(n)})("saveLoginInfo")}),t.jsx("span",{className:"slider"})]})]})}),t.jsxs("div",{className:"flex justify-between items-end mb-2 px-1",children:[t.jsx("div",{className:"section-title mb-0",children:"Sessões Ativas"}),w.length>1&&t.jsx("button",{onClick:async()=>{window.confirm("Deseja desconectar todos os outros dispositivos?")&&await s.revokeOtherSessions()},className:"revoke-btn",children:"Sair de outros dispositivos"})]}),t.jsx("div",{className:"settings-section",children:w.length>0?w.map(e=>{return t.jsxs("div",{className:"session-item",children:[t.jsx("i",{className:`fa-solid ${e.device.toLowerCase().includes("mobile")?"fa-mobile-screen-button":"fa-laptop"} session-icon`}),t.jsxs("div",{className:"session-info",children:[t.jsx("h4",{children:e.device}),t.jsxs("p",{children:[e.location," • ",(n=e.timestamp,new Date(n).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}))]}),e.isActive&&t.jsxs("div",{className:"active-now",children:[t.jsx("div",{className:"active-dot"})," Ativo agora"]})]})]},e.id);var n}):t.jsx("div",{className:"session-item",children:t.jsx("div",{className:"session-info w-full text-center py-4",children:t.jsx("p",{children:"Nenhuma informação de sessão disponível."})})})})]})]})};export{o as SecurityLogin};
