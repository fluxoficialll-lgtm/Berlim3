import{r as e,j as a,c as t,v as r,u as n}from"./index-DHTLMDH8.js";import{s,p as i}from"./paypalService-rjFRVFHe.js";const o=({isConnected:n,onStatusChange:s})=>{const[i,o]=e.useState(!1),[c,d]=e.useState(""),[l,p]=e.useState(""),[f,x]=e.useState("syncpay"===localStorage.getItem("flux_preferred_provider")),[m,g]=e.useState({type:null,message:""});e.useEffect(()=>{const e=()=>x("syncpay"===localStorage.getItem("flux_preferred_provider"));return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const u=()=>{localStorage.setItem("flux_preferred_provider","syncpay"),x(!0),window.dispatchEvent(new Event("storage"))},h=async()=>{if(window.confirm("Deseja desconectar o SyncPay? Isso desativará o Pix nos seus grupos VIP.")){o(!0);try{await t.updatePaymentConfig({providerId:"syncpay",isConnected:!1}),"syncpay"===localStorage.getItem("flux_preferred_provider")&&localStorage.removeItem("flux_preferred_provider"),s("syncpay",!1)}catch(e){alert("Erro ao desconectar")}finally{o(!1)}}};return n?a.jsxs("div",{className:"animate-fade-in",style:{textAlign:"center",padding:"10px"},children:[a.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[a.jsxs("div",{className:"feedback-msg success !mt-0",children:[a.jsx("i",{className:"fa-solid fa-circle-check"})," SyncPay Ativo"]}),a.jsx("button",{onClick:u,className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center transition-all "+(f?"text-[#00c2ff] border-[#00c2ff]/50 bg-[#00c2ff]/10":"text-gray-400 hover:text-[#00c2ff]"),title:f?"Ativo no Painel":"Definir como Principal",children:a.jsx("i",{className:"fa-solid fa-star"})})]}),a.jsx("button",{className:"disconnect-btn",onClick:h,disabled:i,children:i?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Desconectar Provedor"})]}):a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"input-group",children:[a.jsx("label",{children:"Chave Pública (Client ID)"}),a.jsx("input",{type:"text",placeholder:"Cole aqui seu Client ID",value:c,onChange:e=>d(e.target.value)})]}),a.jsxs("div",{className:"input-group",children:[a.jsx("label",{children:"Chave Privada (Client Secret)"}),a.jsx("input",{type:"password",placeholder:"Cole aqui seu Client Secret",value:l,onChange:e=>p(e.target.value)})]}),m.message&&a.jsxs("div",{className:`feedback-msg ${m.type} mb-4`,children:[a.jsx("i",{className:"fa-solid "+("success"===m.type?"fa-check":"fa-triangle-exclamation")}),m.message]}),a.jsxs("button",{className:"save-btn",onClick:async()=>{if(c&&l){o(!0),g({type:null,message:""});try{await r.authenticate(c,l);const e={providerId:"syncpay",clientId:c,clientSecret:l,isConnected:!0};await t.updatePaymentConfig(e),localStorage.getItem("flux_preferred_provider")||(localStorage.setItem("flux_preferred_provider","syncpay"),x(!0)),s("syncpay",!0),g({type:"success",message:"Conectado com sucesso!"})}catch(e){g({type:"error",message:e.message||"Falha na conexão. Verifique suas chaves."})}finally{o(!1)}}else g({type:"error",message:"Preencha a Chave Pública e a Chave Privada."})},disabled:i,children:[i?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin mr-2"}):null,i?"Validando Chaves...":"Conectar e Salvar"]})]})},c=({isConnected:r,onStatusChange:n})=>{const[i,o]=e.useState(!1),[c,d]=e.useState(""),[l,p]=e.useState("stripe"===localStorage.getItem("flux_preferred_provider"));e.useEffect(()=>{const e=()=>p("stripe"===localStorage.getItem("flux_preferred_provider"));return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const f=()=>{localStorage.setItem("flux_preferred_provider","stripe"),p(!0),window.dispatchEvent(new Event("storage"))},x=async()=>{if(window.confirm("Deseja desconectar a Stripe?")){o(!0);try{await t.updatePaymentConfig({providerId:"stripe",isConnected:!1}),"stripe"===localStorage.getItem("flux_preferred_provider")&&localStorage.removeItem("flux_preferred_provider"),n("stripe",!1)}catch(e){alert("Erro ao desconectar")}finally{o(!1)}}};return r?a.jsxs("div",{className:"animate-fade-in",style:{textAlign:"center",padding:"10px"},children:[a.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[a.jsxs("div",{className:"feedback-msg success !mt-0",children:[a.jsx("i",{className:"fa-solid fa-circle-check"})," Stripe Conectada"]}),a.jsx("button",{onClick:f,className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center transition-all "+(l?"text-[#00c2ff] border-[#00c2ff]/50 bg-[#00c2ff]/10":"text-gray-400 hover:text-[#00c2ff]"),title:"Ver no Painel",children:a.jsx("i",{className:"fa-solid fa-eye"})})]}),a.jsx("button",{className:"disconnect-btn",onClick:x,disabled:i,children:i?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Desconectar"})]}):a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"input-group",children:[a.jsx("label",{children:"Secret Key (sk_...)"}),a.jsx("input",{type:"password",value:c,onChange:e=>d(e.target.value),placeholder:"Sua sk_live ou sk_test"})]}),a.jsx("button",{className:"save-btn",onClick:async()=>{if(c){o(!0);try{await s.authenticate(c);const e={providerId:"stripe",clientSecret:c,isConnected:!0};await t.updatePaymentConfig(e),n("stripe",!0)}catch(e){alert("Erro na conexão com Stripe")}finally{o(!1)}}},disabled:i,children:i?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Conectar Stripe"})]})},d=({isConnected:r,onStatusChange:n})=>{const[s,o]=e.useState(""),[c,d]=e.useState(""),[l,p]=e.useState(!1),[f,x]=e.useState("paypal"===localStorage.getItem("flux_preferred_provider"));e.useEffect(()=>{const e=()=>x("paypal"===localStorage.getItem("flux_preferred_provider"));return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);const m=()=>{localStorage.setItem("flux_preferred_provider","paypal"),x(!0),window.dispatchEvent(new Event("storage"))},g=async()=>{if(window.confirm("Deseja desconectar o PayPal?")){p(!0);try{await t.updatePaymentConfig({providerId:"paypal",isConnected:!1}),"paypal"===localStorage.getItem("flux_preferred_provider")&&localStorage.removeItem("flux_preferred_provider"),n("paypal",!1)}catch(e){alert("Erro ao desconectar")}finally{p(!1)}}};return r?a.jsxs("div",{className:"animate-fade-in",style:{textAlign:"center",padding:"10px"},children:[a.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[a.jsxs("div",{className:"feedback-msg success !mt-0",children:[a.jsx("i",{className:"fa-solid fa-circle-check"})," PayPal Conectado"]}),a.jsx("button",{onClick:m,className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 flex items-center justify-center transition-all "+(f?"text-[#00c2ff] border-[#00c2ff]/50 bg-[#00c2ff]/10":"text-gray-400 hover:text-[#00c2ff]"),title:"Ver no Painel",children:a.jsx("i",{className:"fa-solid fa-eye"})})]}),a.jsx("button",{className:"disconnect-btn",onClick:g,disabled:l,children:l?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Desconectar"})]}):a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("div",{className:"input-group",children:[a.jsx("label",{children:"Client ID"}),a.jsx("input",{type:"text",value:s,onChange:e=>o(e.target.value),placeholder:"PayPal Client ID"})]}),a.jsxs("div",{className:"input-group",children:[a.jsx("label",{children:"Secret Key"}),a.jsx("input",{type:"password",value:c,onChange:e=>d(e.target.value),placeholder:"PayPal Secret Key"})]}),a.jsx("button",{className:"save-btn",onClick:async()=>{if(s&&c){p(!0);try{await i.authenticate(s,c);const e={providerId:"paypal",clientId:s,clientSecret:c,isConnected:!0};await t.updatePaymentConfig(e),n("paypal",!0)}catch(e){alert("Erro na conexão com PayPal")}finally{p(!1)}}},disabled:l,children:l?a.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"Conectar PayPal"})]})},l=()=>{const r=n(),[s,i]=e.useState(null),[l,p]=e.useState(new Set),f=e.useRef(!1),x=e.useMemo(()=>[{id:"syncpay",name:"SyncPay (Oficial)",icon:"fa-bolt",isPrimary:!0,status:"active",methods:[{type:"pix",label:"PIX"}]},{id:"stripe",name:"Stripe",icon:"fa-brands fa-stripe",status:"active",methods:[{type:"card",label:"Cartão"}]},{id:"paypal",name:"PayPal",icon:"fa-brands fa-paypal",status:"active",methods:[{type:"pix",label:"PIX"},{type:"card",label:"Cartão"}]},{id:"picpay",name:"PicPay",icon:"fa-qrcode",status:"coming_soon",methods:[{type:"pix",label:"PIX"},{type:"card",label:"Cartão"}]}],[]);e.useEffect(()=>{(()=>{const e=t.getCurrentUser();if(e){const a=new Set;e.paymentConfigs&&Object.values(e.paymentConfigs).forEach(e=>{e.isConnected&&a.add(e.providerId)}),e.paymentConfig&&e.paymentConfig.isConnected&&a.add(e.paymentConfig.providerId),p(a),f.current||(a.size>0?i(Array.from(a)[0]):i("syncpay"),f.current=!0)}})()},[]);const m=(e,a)=>{p(t=>{const r=new Set(t);return a?r.add(e):(r.delete(e),s===e&&i(null)),r})},g=x.filter(e=>l.has(e.id)),u=x.filter(e=>!l.has(e.id)),h=e=>{const t=s===e.id,r="coming_soon"===e.status,n=l.has(e.id);return a.jsxs("div",{className:`provider-card ${e.isPrimary?"primary":""} ${n?"connected":""}`,style:{opacity:r?.6:1},children:[a.jsxs("div",{className:"provider-header",onClick:()=>{return!r&&(a=e.id,void i(e=>e===a?null:a));var a},children:[a.jsxs("div",{className:"provider-info",children:[a.jsx("div",{className:"provider-icon",style:{filter:r?"grayscale(100%)":"none"},children:a.jsx("i",{className:`fa-solid ${e.icon}`})}),a.jsxs("div",{className:"provider-name",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[e.name,n&&a.jsx("i",{className:"fa-solid fa-circle-check text-[#00ff82] text-xs"})]}),a.jsx("div",{className:"method-indicators",children:e.methods.map((e,t)=>a.jsxs("div",{className:"method-item",children:[a.jsx("div",{className:"method-dot "+(n?"active":"")}),e.label]},t))}),r&&a.jsx("span",{className:"badge-soon",children:"Em Breve"})]})]}),!r&&a.jsx("i",{className:"fa-solid fa-chevron-down arrow-icon "+(t?"expanded":"")})]}),t&&!r&&a.jsxs("div",{className:"provider-body",children:["syncpay"===e.id&&a.jsx(o,{isConnected:n,onStatusChange:m}),"stripe"===e.id&&a.jsx(c,{isConnected:n,onStatusChange:m}),"paypal"===e.id&&a.jsx(d,{isConnected:n,onStatusChange:m})]})]},e.id)};return a.jsxs("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[a.jsx("style",{children:"\n        header {\n            display:flex; align-items:center; padding:16px 24px;\n            background: #0c0f14; position:fixed; width:100%; top:0; z-index:10;\n            border-bottom:1px solid rgba(255,255,255,0.1); height: 65px;\n        }\n        header button { background:none; border:none; color:#00c2ff; font-size:24px; cursor:pointer; padding-right: 15px; }\n        header h1 { font-size:18px; font-weight:700; color:#fff; }\n        \n        main { padding: 90px 20px 40px 20px; max-width: 600px; margin: 0 auto; width: 100%; }\n\n        .section-header {\n            font-size: 10px; font-weight: 900; color: #555; text-transform: uppercase;\n            letter-spacing: 2px; margin: 30px 0 15px 5px; display: flex; align-items: center; gap: 10px;\n        }\n        .section-header span { flex-grow: 1; height: 1px; background: rgba(255,255,255,0.05); }\n        \n        .provider-card {\n            background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05);\n            border-radius: 20px; margin-bottom: 12px; overflow: hidden; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n        .provider-card.primary { border-color: rgba(0, 194, 255, 0.3); background: rgba(0, 194, 255, 0.02); }\n        .provider-card.connected { border-color: rgba(0, 255, 130, 0.2); }\n        \n        .provider-header {\n            display: flex; align-items: center; justify-content: space-between;\n            padding: 20px; cursor: pointer; transition: 0.2s;\n        }\n        .provider-header:hover { background: rgba(255,255,255,0.03); }\n\n        .provider-info { display: flex; align-items: center; gap: 15px; }\n        .provider-icon {\n            width: 44px; height: 44px; border-radius: 12px;\n            background: #1a1e26; color: #00c2ff;\n            display: flex; align-items: center; justify-content: center; font-size: 20px;\n            border: 1px solid rgba(255,255,255,0.05);\n        }\n        \n        .provider-name { font-size: 15px; font-weight: 800; color: #fff; display: flex; flex-direction: column; }\n        .method-indicators { display: flex; gap: 12px; margin-top: 6px; }\n        .method-item { display: flex; align-items: center; gap: 5px; font-size: 10px; color: #666; font-weight: 700; text-transform: uppercase; }\n        .method-dot { width: 6px; height: 6px; border-radius: 50%; background: #333; }\n        .method-dot.active { background: #00ff82; box-shadow: 0 0 8px rgba(0, 255, 130, 0.4); }\n\n        .arrow-icon { color: #555; transition: 0.3s; font-size: 14px; }\n        .arrow-icon.expanded { transform: rotate(180deg); color: #00c2ff; }\n        \n        .provider-body { padding: 5px 20px 25px 20px; border-top: 1px solid rgba(255,255,255,0.03); animation: slideDown 0.3s ease; }\n        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }\n\n        .input-group { margin-bottom: 18px; }\n        .input-group label { display: block; font-size: 11px; font-weight: 800; color: #555; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px; }\n        .input-group input { \n            width: 100%; background: #0c0f14; border: 1px solid rgba(255,255,255,0.1); \n            padding: 14px; border-radius: 12px; color: #fff; font-size: 14px; outline: none; transition: 0.3s;\n        }\n        .input-group input:focus { border-color: #00c2ff; box-shadow: 0 0 15px rgba(0,194,255,0.1); }\n\n        .save-btn {\n            width: 100%; padding: 16px; background: #00c2ff; color: #000; border: none;\n            border-radius: 14px; font-weight: 900; font-size: 14px; cursor: pointer;\n            transition: 0.3s; text-transform: uppercase; letter-spacing: 1px;\n            display: flex; align-items: center; justify-content: center; gap: 10px;\n            box-shadow: 0 4px 15px rgba(0,194,255,0.2);\n        }\n        .save-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,194,255,0.4); }\n        .save-btn:active { transform: scale(0.98); }\n        .save-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }\n\n        .disconnect-btn {\n            width: 100%; padding: 12px; background: rgba(255, 77, 77, 0.05); color: #ff4d4d;\n            border: 1px solid rgba(255, 77, 77, 0.2); border-radius: 12px; font-weight: 800;\n            font-size: 12px; cursor: pointer; transition: 0.3s; text-transform: uppercase;\n        }\n        .disconnect-btn:hover { background: rgba(255, 77, 77, 0.15); border-color: #ff4d4d; }\n\n        .feedback-msg {\n            margin-top: 15px; padding: 12px; border-radius: 10px; font-size: 12px;\n            display: flex; align-items: center; gap: 8px; font-weight: 700;\n        }\n        .feedback-msg.success { background: rgba(0, 255, 130, 0.1); color: #00ff82; border: 1px solid rgba(0, 255, 130, 0.2); }\n        .feedback-msg.error { background: rgba(255, 77, 77, 0.1); color: #ff4d4d; border: 1px solid rgba(255, 77, 77, 0.2); }\n\n        .badge-soon { background: rgba(255,255,255,0.05); color: #444; font-size: 9px; padding: 2px 6px; border-radius: 4px; font-weight: 900; margin-top: 5px; align-self: flex-start; text-transform: uppercase; }\n      "}),a.jsxs("header",{children:[a.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?r(-1):r("/financial")},children:a.jsx("i",{className:"fa-solid fa-arrow-left"})}),a.jsx("h1",{children:"Provedores de Pagamento"})]}),a.jsxs("main",{className:"no-scrollbar",children:[g.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"section-header",children:[a.jsx("span",{})," Conectados ",a.jsx("span",{})]}),g.map(h)]}),a.jsxs("div",{className:"section-header",children:[a.jsx("span",{})," Disponíveis ",a.jsx("span",{})]}),u.map(h),a.jsxs("div",{className:"mt-12 p-6 bg-white/[0.02] border border-dashed border-white/5 rounded-2xl text-center opacity-30",children:[a.jsx("i",{className:"fa-solid fa-shield-halved text-2xl mb-3"}),a.jsx("p",{className:"text-[10px] uppercase font-black tracking-[2px] leading-relaxed",children:"Suas credenciais são criptografadas e enviadas via túnel seguro. O Flux não armazena chaves privadas em texto aberto."})]})]})]})};export{l as ProviderConfig};
