import{u as e,a,r as t,c as i,g as o,j as n,h as s}from"./index-DHTLMDH8.js";import{p as l}from"./postService-D2IH4U_j.js";import{c as r}from"./contentSafetyService-ChNoyba1.js";import{g as d}from"./idGenerator-C-_CWH9r.js";const c={Brasil:{"Ceará":["Fortaleza","Eusébio","Aquiraz","Sobral"],"São Paulo":["São Paulo","Campinas","Santos","Guarulhos"],"Rio de Janeiro":["Rio de Janeiro","Niterói","Cabo Frio"],"Minas Gerais":["Belo Horizonte","Uberlândia","Ouro Preto"]},"Estados Unidos":{California:["Los Angeles","San Francisco","San Diego"],"New York":["New York City","Buffalo"],Florida:["Miami","Orlando"]},Portugal:{Lisboa:["Lisboa","Sintra","Cascais"],Porto:["Porto","Vila Nova de Gaia"]}},p=()=>{var p,x;const u=e(),m=a().state,g=(null==m?void 0:m.isAd)||!1,[f,h]=t.useState(""),[b,v]=t.useState([]),[j,y]=t.useState(!0),[N,k]=t.useState(!1),[w,C]=t.useState(""),[S,z]=t.useState(""),[P,A]=t.useState(!1),[I,G]=t.useState(!1),[B,E]=t.useState(""),[F,L]=t.useState(""),[O,U]=t.useState(""),[T,R]=t.useState("Global"),[D,M]=t.useState(!1),[$,q]=t.useState([]),[V,J]=t.useState(null),[W,Y]=t.useState(!0),_=i.getCurrentUser(),H=(null==(p=null==_?void 0:_.profile)?void 0:p.name)?`@${_.profile.name}`:"@usuario",K=null==(x=null==_?void 0:_.profile)?void 0:x.photoUrl;t.useEffect(()=>{const e=f.trim().length,a=b.length>0,t=!g||w&&parseFloat(w)>=10;let i=!0;V&&"inactive"===V.status&&(i=!1),y(!(e>0||a||V&&i)||!t||N)},[f,b,N,w,g,V]),t.useEffect(()=>{const e=i.getCurrentUserEmail();if(e){const a=o.getGroupsSync().filter(a=>a.creatorEmail===e);q(a)}},[]);const Q=Object.keys(c),X=B?Object.keys(c[B]||{}):[],Z=B&&F&&c[B][F]||[];return n.jsxs("div",{className:"h-screen flex flex-col bg-[#0c0f14] text-white font-['Inter'] overflow-hidden",children:[n.jsx("style",{children:"\n        header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid rgba(255,255,255,0.1); height: 60px; z-index: 50; background: #0c0f14; }\n        header button { background: none; border: none; font-size: 16px; color: #fff; cursor: pointer; }\n        header .publish-btn { background: #00c2ff; color: #000; padding: 6px 16px; border-radius: 20px; font-weight: 700; font-size: 14px; opacity: 1; transition: opacity 0.3s; }\n        header .publish-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #333; color: #777; }\n        \n        main { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 20px; }\n        \n        .input-area { display: flex; gap: 12px; }\n        .user-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid #333; flex-shrink: 0; }\n        .text-field { flex: 1; background: transparent; border: none; color: #fff; font-size: 16px; resize: none; min-height: 100px; outline: none; padding-top: 8px; }\n        .text-field::placeholder { color: #555; }\n\n        .media-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; }\n        .media-item { width: 100px; height: 120px; border-radius: 8px; position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); flex-shrink: 0; }\n        .media-item img { width: 100%; height: 100%; object-fit: cover; }\n        .remove-btn { position: absolute; top: 4px; right: 4px; background: rgba(0,0,0,0.6); color: #fff; border: none; width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; cursor: pointer; }\n\n        .toolbar { display: flex; gap: 15px; border-top: 1px solid rgba(255,255,255,0.05); border-bottom: 1px solid rgba(255,255,255,0.05); padding: 15px 0; align-items: center; }\n        .tool-btn { background: none; border: none; color: #00c2ff; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; transition: background 0.2s; }\n        .tool-btn:hover { background: rgba(0,194,255,0.1); }\n\n        .settings-list { display: flex; flex-direction: column; gap: 2px; }\n        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; }\n        .setting-left { display: flex; align-items: center; gap: 10px; color: #fff; font-size: 15px; font-weight: 500; }\n        .setting-icon { color: #888; width: 20px; text-align: center; }\n        .setting-value { color: #00c2ff; font-size: 14px; margin-right: 10px; font-weight: 600; }\n        .chevron { color: #555; font-size: 12px; }\n\n        .ad-box { background: rgba(255,215,0,0.05); border: 1px solid rgba(255,215,0,0.2); border-radius: 10px; padding: 15px; margin-bottom: 10px; }\n        .ad-input { width: 100%; background: #000; border: 1px solid #333; color: #fff; padding: 10px; border-radius: 6px; margin-top: 5px; outline: none; }\n        \n        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; display: flex; align-items: center; justify-content: center; }\n        .modal { background: #1a1e26; width: 90%; max-width: 350px; border-radius: 16px; padding: 20px; border: 1px solid #333; }\n        .modal select { width: 100%; background: #0c0f14; border: 1px solid #333; color: #fff; padding: 10px; border-radius: 8px; margin-bottom: 10px; outline: none; }\n        .modal-actions { display: flex; gap: 10px; margin-top: 15px; }\n        .modal-btn { flex: 1; padding: 10px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer; }\n        .save-btn { background: #00c2ff; color: #000; }\n        .cancel-btn { background: transparent; border: 1px solid #555; color: #aaa; }\n        \n        .group-list { max-height: 200px; overflow-y: auto; }\n        .group-item { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; display: flex; align-items: center; gap: 10px; }\n        .group-item:hover { background: rgba(255,255,255,0.05); }\n      "}),n.jsxs("header",{children:[n.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?u(-1):u("/feed")},children:"Cancelar"}),n.jsx("span",{style:{fontWeight:700,fontSize:"16px"},children:"Novo Post"}),n.jsx("button",{id:"publishbtn",className:"publish-btn",disabled:j,onClick:e=>{e.preventDefault(),j||(k(!0),setTimeout(async()=>{try{const e=b.map(e=>l.uploadMedia(e.file)),a=(await Promise.all(e)).filter(e=>""!==e),t=await r.analyzeContent(f,a.map(e=>({url:e})));let i=P;t.isAdult&&(i=!0);const o=a.length>0?a[0]:void 0,n={id:d(),type:a.length>0?"photo":"text",authorId:(null==_?void 0:_.id)||"",username:H,avatar:K,text:f,image:o,images:a.length>0?a:void 0,video:void 0,time:"Agora",timestamp:Date.now(),isPublic:!0,isAdultContent:i,isAd:g,views:0,likes:0,comments:0,liked:!1,location:"Global"===T?void 0:T,relatedGroupId:null==V?void 0:V.id};await l.addPost(n),(null==V?void 0:V.isVip)&&W&&await s.createCampaign({id:d(),ownerId:(null==_?void 0:_.id)||"",name:`Auto-Boost: ${V.name}`,ownerEmail:(null==_?void 0:_.email)||"",scheduleType:"continuous",budget:0,pricingModel:"commission",trafficObjective:"conversions",creative:{text:f,mediaUrl:o,mediaType:"image"},campaignObjective:"group_joins",destinationType:"group",targetGroupId:V.id,optimizationGoal:"group_joins",placements:["feed","reels","marketplace"],ctaButton:"Entrar",status:"active",timestamp:Date.now()}),u(V?`/group-chat/${V.id}`:"/feed")}catch(e){alert("Erro ao publicar.")}finally{k(!1)}},50))},children:N?"...":g?"Confirmar":"Publicar"})]}),n.jsxs("main",{children:[g&&n.jsxs("div",{className:"ad-box",children:[n.jsx("div",{style:{color:"#FFD700",fontSize:"12px",fontWeight:"900",marginBottom:"5px"},children:"IMPULSIONAMENTO PUBLICITÁRIO"}),n.jsx("input",{type:"number",className:"ad-input",placeholder:"Investimento (Min R$ 10,00)",value:w,onChange:e=>C(e.target.value)}),n.jsx("input",{type:"text",className:"ad-input",placeholder:"Link de Ação (https://...)",value:S,onChange:e=>z(e.target.value)})]}),n.jsxs("div",{className:"input-area",children:[K?n.jsx("img",{src:K,className:"user-avatar",alt:"Avatar"}):n.jsx("div",{className:"user-avatar",style:{background:"#333",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx("i",{className:"fa-solid fa-user text-gray-500"})}),n.jsx("textarea",{className:"text-field",placeholder:"No que você está pensando?",value:f,onChange:e=>h(e.target.value)})]}),b.length>0&&n.jsx("div",{className:"media-scroll",children:b.map((e,a)=>n.jsxs("div",{className:"media-item",children:[n.jsx("img",{src:e.url,alt:"Preview"}),n.jsx("button",{className:"remove-btn",onClick:()=>{return e=a,void v(a=>a.filter((a,t)=>t!==e));var e},children:n.jsx("i",{className:"fa-solid fa-xmark"})})]},a))}),n.jsxs("div",{className:"toolbar",children:[n.jsx("button",{className:"tool-btn",onClick:()=>{var e;return null==(e=document.getElementById("mediaInput"))?void 0:e.click()},children:n.jsx("i",{className:"fa-regular fa-image"})}),n.jsx("button",{className:"tool-btn",onClick:()=>u("/create-poll"),children:n.jsx("i",{className:"fa-solid fa-square-poll-horizontal"})}),n.jsx("input",{type:"file",id:"mediaInput",hidden:!0,multiple:!0,accept:"image/*",onChange:e=>{const a=e.target.files?Array.from(e.target.files):[];if(a.length>0){if(a.length+b.length>5)return void alert("Limite de 5 arquivos.");const e=a.map(e=>({file:e,url:URL.createObjectURL(e),type:"image"}));v(a=>[...a,...e])}}})]}),n.jsxs("div",{className:"settings-list",children:[n.jsxs("div",{className:"setting-item",onClick:()=>G(!0),children:[n.jsxs("div",{className:"setting-left",children:[n.jsx("i",{className:"fa-solid fa-location-dot setting-icon"}),n.jsx("span",{children:"Direcionamento Regional"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("span",{className:"setting-value",children:T}),n.jsx("i",{className:"fa-solid fa-chevron-right chevron"})]})]}),n.jsxs("div",{className:"setting-item",onClick:()=>M(!0),children:[n.jsxs("div",{className:"setting-left",children:[n.jsx("i",{className:"fa-solid fa-users setting-icon"}),n.jsx("span",{children:"Vincular Comunidade"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[n.jsx("span",{className:"setting-value",style:{color:V?"#00ff82":"#555"},children:V?V.name.substring(0,15)+"...":"Nenhum"}),V&&n.jsx("i",{className:"fa-solid fa-xmark",style:{marginLeft:"5px",color:"#ff4d4d"},onClick:e=>{e.stopPropagation(),J(null)}}),!V&&n.jsx("i",{className:"fa-solid fa-chevron-right chevron"})]})]})]})]}),I&&n.jsx("div",{className:"modal-overlay",onClick:()=>G(!1),children:n.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[n.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:"Alcance do Post"}),n.jsxs("select",{value:B,onChange:e=>{E(e.target.value),L(""),U("")},children:[n.jsx("option",{value:"",children:"Global (Todos)"}),Q.map(e=>n.jsx("option",{value:e,children:e},e))]}),B&&n.jsxs("select",{value:F,onChange:e=>{L(e.target.value),U("")},children:[n.jsx("option",{value:"",children:"Todo o País"}),X.map(e=>n.jsx("option",{value:e,children:e},e))]}),F&&n.jsxs("select",{value:O,onChange:e=>U(e.target.value),children:[n.jsx("option",{value:"",children:"Todo o Estado"}),Z.map(e=>n.jsx("option",{value:e,children:e},e))]}),n.jsxs("div",{className:"modal-actions",children:[n.jsx("button",{className:"modal-btn cancel-btn",onClick:()=>{R("Global"),G(!1)},children:"Resetar"}),n.jsx("button",{className:"modal-btn save-btn",onClick:()=>{let e="Global";O?e=`${O}, ${F}`:F?e=`${F}, Brasil`:B&&(e="Brasil"===B?"Global":B),R(e),G(!1)},children:"Aplicar"})]})]})}),D&&n.jsx("div",{className:"modal-overlay",onClick:()=>M(!1),children:n.jsxs("div",{className:"modal",onClick:e=>e.stopPropagation(),children:[n.jsx("h3",{style:{color:"#fff",marginBottom:"15px",textAlign:"center"},children:"Selecionar Grupo"}),n.jsx("div",{className:"group-list",children:$.length>0?$.map(e=>n.jsxs("div",{className:"group-item",onClick:()=>{J(e),M(!1)},children:[n.jsx("i",{className:"fa-solid "+(e.isVip?"fa-crown text-[#FFD700]":"fa-users text-[#ccc]")}),n.jsx("span",{style:{color:"#fff",fontSize:"14px"},children:e.name})]},e.id)):n.jsx("div",{style:{textAlign:"center",color:"#555"},children:"Nenhum grupo encontrado."})}),n.jsx("div",{className:"modal-actions",children:n.jsx("button",{className:"modal-btn cancel-btn",onClick:()=>M(!1),children:"Fechar"})})]})})]})};export{p as CreatePost};
