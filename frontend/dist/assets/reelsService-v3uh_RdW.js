import{k as f,A as u,i as s,U as y}from"./index-BC19Iu_T.js";import{P as d,p as R}from"./postService-XFLx8Vj8.js";const c=`${u}/api/posts`,l=async(e,t,r=!1)=>{try{const o=await fetch(e);if(!o.ok)return console.error("Failed to fetch reels with status:",o.status),[];let i=((await o.json()).data||[]).filter(a=>a.type==="video");if(r||(i=i.filter(a=>!a.isAdultContent)),t){const a=f.getBlockedIdentifiers(t);a.size>0&&(i=i.filter(n=>{const p=String(n.username||"").replace("@","").toLowerCase();return!a.has(p)}))}return i.sort((a,n)=>(n.timestamp||0)-(a.timestamp||0))}catch(o){return console.warn("Reels fetch failed:",o),[]}},g={getReels:async(e,t=!1)=>l(`${c}?type=video&limit=50`,e,t),getReelsByAuthor:async(e,t,r=!1)=>l(`${c}/user/${e}?type=video`,t,r),searchReels:async(e,t,r=!1)=>{const o=e.toLowerCase().trim();return o?l(`${c}/search?q=${encodeURIComponent(o)}&type=video`,t,r):[]},uploadVideo:async e=>URL.createObjectURL(e),addReel:async e=>{await R.addPost(e)},toggleLike:async e=>await d.toggleLike(e,!1),incrementView:e=>{d.trackView(e)}},m={fetchReels:async()=>{},getReels:()=>s.posts.getAll().filter(e=>e.type==="video"),getReelsByAuthor:e=>s.posts.getAll().filter(t=>t.type==="video"&&t.authorId===e),searchReels:e=>{const t=e.toLowerCase();return s.posts.getAll().filter(r=>r.type==="video"&&r.text.toLowerCase().includes(t))},uploadVideo:async e=>URL.createObjectURL(e),addReel:async e=>s.posts.add(e),toggleLike:async e=>{const t=s.posts.findById(e);if(t)return t.liked=!t.liked,t.likes+=t.liked?1:-1,s.posts.update(t),t},incrementView:e=>{const t=s.posts.findById(e);t&&(t.views++,s.posts.update(t))},getReelById:e=>s.posts.findById(e)},k=y?m:g;export{k as r};
