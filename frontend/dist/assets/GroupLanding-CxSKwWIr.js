import{j as e,u as t,f as s,r as a,g as n,c as l,i}from"./index-CipjSFYz.js";const r={isFull(e){var t,s;if(!(null==(t=e.settings)?void 0:t.memberLimit))return!1;return((null==(s=e.memberIds)?void 0:s.length)||0)>=e.settings.memberLimit},getLottationStatus(e){var t,s;if(!(null==(t=e.settings)?void 0:t.memberLimit))return"available";const a=(null==(s=e.memberIds)?void 0:s.length)||0,n=e.settings.memberLimit;return a>=n?"full":a>=.9*n?"near_full":"available"}},o=({group:t})=>{var s,a;const n=r.getLottationStatus(t),l=(null==(s=t.memberIds)?void 0:s.length)||0,i=null==(a=t.settings)?void 0:a.memberLimit;return i?"full"===n?e.jsxs("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-[10px] font-black uppercase flex items-center gap-2 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.4)]",children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation"})," ESGOTADO (",l,"/",i,")"]}):"near_full"===n?e.jsxs("div",{className:"bg-orange-500 text-black px-3 py-1 rounded-full text-[10px] font-black uppercase flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-fire"})," ÚLTIMAS VAGAS (",l,"/",i,")"]}):e.jsxs("div",{className:"bg-white/10 text-gray-400 px-3 py-1 rounded-full text-[10px] font-bold uppercase",children:[l,"/",i," vagas preenchidas"]}):null},d=()=>{var d;const c=t(),{id:u}=s(),[m,x]=a.useState(null),[g,p]=a.useState(!0),[f,b]=a.useState(!1),[h,v]=a.useState(!1),[j,N]=a.useState(!1),[w,y]=a.useState(""),[I,S]=a.useState(void 0),[k,A]=a.useState(0);a.useEffect(()=>{var e,t,s,a,r,o,d;if(u){const m=n.getGroupById(u),g=l.getCurrentUserId();if(m){if(g&&(null==(e=m.memberIds)?void 0:e.includes(g))){const e=m.channels&&m.channels.length>0;return void c(e?`/group/${u}/channels`:`/group-chat/${u}`,{replace:!0})}if(x(m),g&&((null==(t=m.memberIds)?void 0:t.includes(g))&&b(!0),(null==(s=m.pendingMemberIds)?void 0:s.includes(g))&&v(!0),(null==(a=m.bannedUserIds)?void 0:a.includes(g))&&N(!0)),m.creatorEmail){const e=i.users.get(m.creatorEmail)||Object.values(i.users.getAll()).find(e=>e.email===m.creatorEmail);e?(y((null==(r=e.profile)?void 0:r.nickname)||(null==(o=e.profile)?void 0:o.name)||"Criador"),S(null==(d=e.profile)?void 0:d.photoUrl)):y("Administrador")}else y("Administrador");if(m.memberIds&&m.memberIds.length>0){const e=Object.values(i.users.getAll()),t=new Set(m.memberIds),s=e.filter(e=>t.has(e.id)&&e.lastSeen&&Date.now()-e.lastSeen<9e5).length;A(s||1)}}p(!1)}},[u,c]);return g?e.jsx("div",{className:"h-screen bg-[#0c0f14] flex items-center justify-center text-white",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-2xl text-[#00c2ff]"})}):m?e.jsxs("div",{className:"min-h-screen bg-[#0c0f14] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[e.jsx("style",{children:"\n            .landing-hero { width: 100%; height: 300px; position: relative; overflow: hidden; }\n            .hero-bg { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.4) blur(10px); transform: scale(1.1); }\n            .hero-content { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5; }\n            .group-avatar-large { width: 120px; height: 120px; border-radius: 32px; border: 4px solid #00c2ff; background: #1a1e26; object-fit: cover; margin-bottom: 20px; }\n            .landing-body { flex-grow: 1; padding: 30px 24px; background: #0c0f14; border-radius: 30px 30px 0 0; margin-top: -30px; position: relative; z-index: 10; }\n            .stat-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; background: rgba(255,255,255,0.05); border-radius: 20px; font-size: 12px; }\n            .join-btn-large { width: 100%; padding: 18px; border: none; border-radius: 16px; background: #00c2ff; color: #000; font-size: 16px; font-weight: 800; cursor: pointer; text-transform: uppercase; }\n            .join-btn-large:disabled { background: #333; color: #777; cursor: not-allowed; opacity: 0.7; }\n        "}),e.jsx("button",{className:"absolute top-5 left-5 z-50 w-10 h-10 rounded-full bg-black/50 flex items-center justify-center border border-white/10",onClick:()=>c("/groups"),children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("img",{src:m.coverImage||"https://via.placeholder.com/800",className:"hero-bg",alt:"bg"}),e.jsxs("div",{className:"hero-content",children:[e.jsx("img",{src:m.coverImage||"https://via.placeholder.com/150",className:"group-avatar-large",alt:"Avatar"}),e.jsx("h1",{className:"text-2xl font-black text-white text-center px-6",children:m.name}),e.jsxs("div",{className:"flex flex-col items-center gap-3 mt-4",children:[e.jsx(o,{group:m}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"stat-badge",children:[e.jsx("i",{className:"fa-solid fa-user-group"})," ",(null==(d=m.memberIds)?void 0:d.length)||0," membros"]}),e.jsxs("div",{className:"stat-badge",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 shadow-[0_0_5px_green]"})," ",k," online"]})]})]})]})]}),e.jsxs("main",{className:"landing-body",children:[e.jsx("div",{className:"text-center text-gray-400 mb-8 leading-relaxed",children:m.description||"Bem-vindo a esta comunidade!"}),j?e.jsx("button",{className:"join-btn-large !bg-red-500 !text-white",disabled:!0,children:"Você foi banido"}):h?e.jsx("button",{className:"join-btn-large !bg-gray-800",disabled:!0,children:"Solicitação Enviada"}):e.jsx("button",{className:"join-btn-large",onClick:()=>{if(!m||!u)return;if(j)return;if(r.isFull(m))return void alert("Lamentamos, mas este grupo atingiu o limite máximo de participantes.");const e=n.joinGroup(u);if("joined"===e){const e=m.channels&&m.channels.length>0;c(e?`/group/${u}/channels`:`/group-chat/${u}`)}else"pending"===e&&v(!0)},disabled:r.isFull(m),children:r.isFull(m)?"Grupo Lotado":f?"Acessar Conversa":"Entrar no Grupo"})]})]}):e.jsx("div",{className:"h-screen bg-[#0c0f14] flex flex-col items-center justify-center text-white p-6",children:e.jsx("h1",{className:"text-xl font-bold",children:"Grupo não encontrado"})})};export{d as GroupLanding};
