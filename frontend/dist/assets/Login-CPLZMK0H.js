import{j as e,L as h,u as T,a as B,r as s,l as f,b as m,t as A,c as w,A as _}from"./index-BC19Iu_T.js";const P=({onSelectEmail:l,googleButtonId:d,loading:n,googleProcessing:o})=>e.jsxs("div",{className:"w-full flex flex-col items-center animate-fade-in",children:[e.jsxs("div",{className:"mb-8 w-[80px] h-[80px] bg-white/5 rounded-2xl flex items-center justify-center relative border border-white/10 shadow-[0_0_30px_rgba(0,194,255,0.2)]",children:[e.jsx("div",{className:"absolute w-[50px] h-[28px] rounded-[50%] border-[4px] border-[#00c2ff] rotate-[25deg]"}),e.jsx("div",{className:"absolute w-[50px] h-[28px] rounded-[50%] border-[4px] border-[#00c2ff] -rotate-[25deg]"})]}),e.jsx("h1",{className:"text-3xl font-bold text-center mb-3 text-white",children:"Flux"}),e.jsx("p",{className:"text-gray-400 text-sm text-center mb-8 leading-relaxed",children:"Sua plataforma de conexão e conteúdo."}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"relative min-h-[50px]",children:[e.jsxs("div",{className:"w-full h-[50px] bg-white text-gray-700 border border-gray-300 rounded-lg font-bold flex items-center justify-center gap-3 shadow-sm pointer-events-none",children:[e.jsx("i",{className:"fa-brands fa-google text-lg"}),e.jsx("span",{className:"text-sm",children:"Entrar com Google"})]}),e.jsx("div",{id:d,className:"absolute inset-0 z-10 opacity-0 overflow-hidden cursor-pointer"})]}),e.jsxs("button",{onClick:l,className:"w-full py-3.5 bg-white/5 border border-white/10 text-white font-bold rounded-lg hover:bg-white/10 transition-all flex items-center justify-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-envelope"}),"Entrar com E-mail e Senha"]})]}),e.jsxs("div",{className:"mt-8 flex flex-col gap-3 items-center text-sm w-full",children:[e.jsx("div",{className:"w-full h-[1px] bg-white/5"}),e.jsxs("div",{className:"flex gap-6 mt-2",children:[e.jsx(h,{to:"/register",className:"text-[#00c2ff] hover:underline font-semibold",children:"Criar conta"}),e.jsx("span",{className:"text-gray-700",children:"|"}),e.jsx(h,{to:"/forgot-password",title:"Esqueci a senha",className:"text-gray-400 hover:text-white transition-colors",children:"Esqueci a senha"})]})]})]}),U=({email:l,setEmail:d,password:n,setPassword:o,onSubmit:b,onBackToGoogle:c,loading:r,error:x})=>e.jsxs("div",{className:"w-full animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"mb-4 w-[60px] h-[60px] bg-white/5 rounded-xl flex items-center justify-center relative border border-white/10",children:[e.jsx("div",{className:"absolute w-[35px] h-[20px] rounded-[50%] border-[3px] border-[#00c2ff] rotate-[25deg]"}),e.jsx("div",{className:"absolute w-[35px] h-[20px] rounded-[50%] border-[3px] border-[#00c2ff] -rotate-[25deg]"})]}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Acesse sua conta"}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Insira suas credenciais abaixo"})]}),x&&e.jsxs("div",{className:"mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-400 text-xs text-center animate-shake",children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation mr-2"}),x]}),e.jsxs("form",{onSubmit:b,className:"w-full space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-at absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-sm"}),e.jsx("input",{type:"email",placeholder:"E-mail",value:l,onChange:u=>d(u.target.value),className:"w-full p-3.5 pl-11 bg-black/20 border border-white/10 rounded-xl text-white outline-none focus:border-[#00c2ff] transition-all placeholder-gray-600",required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-sm"}),e.jsx("input",{type:"password",placeholder:"Senha",value:n,onChange:u=>o(u.target.value),className:"w-full p-3.5 pl-11 bg-black/20 border border-white/10 rounded-xl text-white outline-none focus:border-[#00c2ff] transition-all placeholder-gray-600",required:!0})]}),e.jsx("button",{type:"submit",disabled:r,className:"w-full py-4 bg-[#00c2ff] text-black font-black rounded-xl hover:bg-[#00aaff] transition-all shadow-lg shadow-[#00c2ff]/20 disabled:opacity-50 active:scale-[0.98]",children:r?e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"ENTRAR"})]}),e.jsxs("div",{className:"mt-6 flex flex-col items-center gap-4",children:[e.jsxs("button",{onClick:c,className:"text-sm font-bold text-[#00c2ff] hover:text-white transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"fa-brands fa-google"}),"Entrar com Google"]}),e.jsx("div",{className:"w-full h-[1px] bg-white/5"}),e.jsxs("div",{className:"flex gap-4 text-xs font-semibold",children:[e.jsx(h,{to:"/register",className:"text-gray-400 hover:text-[#00c2ff] transition-colors",children:"CRIAR CONTA"}),e.jsx("span",{className:"text-gray-800",children:"•"}),e.jsx(h,{to:"/forgot-password",title:"Esqueci a senha",className:"text-gray-400 hover:text-white transition-colors",children:"RECUPERAR SENHA"})]})]})]}),H=()=>{const l=T(),d=B(),[n,o]=s.useState(!1),[b,c]=s.useState(null),r=s.useRef(!1),x=s.useCallback(async a=>{if(!r.current){r.current=!0,f.info(m.AUTH,"Tentativa de login com Google iniciada"),o(!0),c(null);try{const i=A.getAffiliateRef()||void 0,t=await w.loginWithGoogle(a,i);if(t&&t.user&&t.nextStep)f.info(m.AUTH,"Login com Google bem-sucedido, navegando",{userId:t.user.id,nextStep:t.nextStep}),l(t.nextStep,{replace:!0});else throw new Error("Resposta de autenticação inválida do servidor.")}catch(i){f.error(m.AUTH,"Falha no login com Google",i),c(i.message||"Falha ao autenticar com Google."),o(!1),r.current=!1}}},[l]),u=s.useCallback(async(a,i)=>{if(!r.current){r.current=!0,o(!0),c(null);try{const t=await w.login(a,i);if(t&&t.user&&t.nextStep)l(t.nextStep,{replace:!0});else throw new Error("Resposta de autenticação de e-mail inválida.")}catch(t){c(t.message||"Credenciais de e-mail inválidas."),o(!1),r.current=!1}}},[l]),[g,C]=s.useState(!0),[p,j]=s.useState(!1),[N,G]=s.useState(""),[y,I]=s.useState(""),E="googleButtonDiv";s.useEffect(()=>{A.captureUrlParams()},[d]),s.useEffect(()=>{w.isAuthenticated()?l("/feed",{replace:!0}):C(!1)},[l]);const S=s.useCallback(a=>{a?.credential?x(a.credential):f.error(m.AUTH,"Resposta de credencial do Google inválida",a)},[x]),R=a=>{a.preventDefault(),u(N,y)};return s.useEffect(()=>{if(g||p)return;let a=!0;return(async()=>{try{const v=(await(await fetch(`${_}/api/auth/config`)).json()).clientId;if(!a||!v||v.includes("CONFIGURADO"))return;const L=setInterval(()=>{const k=document.getElementById(E);typeof google<"u"&&google.accounts&&k&&(clearInterval(L),google.accounts.id.initialize({client_id:v,callback:S,auto_select:!1}),google.accounts.id.renderButton(k,{theme:"filled_black",size:"large",width:"400"}))},100)}catch(t){f.error(m.AUTH,"Falha ao inicializar Google Client",t)}})(),()=>{a=!1}},[g,p,S]),g?null:e.jsxs("div",{className:"min-h-screen w-full flex flex-col items-center justify-center bg-[#050505] text-white font-['Inter'] relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[600px] h-[600px] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[500px] h-[500px] bg-indigo-900/10 rounded-full blur-[100px]"})]}),e.jsxs("div",{className:"w-full max-w-[400px] mx-4 bg-white/5 backdrop-blur-2xl rounded-[32px] p-10 border border-white/10 shadow-2xl relative z-10 flex flex-col items-center",children:[p?e.jsx(U,{email:N,setEmail:G,password:y,setPassword:I,onSubmit:R,onBackToGoogle:()=>j(!1),loading:n,error:b||""}):e.jsx(P,{onSelectEmail:()=>j(!0),googleButtonId:E,loading:g,googleProcessing:n}),n&&e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm rounded-[32px] flex items-center justify-center z-50",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-[#00c2ff] text-2xl"})})]})]})};export{H as Login};
