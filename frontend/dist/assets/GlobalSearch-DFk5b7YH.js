import{u as n,e,r as a,c as s,i as r,j as i,x as o,k as t}from"./index-CipjSFYz.js";const l=()=>{const l=n(),{showAlert:c}=e(),[d,p]=a.useState(""),[f,u]=a.useState([]),[x,g]=a.useState(!1),[m,h]=a.useState(null),[b,w]=a.useState(0);a.useEffect(()=>{const n=setTimeout(async()=>{if(d.trim().length>0){g(!0);try{const n=await s.searchUsers(d);u(n)}catch(n){}finally{g(!1)}}else u([])},300);return()=>clearTimeout(n)},[d]),a.useEffect(()=>{const n=r.subscribe("relationships",()=>{w(n=>n+1)});return()=>n()},[]);return i.jsxs("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[i.jsx("style",{children:"\n        header {\n            display: flex; align-items: center; gap: 15px; padding: 16px 20px;\n            background: #0c0f14; position: fixed; width: 100%; z-index: 10;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.1); top: 0; height: 70px;\n        }\n        header button {\n            background: none; border: none; color: #00c2ff; font-size: 20px; cursor: pointer;\n        }\n        header h1 { font-size: 18px; font-weight: 600; color: #fff; }\n\n        main { padding-top: 80px; width: 100%; max-width: 600px; margin: 0 auto; padding-bottom: 20px; }\n\n        .search-container {\n            padding: 0 20px 20px 20px;\n        }\n        .search-input-wrapper {\n            position: relative;\n        }\n        .search-input-wrapper i {\n            position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #aaa;\n        }\n        .search-input-wrapper input {\n            width: 100%; padding: 12px 12px 12px 45px; background: #1a1e26;\n            border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;\n            color: #fff; font-size: 16px; outline: none; transition: 0.3s;\n        }\n        .search-input-wrapper input:focus {\n            border-color: #00c2ff; box-shadow: 0 0 10px rgba(0, 194, 255, 0.2);\n        }\n\n        .global-badge {\n            display: flex; align-items: center; justify-content: center; gap: 6px;\n            margin-top: 8px; font-size: 11px; color: #00ff82; text-transform: uppercase; letter-spacing: 1px;\n        }\n\n        .user-list { display: flex; flex-direction: column; }\n        .user-item {\n            display: flex; align-items: center; padding: 15px 20px;\n            border-bottom: 1px solid rgba(255,255,255,0.05);\n            cursor: pointer;\n            transition: background 0.2s;\n        }\n        .user-item:hover { background: rgba(255,255,255,0.05); }\n\n        .user-avatar {\n            width: 50px; height: 50px; border-radius: 50%; margin-right: 15px;\n            background: #333; display: flex; align-items: center; justify-content: center;\n            object-fit: cover; border: 1px solid #444; color: #888; font-size: 20px;\n        }\n        .user-info { flex-grow: 1; }\n        .user-name { font-weight: 600; font-size: 15px; color: #fff; display: block; text-transform: capitalize; }\n        .user-username { font-size: 13px; color: #888; }\n\n        .action-buttons { display: flex; gap: 10px; align-items: center; }\n\n        .action-btn {\n            padding: 8px 20px; border-radius: 20px; font-size: 13px; font-weight: 600;\n            border: none; cursor: pointer; transition: 0.2s; min-width: 80px;\n            display: flex; align-items: center; justify-content: center; gap: 5px;\n        }\n        .btn-follow {\n            background: #00c2ff; color: #000;\n        }\n        .btn-follow:hover { background: #0099cc; }\n        \n        .btn-requested {\n            background: transparent; border: 1px solid #aaa; color: #aaa;\n        }\n        .btn-following {\n            background: transparent; border: 1px solid #00c2ff; color: #00c2ff;\n        }\n        .action-btn:disabled { opacity: 0.6; cursor: not-allowed; }\n\n        .msg-btn {\n            width: 36px; height: 36px; border-radius: 50%; background: rgba(255,255,255,0.1);\n            display: flex; align-items: center; justify-content: center; color: #fff;\n            border: none; cursor: pointer; transition: 0.2s;\n        }\n        .msg-btn:hover { background: rgba(0,194,255,0.2); color: #00c2ff; }\n      "}),i.jsxs("header",{children:[i.jsx("button",{onClick:()=>{window.history.state&&window.history.state.idx>0?l(-1):l("/messages")},children:i.jsx("i",{className:"fa-solid fa-arrow-left"})}),i.jsx("h1",{children:"Encontrar Pessoas"})]}),i.jsxs("main",{children:[i.jsxs("div",{className:"search-container",children:[i.jsxs("div",{className:"search-input-wrapper",children:[i.jsx("i",{className:"fa-solid "+(x?"fa-circle-notch fa-spin":"fa-magnifying-glass")}),i.jsx("input",{type:"text",placeholder:"Pesquisar por nome ou @...",value:d,onChange:n=>p(n.target.value),autoFocus:!0})]}),i.jsxs("div",{className:"global-badge",children:[i.jsx("i",{className:"fa-solid fa-globe"})," Pesquisa Global"]})]}),i.jsxs("div",{className:"user-list",children:[f.map(n=>{var e,a,r,d,p;const f=(null==(e=n.profile)?void 0:e.name)||"unknown",u=o.isFollowing(f),x=(null==(a=n.profile)?void 0:a.isPrivate)||!1,g=s.getCurrentUserEmail(),b=n.email===g,w=m===n.id,j=!(x&&"following"!==u||b);let v="Seguir",y="action-btn btn-follow";return"requested"===u?(v="Solicitado",y="action-btn btn-requested"):"following"===u&&(v="Seguindo",y="action-btn btn-following"),i.jsxs("div",{className:"user-item",onClick:()=>(n=>{const e=n.startsWith("@")?n.substring(1):n;l(`/user/${e}`)})(f),children:[(null==(r=n.profile)?void 0:r.photoUrl)?i.jsx("img",{src:n.profile.photoUrl,className:"user-avatar",alt:f}):i.jsx("div",{className:"user-avatar",children:i.jsx("i",{className:"fa-solid fa-user"})}),i.jsxs("div",{className:"user-info",children:[i.jsx("span",{className:"user-name",children:(null==(d=n.profile)?void 0:d.nickname)||(null==(p=n.profile)?void 0:p.name)}),i.jsxs("span",{className:"user-username",children:["@",f]})]}),i.jsxs("div",{className:"action-buttons",children:[j&&i.jsx("button",{className:"msg-btn",onClick:e=>{e.stopPropagation(),(n=>{const e=s.getCurrentUserEmail();if(e&&n.email){const a=t.getPrivateChatId(e,n.email);l(`/chat/${a}`)}})(n)},children:i.jsx("i",{className:"fa-solid fa-comment"})}),!b&&i.jsx("button",{className:y,onClick:e=>{e.stopPropagation(),(async n=>{var e;const a=null==(e=n.profile)?void 0:e.name;if(a&&!m){h(n.id);try{"none"===o.isFollowing(a)?await o.followUser(a):window.confirm(`Deixar de seguir @${a}?`)&&await o.unfollowUser(a)}catch(s){c("Erro",s.message||"Falha ao processar solicitação.")}finally{h(null)}}})(n)},disabled:w,children:w?i.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):v})]})]},n.email)}),0===f.length&&!x&&i.jsx("div",{style:{textAlign:"center",color:"#777",padding:"30px"},children:d?"Nenhum usuário encontrado.":"Digite para pesquisar em toda a rede."})]})]})]})};export{l as GlobalSearch};
