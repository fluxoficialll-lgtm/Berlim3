import{k as e,A as t,i as s,U as o}from"./index-Bkpya5GW.js";import"./MarketEngine-B3BMORQe.js";import{P as i,p as a}from"./postService-B_maMF9u.js";const r=`${t}/api/posts`,n=async(t,s,o=!1)=>{try{const i=await fetch(t);if(!i.ok)return[];let a=((await i.json()).data||[]).filter(e=>"video"===e.type);if(o||(a=a.filter(e=>!e.isAdultContent)),s){const t=e.getBlockedIdentifiers(s);t.size>0&&(a=a.filter(e=>{const s=String(e.username||"").replace("@","").toLowerCase();return!t.has(s)}))}return a.sort((e,t)=>(t.timestamp||0)-(e.timestamp||0))}catch(i){return[]}},d=o?{fetchReels:async()=>{},getReels:()=>s.posts.getAll().filter(e=>"video"===e.type),getReelsByAuthor:e=>s.posts.getAll().filter(t=>"video"===t.type&&t.authorId===e),searchReels:e=>{const t=e.toLowerCase();return s.posts.getAll().filter(e=>"video"===e.type&&e.text.toLowerCase().includes(t))},uploadVideo:async e=>URL.createObjectURL(e),addReel:async e=>s.posts.add(e),toggleLike:async e=>{const t=s.posts.findById(e);if(t)return t.liked=!t.liked,t.likes+=t.liked?1:-1,s.posts.update(t),t},incrementView:e=>{const t=s.posts.findById(e);t&&(t.views++,s.posts.update(t))},getReelById:e=>s.posts.findById(e)}:{getReels:async(e,t=!1)=>n(`${r}?type=video&limit=50`,e,t),getReelsByAuthor:async(e,t,s=!1)=>n(`${r}/user/${e}?type=video`,t,s),searchReels:async(e,t,s=!1)=>{const o=e.toLowerCase().trim();return o?n(`${r}/search?q=${encodeURIComponent(o)}&type=video`,t,s):[]},uploadVideo:async e=>URL.createObjectURL(e),addReel:async e=>{await a.addPost(e)},toggleLike:async e=>await i.toggleLike(e,!1),incrementView:e=>{i.trackView(e)}};export{d as r};
