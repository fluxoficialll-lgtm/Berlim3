import{j as e,u as a,f as s,e as t,r as n}from"./index-Bkpya5GW.js";import{u as i}from"./useGroupSettings-Dn9VoWgb.js";import{C as l}from"./ChannelOptionsModal-CQY2xhGz.js";const o=({channel:a,onDelete:s,onOptions:t,isDefault:n=!1})=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl transition-all duration-200 group animate-fade-in "+(n?"bg-black/20 border border-dashed border-white/10 opacity-60":"bg-white/[0.03] border border-white/5 hover:bg-white/5 hover:border-white/10"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center "+(n?"bg-white/5 text-gray-500":"bg-[#00c2ff1a] text-[#00c2ff]"),children:e.jsx("i",{className:"fa-solid fa-hashtag text-xs"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-bold text-sm "+(n?"text-gray-400":"text-gray-200"),children:[a.name," ",n&&"(Padrão)"]}),a.onlyAdminsPost&&e.jsx("span",{className:"text-[8px] font-black text-[#ffaa00] uppercase tracking-widest",children:"Apenas Admins"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>t(a),className:"text-gray-500 hover:text-[#00c2ff] p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})}),!n&&e.jsx("button",{onClick:()=>s(a.id),className:"text-red-400/30 hover:text-red-500 p-2 transition-colors active:scale-90",children:e.jsx("i",{className:"fa-solid fa-trash-can text-xs"})})]})]}),c=({channels:a,sections:s,onAddChannel:t,onAddSection:n,onOptions:i,onDeleteChannel:l,onDeleteSection:c,onUpdateSectionTitle:r,onMoveSection:d})=>{const x=e=>(e.channelIds||[]).map(e=>"general"===e?{id:"general",name:"Geral",onlyAdminsPost:!1,type:"text"}:a.find(a=>a.id===e)).filter(Boolean),h=a.filter(e=>!s.some(a=>(a.channelIds||[]).includes(e.id))),f=!s.some(e=>(e.channelIds||[]).includes("general"));return e.jsxs("div",{className:"space-y-10",children:[s.map((a,t)=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[32px] p-6 animate-slide-up shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col gap-1 mr-1",children:[e.jsx("button",{onClick:()=>d(t,"up"),disabled:0===t,className:"w-8 h-8 rounded-lg bg-white/5 text-[#00c2ff] disabled:opacity-10 hover:bg-[#00c2ff]/10 transition-colors",children:e.jsx("i",{className:"fa-solid fa-chevron-up text-[10px]"})}),e.jsx("button",{onClick:()=>d(t,"down"),disabled:t===s.length-1,className:"w-8 h-8 rounded-lg bg-white/5 text-[#00c2ff] disabled:opacity-10 hover:bg-[#00c2ff]/10 transition-colors",children:e.jsx("i",{className:"fa-solid fa-chevron-down text-[10px]"})})]}),e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#00c2ff1a] flex items-center justify-center text-[#00c2ff]",children:e.jsx("i",{className:"fa-solid fa-layer-group"})}),e.jsx("input",{type:"text",className:"flex-1 bg-transparent border-none text-white font-black text-sm uppercase tracking-widest outline-none focus:text-[#00c2ff] transition-all",value:a.title,onChange:e=>r(a.id,e.target.value),placeholder:"Nome da Seção"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>i(a,"section"),className:"text-gray-400 hover:text-[#00c2ff] p-2",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})}),e.jsx("button",{onClick:()=>c(a.id),className:"text-gray-600 hover:text-red-500 p-2",children:e.jsx("i",{className:"fa-solid fa-trash-can text-sm"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[x(a).map(a=>e.jsx(o,{channel:a,onOptions:e=>i(e,"channel"),onDelete:"general"===a.id?()=>{}:()=>l(a.id),isDefault:"general"===a.id},a.id)),(!a.channelIds||0===a.channelIds.length)&&e.jsx("div",{className:"py-4 text-center border border-dashed border-white/5 rounded-2xl opacity-20",children:e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Seção Vazia"})})]})]},a.id)),(f||h.length>0)&&e.jsxs("div",{className:"bg-white/5 border border-dashed border-white/10 rounded-[32px] p-6 animate-slide-up shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 opacity-60",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-gray-400",children:e.jsx("i",{className:"fa-solid fa-folder-tree"})}),e.jsx("h3",{className:"text-[11px] font-black text-gray-400 uppercase tracking-widest",children:"Canais Principais"})]}),e.jsxs("div",{className:"space-y-2",children:[f&&e.jsx(o,{channel:{id:"general",name:"Geral",onlyAdminsPost:!1,type:"text"},onOptions:e=>i(e,"channel"),onDelete:()=>{},isDefault:!0}),h.map(a=>e.jsx(o,{channel:a,onOptions:e=>i(e,"channel"),onDelete:()=>l(a.id)},a.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:n,className:"py-4 bg-[#00c2ff1a] border border-[#00c2ff33] text-[#00c2ff] font-black rounded-2xl uppercase tracking-widest text-[10px] hover:bg-[#00c2ff2a] active:scale-[0.98] transition-all",children:[e.jsx("i",{className:"fa-solid fa-folder-plus mr-2"})," Nova Seção"]}),e.jsxs("button",{onClick:t,className:"py-4 bg-white/5 border border-white/10 text-white font-black rounded-2xl uppercase tracking-widest text-[10px] hover:bg-white/10 active:scale-[0.98] transition-all",children:[e.jsx("i",{className:"fa-solid fa-hashtag mr-2"})," Novo Canal"]})]})]})},r=({onBack:a,title:s})=>e.jsxs("header",{className:"flex items-center p-4 bg-[#0c0f14] border-b border-white/10 h-[65px] sticky top-0 z-50",children:[e.jsx("button",{onClick:a,className:"mr-4 text-white text-xl p-2 hover:bg-white/5 rounded-full transition-all active:scale-90",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsx("h1",{className:"font-bold text-white",children:s})]}),d=()=>e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 p-5 rounded-3xl mb-8 animate-fade-in",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("i",{className:"fa-solid fa-circle-info text-blue-400 mt-1"}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:"Canais de Avisos permitem que apenas administradores enviem mensagens, mantendo a ordem da comunidade."})]})}),x=()=>{const o=a(),{id:x}=s(),{showConfirm:h,showPrompt:f}=t(),{group:m,loading:p,form:u,handleSave:g}=i(),[b,j]=n.useState({isOpen:!1,target:null,type:"channel"});if(p||!m)return e.jsx("div",{className:"min-h-screen bg-[#0a0c10] flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-[#00c2ff] text-2xl"})});const N=async()=>{if(u.isSalesPlatformEnabled){return!!(await h("Modo Plataforma Ativo","Você está usando o Modo Plataforma de Vendas. Criar canais customizados irá DESATIVAR o catálogo de pastas. Deseja prosseguir?","Sim, Usar Canais","Cancelar"))&&(u.setIsSalesPlatformEnabled(!1),!0)}return!0},v=async e=>{if(!(await N()))return;const a=await f("Nome do Canal","Ex: Suporte, Avisos, VIP Chat");if(!a)return;const s=`ch_${Date.now()}`,t={id:s,name:a,onlyAdminsPost:!1,type:"text"};u.setChannels([...u.channels,t]),e&&u.setChannelSections(u.channelSections.map(a=>a.id===e?{...a,channelIds:[...a.channelIds,s]}:a))};return e.jsxs("div",{className:"min-h-screen bg-[#0a0c10] text-white font-['Inter'] flex flex-col overflow-hidden",children:[e.jsx(r,{onBack:()=>o(`/group-settings/${x}`),title:"Estrutura de Canais"}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-5 max-w-[600px] mx-auto w-full pb-32 no-scrollbar",children:[e.jsx(d,{}),e.jsx(c,{channels:u.channels,sections:u.channelSections,onAddChannel:()=>v(),onAddSection:async()=>{if(!(await N()))return;const e=await f("Nome da Seção","Ex: ÁREA DE CONTEÚDO");if(!e)return;const a={id:`sec_${Date.now()}`,title:e,channelIds:[]};u.setChannelSections([...u.channelSections,a])},onOptions:(e,a)=>{j({isOpen:!0,target:e,type:a})},onDeleteChannel:async e=>{await h("Excluir canal?","Todas as mensagens deste canal serão perdidas.")&&(u.setChannels(u.channels.filter(a=>a.id!==e)),u.setChannelSections(u.channelSections.map(a=>({...a,channelIds:a.channelIds.filter(a=>a!==e)}))))},onDeleteSection:async e=>{await h("Excluir seção?","Os canais dentro dela serão removidos da categoria, mas não serão excluídos.")&&u.setChannelSections(u.channelSections.filter(a=>a.id!==e))},onUpdateSectionTitle:(e,a)=>{u.setChannelSections(u.channelSections.map(s=>s.id===e?{...s,title:a}:s))},onMoveSection:(e,a)=>{const s=[...u.channelSections],t="up"===a?e-1:e+1;t<0||t>=s.length||([s[e],s[t]]=[s[t],s[e]],u.setChannelSections(s))}}),e.jsx("button",{className:"btn-save-fixed",onClick:g,children:"Salvar Estrutura"})]}),b.isOpen&&e.jsx(l,{isOpen:b.isOpen,onClose:()=>j({...b,isOpen:!1}),title:b.target.name||b.target.title,type:b.type,target:b.target,onUpdateChannel:e=>{if("channel"!==b.type||!b.target)return;const a=b.target.id,s=u.channels.map(s=>s.id===a?{...s,...e}:s);u.setChannels(s),j(a=>({...a,target:{...a.target,...e}}))},onAddChannelInside:"section"===b.type?()=>v(b.target.id):void 0})]})};export{x as GroupChannelsPage};
