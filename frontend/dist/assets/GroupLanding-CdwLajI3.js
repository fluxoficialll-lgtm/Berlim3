import{j as e,u as k,f as A,r as n,g,c as E}from"./index-BC19Iu_T.js";const c={isFull(s){return s.settings?.memberLimit?(s.memberIds?.length||0)>=s.settings.memberLimit:!1},getLottationStatus(s){if(!s.settings?.memberLimit)return"available";const a=s.memberIds?.length||0,t=s.settings.memberLimit;return a>=t?"full":a>=t*.9?"near_full":"available"}},L=({group:s})=>{const a=c.getLottationStatus(s),t=s.memberIds?.length||0,o=s.settings?.memberLimit;return o?a==="full"?e.jsxs("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-[10px] font-black uppercase flex items-center gap-2 animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.4)]",children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation"})," ESGOTADO (",t,"/",o,")"]}):a==="near_full"?e.jsxs("div",{className:"bg-orange-500 text-black px-3 py-1 rounded-full text-[10px] font-black uppercase flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-fire"})," ÚLTIMAS VAGAS (",t,"/",o,")"]}):e.jsxs("div",{className:"bg-white/10 text-gray-400 px-3 py-1 rounded-full text-[10px] font-bold uppercase",children:[t,"/",o," vagas preenchidas"]}):null},B=()=>{const s=k(),{id:a}=A(),[t,o]=n.useState(null),[p,b]=n.useState(!0),[h,j]=n.useState(!1),[v,f]=n.useState(!1),[x,N]=n.useState(!1),[G,d]=n.useState(""),[_,w]=n.useState(void 0),[S,I]=n.useState(0);n.useEffect(()=>{if(a){const r=g.getGroupById(a),i=E.getCurrentUserId();if(r){if(i&&r.memberIds?.includes(i)){r.channels&&r.channels.length>0?s(`/group/${a}/channels`,{replace:!0}):s(`/group-chat/${a}`,{replace:!0});return}if(o(r),i&&(r.memberIds?.includes(i)&&j(!0),r.pendingMemberIds?.includes(i)&&f(!0),r.bannedUserIds?.includes(i)&&N(!0)),r.creatorEmail){const l=db.users.get(r.creatorEmail)||Object.values(db.users.getAll()).find(u=>u.email===r.creatorEmail);l?(d(l.profile?.nickname||l.profile?.name||"Criador"),w(l.profile?.photoUrl)):d("Administrador")}else d("Administrador");if(r.memberIds&&r.memberIds.length>0){const l=Object.values(db.users.getAll()),u=new Set(r.memberIds),C=l.filter(m=>u.has(m.id)&&m.lastSeen&&Date.now()-m.lastSeen<9e5).length;I(C||1)}}b(!1)}},[a,s]);const y=()=>{if(!t||!a||x)return;if(c.isFull(t)){alert("Lamentamos, mas este grupo atingiu o limite máximo de participantes.");return}const r=g.joinGroup(a);if(r==="joined"){const i=t.channels&&t.channels.length>0;s(i?`/group/${a}/channels`:`/group-chat/${a}`)}else r==="pending"&&f(!0)};return p?e.jsx("div",{className:"h-screen bg-[#0c0f14] flex items-center justify-center text-white",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-2xl text-[#00c2ff]"})}):t?e.jsxs("div",{className:"min-h-screen bg-[#0c0f14] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[e.jsx("style",{children:`
            .landing-hero { width: 100%; height: 300px; position: relative; overflow: hidden; }
            .hero-bg { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.4) blur(10px); transform: scale(1.1); }
            .hero-content { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5; }
            .group-avatar-large { width: 120px; height: 120px; border-radius: 32px; border: 4px solid #00c2ff; background: #1a1e26; object-fit: cover; margin-bottom: 20px; }
            .landing-body { flex-grow: 1; padding: 30px 24px; background: #0c0f14; border-radius: 30px 30px 0 0; margin-top: -30px; position: relative; z-index: 10; }
            .stat-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; background: rgba(255,255,255,0.05); border-radius: 20px; font-size: 12px; }
            .join-btn-large { width: 100%; padding: 18px; border: none; border-radius: 16px; background: #00c2ff; color: #000; font-size: 16px; font-weight: 800; cursor: pointer; text-transform: uppercase; }
            .join-btn-large:disabled { background: #333; color: #777; cursor: not-allowed; opacity: 0.7; }
        `}),e.jsx("button",{className:"absolute top-5 left-5 z-50 w-10 h-10 rounded-full bg-black/50 flex items-center justify-center border border-white/10",onClick:()=>s("/groups"),children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("img",{src:t.coverImage||"https://via.placeholder.com/800",className:"hero-bg",alt:"bg"}),e.jsxs("div",{className:"hero-content",children:[e.jsx("img",{src:t.coverImage||"https://via.placeholder.com/150",className:"group-avatar-large",alt:"Avatar"}),e.jsx("h1",{className:"text-2xl font-black text-white text-center px-6",children:t.name}),e.jsxs("div",{className:"flex flex-col items-center gap-3 mt-4",children:[e.jsx(L,{group:t}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"stat-badge",children:[e.jsx("i",{className:"fa-solid fa-user-group"})," ",t.memberIds?.length||0," membros"]}),e.jsxs("div",{className:"stat-badge",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 shadow-[0_0_5px_green]"})," ",S," online"]})]})]})]})]}),e.jsxs("main",{className:"landing-body",children:[e.jsx("div",{className:"text-center text-gray-400 mb-8 leading-relaxed",children:t.description||"Bem-vindo a esta comunidade!"}),x?e.jsx("button",{className:"join-btn-large !bg-red-500 !text-white",disabled:!0,children:"Você foi banido"}):v?e.jsx("button",{className:"join-btn-large !bg-gray-800",disabled:!0,children:"Solicitação Enviada"}):e.jsx("button",{className:"join-btn-large",onClick:y,disabled:c.isFull(t),children:c.isFull(t)?"Grupo Lotado":h?"Acessar Conversa":"Entrar no Grupo"})]})]}):e.jsx("div",{className:"h-screen bg-[#0c0f14] flex flex-col items-center justify-center text-white p-6",children:e.jsx("h1",{className:"text-xl font-bold",children:"Grupo não encontrado"})})};export{B as GroupLanding};
