import{j as e,u as A,f as I,e as E,r as O}from"./index-BC19Iu_T.js";import{u as P}from"./useGroupSettings-CvPAF9AB.js";import{C as D}from"./ChannelOptionsModal-YmnZmo41.js";const v=({channel:c,onDelete:h,onOptions:f,isDefault:x=!1})=>e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-2xl transition-all duration-200 group animate-fade-in ${x?"bg-black/20 border border-dashed border-white/10 opacity-60":"bg-white/[0.03] border border-white/5 hover:bg-white/5 hover:border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${x?"bg-white/5 text-gray-500":"bg-[#00c2ff1a] text-[#00c2ff]"}`,children:e.jsx("i",{className:"fa-solid fa-hashtag text-xs"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:`font-bold text-sm ${x?"text-gray-400":"text-gray-200"}`,children:[c.name," ",x&&"(Padrão)"]}),c.onlyAdminsPost&&e.jsx("span",{className:"text-[8px] font-black text-[#ffaa00] uppercase tracking-widest",children:"Apenas Admins"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>f(c),className:"text-gray-500 hover:text-[#00c2ff] p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})}),!x&&e.jsx("button",{onClick:()=>h(c.id),className:"text-red-400/30 hover:text-red-500 p-2 transition-colors active:scale-90",children:e.jsx("i",{className:"fa-solid fa-trash-can text-xs"})})]})]}),M=({channels:c,sections:h,onAddChannel:f,onAddSection:x,onOptions:m,onDeleteChannel:p,onDeleteSection:a,onUpdateSectionTitle:N,onMoveSection:i})=>{const u=t=>(t.channelIds||[]).map(r=>r==="general"?{id:"general",name:"Geral",onlyAdminsPost:!1,type:"text"}:c.find(d=>d.id===r)).filter(Boolean),g=c.filter(t=>!h.some(r=>(r.channelIds||[]).includes(t.id))),b=!h.some(t=>(t.channelIds||[]).includes("general"));return e.jsxs("div",{className:"space-y-10",children:[h.map((t,r)=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-[32px] p-6 animate-slide-up shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col gap-1 mr-1",children:[e.jsx("button",{onClick:()=>i(r,"up"),disabled:r===0,className:"w-8 h-8 rounded-lg bg-white/5 text-[#00c2ff] disabled:opacity-10 hover:bg-[#00c2ff]/10 transition-colors",children:e.jsx("i",{className:"fa-solid fa-chevron-up text-[10px]"})}),e.jsx("button",{onClick:()=>i(r,"down"),disabled:r===h.length-1,className:"w-8 h-8 rounded-lg bg-white/5 text-[#00c2ff] disabled:opacity-10 hover:bg-[#00c2ff]/10 transition-colors",children:e.jsx("i",{className:"fa-solid fa-chevron-down text-[10px]"})})]}),e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#00c2ff1a] flex items-center justify-center text-[#00c2ff]",children:e.jsx("i",{className:"fa-solid fa-layer-group"})}),e.jsx("input",{type:"text",className:"flex-1 bg-transparent border-none text-white font-black text-sm uppercase tracking-widest outline-none focus:text-[#00c2ff] transition-all",value:t.title,onChange:d=>N(t.id,d.target.value),placeholder:"Nome da Seção"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>m(t,"section"),className:"text-gray-400 hover:text-[#00c2ff] p-2",children:e.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})}),e.jsx("button",{onClick:()=>a(t.id),className:"text-gray-600 hover:text-red-500 p-2",children:e.jsx("i",{className:"fa-solid fa-trash-can text-sm"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[u(t).map(d=>e.jsx(v,{channel:d,onOptions:w=>m(w,"channel"),onDelete:d.id==="general"?()=>{}:()=>p(d.id),isDefault:d.id==="general"},d.id)),(!t.channelIds||t.channelIds.length===0)&&e.jsx("div",{className:"py-4 text-center border border-dashed border-white/5 rounded-2xl opacity-20",children:e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Seção Vazia"})})]})]},t.id)),(b||g.length>0)&&e.jsxs("div",{className:"bg-white/5 border border-dashed border-white/10 rounded-[32px] p-6 animate-slide-up shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 opacity-60",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-gray-400",children:e.jsx("i",{className:"fa-solid fa-folder-tree"})}),e.jsx("h3",{className:"text-[11px] font-black text-gray-400 uppercase tracking-widest",children:"Canais Principais"})]}),e.jsxs("div",{className:"space-y-2",children:[b&&e.jsx(v,{channel:{id:"general",name:"Geral",onlyAdminsPost:!1,type:"text"},onOptions:t=>m(t,"channel"),onDelete:()=>{},isDefault:!0}),g.map(t=>e.jsx(v,{channel:t,onOptions:r=>m(r,"channel"),onDelete:()=>p(t.id)},t.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:x,className:"py-4 bg-[#00c2ff1a] border border-[#00c2ff33] text-[#00c2ff] font-black rounded-2xl uppercase tracking-widest text-[10px] hover:bg-[#00c2ff2a] active:scale-[0.98] transition-all",children:[e.jsx("i",{className:"fa-solid fa-folder-plus mr-2"})," Nova Seção"]}),e.jsxs("button",{onClick:f,className:"py-4 bg-white/5 border border-white/10 text-white font-black rounded-2xl uppercase tracking-widest text-[10px] hover:bg-white/10 active:scale-[0.98] transition-all",children:[e.jsx("i",{className:"fa-solid fa-hashtag mr-2"})," Novo Canal"]})]})]})},$=({onBack:c,title:h})=>e.jsxs("header",{className:"flex items-center p-4 bg-[#0c0f14] border-b border-white/10 h-[65px] sticky top-0 z-50",children:[e.jsx("button",{onClick:c,className:"mr-4 text-white text-xl p-2 hover:bg-white/5 rounded-full transition-all active:scale-90",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsx("h1",{className:"font-bold text-white",children:h})]}),G=()=>e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 p-5 rounded-3xl mb-8 animate-fade-in",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("i",{className:"fa-solid fa-circle-info text-blue-400 mt-1"}),e.jsx("p",{className:"text-xs text-gray-300 leading-relaxed",children:"Canais de Avisos permitem que apenas administradores enviem mensagens, mantendo a ordem da comunidade."})]})}),z=()=>{const c=A(),{id:h}=I(),{showConfirm:f,showPrompt:x}=E(),{group:m,loading:p,form:a,handleSave:N}=P(),[i,u]=O.useState({isOpen:!1,target:null,type:"channel"});if(p||!m)return e.jsx("div",{className:"min-h-screen bg-[#0a0c10] flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-[#00c2ff] text-2xl"})});const g=async()=>a.isSalesPlatformEnabled?await f("Modo Plataforma Ativo","Você está usando o Modo Plataforma de Vendas. Criar canais customizados irá DESATIVAR o catálogo de pastas. Deseja prosseguir?","Sim, Usar Canais","Cancelar")?(a.setIsSalesPlatformEnabled(!1),!0):!1:!0,b=async s=>{if(!await g())return;const n=await x("Nome do Canal","Ex: Suporte, Avisos, VIP Chat");if(!n)return;const l=`ch_${Date.now()}`,o={id:l,name:n,onlyAdminsPost:!1,type:"text"};a.setChannels([...a.channels,o]),s&&a.setChannelSections(a.channelSections.map(j=>j.id===s?{...j,channelIds:[...j.channelIds,l]}:j))},t=async()=>{if(!await g())return;const s=await x("Nome da Seção","Ex: ÁREA DE CONTEÚDO");if(!s)return;const n={id:`sec_${Date.now()}`,title:s,channelIds:[]};a.setChannelSections([...a.channelSections,n])},r=(s,n)=>{u({isOpen:!0,target:s,type:n})},d=s=>{if(i.type!=="channel"||!i.target)return;const n=i.target.id,l=a.channels.map(o=>o.id===n?{...o,...s}:o);a.setChannels(l),u(o=>({...o,target:{...o.target,...s}}))},w=async s=>{await f("Excluir canal?","Todas as mensagens deste canal serão perdidas.")&&(a.setChannels(a.channels.filter(n=>n.id!==s)),a.setChannelSections(a.channelSections.map(n=>({...n,channelIds:n.channelIds.filter(l=>l!==s)}))))},C=async s=>{await f("Excluir seção?","Os canais dentro dela serão removidos da categoria, mas não serão excluídos.")&&a.setChannelSections(a.channelSections.filter(n=>n.id!==s))},y=(s,n)=>{a.setChannelSections(a.channelSections.map(l=>l.id===s?{...l,title:n}:l))},S=(s,n)=>{const l=[...a.channelSections],o=n==="up"?s-1:s+1;o<0||o>=l.length||([l[s],l[o]]=[l[o],l[s]],a.setChannelSections(l))},k=()=>c(`/group-settings/${h}`);return e.jsxs("div",{className:"min-h-screen bg-[#0a0c10] text-white font-['Inter'] flex flex-col overflow-hidden",children:[e.jsx($,{onBack:k,title:"Estrutura de Canais"}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-5 max-w-[600px] mx-auto w-full pb-32 no-scrollbar",children:[e.jsx(G,{}),e.jsx(M,{channels:a.channels,sections:a.channelSections,onAddChannel:()=>b(),onAddSection:t,onOptions:r,onDeleteChannel:w,onDeleteSection:C,onUpdateSectionTitle:y,onMoveSection:S}),e.jsx("button",{className:"btn-save-fixed",onClick:N,children:"Salvar Estrutura"})]}),i.isOpen&&e.jsx(D,{isOpen:i.isOpen,onClose:()=>u({...i,isOpen:!1}),title:i.target.name||i.target.title,type:i.type,target:i.target,onUpdateChannel:d,onAddChannelInside:i.type==="section"?()=>b(i.target.id):void 0})]})};export{z as GroupChannelsPage};
