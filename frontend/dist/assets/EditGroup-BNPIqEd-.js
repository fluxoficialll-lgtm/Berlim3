import{u as e,f as t,r as i,g as r,j as o}from"./index-Bkpya5GW.js";import{p as a}from"./postService-B_maMF9u.js";import{C as n}from"./CurrencySelectorModal-D88ppuTC.js";import{U as s}from"./UploadProgressCard-BBVv78iL.js";const l=()=>{const l=e(),{id:d}=t(),[c,p]=i.useState(""),[x,u]=i.useState(""),[m,f]=i.useState(void 0),[g,h]=i.useState(null),[b,v]=i.useState(""),[j,y]=i.useState("BRL"),[w,N]=i.useState("lifetime"),[k,C]=i.useState(""),[S,I]=i.useState(null),[D,z]=i.useState(""),[T,F]=i.useState(""),[P,_]=i.useState("inactive"),[M,R]=i.useState(!1),[A,B]=i.useState(!1),[L,E]=i.useState(!1),[G,V]=i.useState(!1),[U,$]=i.useState([]),[O,q]=i.useState(""),[W,Y]=i.useState(""),[H,J]=i.useState(!1),[K,Q]=i.useState(0),[X,Z]=i.useState(0),[ee,te]=i.useState(0);i.useEffect(()=>{if(!d)return void l("/groups");const e=r.getGroupById(d);if(!e)return alert("Grupo não encontrado."),void l("/groups");if(I(e),p(e.name),u(e.description),f(e.coverImage),z(e.pixelId||""),F(e.pixelToken||""),e.pixelId&&_("active"),e.price){const t=parseFloat(e.price);isNaN(t)?v(e.price):v(t.toLocaleString("pt-BR",{minimumFractionDigits:2}))}y(e.currency||"BRL"),N(e.accessType||"lifetime"),C(e.expirationDate||""),e.vipDoor&&(q(e.vipDoor.text||""),Y(e.vipDoor.buttonText||""),e.vipDoor.mediaItems?$(e.vipDoor.mediaItems):e.vipDoor.media&&$([{url:e.vipDoor.media,type:e.vipDoor.mediaType||"image"}]))},[d,l]),i.useEffect(()=>{D.length>5?_("active"):_("inactive")},[D]);const ie=e=>{N(e),"temporary"===e?E(!0):C("")};return o.jsxs("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top_left,_#0c0f14,_#0a0c10)] text-white font-['Inter'] flex flex-col overflow-x-hidden",children:[o.jsx("style",{children:"\n        * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter',sans-serif; }\n        header { display:flex; align-items:center; justify-content:space-between; padding:16px 32px; background: #0c0f14; position:fixed; width:100%; z-index:10; border-bottom:1px solid rgba(255,255,255,0.1); top: 0; height: 80px; }\n        header button { background:none; border:none; color:#00c2ff; font-size:18px; cursor:pointer; transition:0.3s; }\n        main { flex-grow:1; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; width:100%; padding-top: 100px; padding-bottom: 150px; }\n        #groupCreationForm { width:100%; max-width:500px; padding:0 20px; display: flex; flex-direction: column; gap: 20px; }\n        .form-group { display: flex; flex-direction: column; }\n        .form-group label { font-size: 14px; color: #00c2ff; margin-bottom: 8px; font-weight: 600; }\n        .form-group input, .form-group textarea { background: #1e2531; border: 1px solid rgba(0,194,255,0.3); border-radius: 8px; color: #fff; padding: 12px; font-size: 16px; transition: border-color 0.3s; }\n        .form-group input:focus, .form-group textarea:focus { border-color: #00c2ff; outline: none; box-shadow: 0 0 5px rgba(0,194,255,0.5); }\n        #coverPreview { width: 100%; aspect-ratio: 1 / 1; background: #1e2531; border: 2px dashed rgba(0,194,255,0.5); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: #00c2ff; font-size: 16px; cursor: pointer; position: relative; overflow: hidden; }\n        #coverPreview img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; }\n        .common-button { background: #00c2ff; border: none; border-radius: 8px; color: #000; padding: 12px 20px; font-size: 18px; font-weight: 700; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 8px rgba(0,194,255,0.3); }\n        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); display: flex; align-items: center; justify-content: center; z-index: 100; opacity: 0; visibility: hidden; transition: 0.3s; }\n        .modal-overlay.open { opacity: 1; visibility: visible; }\n        .modal-content { background: #0c0f14; padding: 20px; border-radius: 16px; width: 90%; max-width: 400px; transform: translateY(20px); transition: transform 0.3s; box-shadow: 0 8px 25px rgba(0,194,255,0.4); }\n        .modal-option { background: #1e2531; color: #fff; padding: 15px; margin-bottom: 10px; border-radius: 10px; display: flex; flex-direction: column; gap: 10px; }\n        .media-preview-gallery { display: flex; gap: 10px; overflow-x: auto; width: 100%; padding-bottom: 5px; }\n        .media-preview-item { flex: 0 0 100px; height: 125px; position: relative; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }\n        .media-preview-item img, .media-preview-item video { width: 100%; height: 100%; object-fit: cover; }\n        .remove-media-btn { position: absolute; top: 2px; right: 2px; background: rgba(0,0,0,0.7); color: #ff4d4d; border: none; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 12px; }\n        #media-upload-trigger { width: 100%; padding: 20px; background: #0c0f14; border: 1px dashed rgba(0,194,255,0.5); border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #00c2ff; }\n        .price-input-container { display: flex; align-items: center; background: #1e2531; border: 1px solid rgba(0,194,255,0.3); border-radius: 8px; overflow: hidden; margin-bottom: 20px; }\n        .price-input-container span { padding: 12px; background: #28303f; color: #aaa; font-size: 16px; font-weight: 700; min-width: 50px; text-align: center; }\n        .price-input-container input { flex-grow: 1; border: none; background: none; padding: 12px; text-align: right; color: #fff; font-weight: 700; }\n        .custom-radio { flex: 1; display: flex; align-items: center; justify-content: center; padding: 10px 15px; background: #1e2531; border: 1px solid rgba(0,194,255,0.3); border-radius: 8px; color: #fff; cursor: pointer; transition: background 0.3s; font-size: 14px; font-weight: 600; }\n        .custom-radio.selected { background: #00c2ff; color: #000; }\n        .selector-trigger { width: 100%; background: #1e2531; border: 1px solid rgba(0, 194, 255, 0.3); border-radius: 12px; padding: 14px 16px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; transition: 0.3s; margin-bottom: 5px; }\n        .status-badge { display: flex; align-items: center; gap: 6px; font-size: 11px; font-weight: 700; padding: 4px 10px; border-radius: 12px; text-transform: uppercase; }\n        .status-badge.active { background: rgba(0, 255, 130, 0.1); color: #00ff82; border: 1px solid #00ff82; }\n      "}),o.jsxs("header",{children:[o.jsx("button",{onClick:()=>l("/groups"),children:o.jsx("i",{className:"fa-solid fa-xmark"})}),o.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 w-[60px] h-[60px] bg-white/5 rounded-2xl flex justify-center items-center z-20 cursor-pointer shadow-[0_0_20px_rgba(0,194,255,0.3),inset_0_0_20px_rgba(0,194,255,0.08)]",onClick:()=>l("/feed"),children:[o.jsx("div",{className:"absolute w-[40px] h-[22px] rounded-[50%] border-[3px] border-[#00c2ff] rotate-[25deg]"}),o.jsx("div",{className:"absolute w-[40px] h-[22px] rounded-[50%] border-[3px] border-[#00c2ff] -rotate-[25deg]"})]})]}),o.jsxs("main",{children:[o.jsx("h1",{style:{color:"#00c2ff",marginBottom:"20px"},children:"Editar Grupo"}),o.jsxs("form",{id:"groupCreationForm",onSubmit:async e=>{if(e.preventDefault(),!S||H)return;const t=b.replace(/\./g,"").replace(",","."),i=parseFloat(t);if(S.isVip&&(isNaN(i)||i<6))alert("⚠️ O preço mínimo para um grupo VIP é R$ 6,00.");else{J(!0);try{const e=U.filter(e=>e.file),t=U.filter(e=>!e.file),o=e.length+(g?1:0);te(o),Z(0),Q(0);let n=m,s=0;g&&(s++,Z(s),n=await a.uploadMedia(g,"avatars"),Q(Math.round(s/o*100)));const d=[];for(const i of e){s++,Z(s);const e=await a.uploadMedia(i.file,"vips_doors");d.push({url:e,type:i.type}),Q(Math.round(s/o*100))}const p=[...t.map(e=>({url:e.url,type:e.type})),...d],u={...S,name:c,description:x,coverImage:n,price:i.toString(),currency:j,accessType:w,expirationDate:k,vipDoor:{mediaItems:p,text:O,buttonText:W},pixelId:D||void 0,pixelToken:T||void 0};await r.updateGroup(u),setTimeout(()=>{J(!1),l("/groups")},800)}catch(o){alert("Erro ao atualizar grupo."),J(!1)}}},children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"groupName",children:"Nome do Grupo"}),o.jsx("input",{type:"text",id:"groupName",value:c,onChange:e=>p(e.target.value),required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Capa do Grupo"}),o.jsx("div",{id:"coverPreview",onClick:()=>{var e;return null==(e=document.getElementById("coverImageInput"))?void 0:e.click()},children:m?o.jsx("img",{src:m,alt:"Cover"}):o.jsx("span",{children:"Selecionar Capa"})}),o.jsx("input",{type:"file",id:"coverImageInput",accept:"image/*",style:{display:"none"},onChange:e=>{var t;const i=null==(t=e.target.files)?void 0:t[0];if(i){h(i);const e=new FileReader;e.onload=e=>{var t;return f(null==(t=e.target)?void 0:t.result)},e.readAsDataURL(i)}}})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"groupDescription",children:"Descrição"}),o.jsx("textarea",{id:"groupDescription",value:x,onChange:e=>u(e.target.value)})]}),o.jsxs("button",{type:"button",className:"common-button",onClick:()=>B(!0),children:[o.jsx("i",{className:"fa-solid fa-gear"})," Editar Porta do VIP"]}),o.jsxs("div",{className:"price-group",children:[o.jsx("label",{children:"Tipo de Acesso"}),o.jsxs("div",{className:"radio-group-container flex gap-2",children:[o.jsxs("div",{className:"custom-radio "+("lifetime"===w?"selected":""),onClick:()=>ie("lifetime"),children:[o.jsx("i",{className:"fa-solid fa-infinity"})," Vitalício"]}),o.jsxs("div",{className:"custom-radio "+("temporary"===w?"selected":""),onClick:()=>ie("temporary"),children:[o.jsx("i",{className:"fa-solid fa-clock"})," Temporário"]})]}),o.jsxs("div",{className:"selector-trigger mt-4",onClick:()=>V(!0),children:[o.jsxs("div",{className:"flex flex-col text-left",children:[o.jsx("span",{className:"label",children:"Moeda:"}),o.jsx("span",{className:"value",children:j})]}),o.jsx("i",{className:"fa-solid fa-chevron-right text-[#00c2ff]"})]}),o.jsxs("div",{className:"price-input-container",children:[o.jsx("span",{children:"BRL"===j?"R$":"$"}),o.jsx("input",{type:"text",value:b,onChange:e=>{let t=e.target.value;if(t=t.replace(/\D/g,""),""===t)return void v("");const i=parseFloat(t)/100;v(i.toLocaleString("pt-BR",{minimumFractionDigits:2}))},required:!0})]})]}),o.jsxs("div",{className:"price-group",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{style:{fontSize:"14px",color:"#FFD700",textTransform:"uppercase"},children:"Marketing Avançado"}),o.jsx("div",{className:`status-badge ${P}`,children:"active"===P?"Ativo":"Inativo"})]}),o.jsxs("div",{className:"form-group mb-4",children:[o.jsx("label",{children:"Pixel ID"}),o.jsx("input",{type:"text",value:D,onChange:e=>z(e.target.value),placeholder:"Meta Pixel ID"})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{children:"Token CAPI"}),o.jsx("input",{type:"text",value:T,onChange:e=>F(e.target.value),placeholder:"Access Token"})]})]}),o.jsx("button",{type:"submit",className:"common-button",disabled:H,children:H?o.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fa-solid fa-save"})," Salvar Alterações"]})})]}),o.jsx(s,{progress:K,current:X,total:ee,isVisible:H})]}),o.jsx("div",{className:"modal-overlay "+(A?"open":""),onClick:()=>B(!1),children:o.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[o.jsx("h3",{children:"Porta do VIP"}),o.jsxs("div",{className:"modal-option",children:[o.jsx("div",{className:"media-preview-gallery",children:U.map((e,t)=>o.jsxs("div",{className:"media-preview-item",children:["video"===e.type?o.jsx("video",{src:e.url}):o.jsx("img",{src:e.url}),o.jsx("button",{className:"remove-media-btn",onClick:()=>{return e=t,void $(t=>t.filter((t,i)=>i!==e));var e},children:o.jsx("i",{className:"fa-solid fa-xmark"})})]},t))}),o.jsxs("div",{id:"media-upload-trigger",onClick:()=>{var e;return null==(e=document.getElementById("vipDoorMediaInput"))?void 0:e.click()},children:[o.jsx("i",{className:"fa-solid fa-photo-film"}),o.jsx("span",{children:"Adicionar Mídia"})]}),o.jsx("input",{type:"file",id:"vipDoorMediaInput",accept:"image/*,video/*",multiple:!0,style:{display:"none"},onChange:e=>{const t=e.target.files;if(!t)return;const i=Array.from(t);if(U.length+i.length>10)return void alert("Máximo de 10 mídias.");const r=i.map(e=>({file:e,url:URL.createObjectURL(e),type:e.type.startsWith("video/")?"video":"image"}));$(e=>[...e,...r])}})]}),o.jsxs("div",{className:"modal-option",children:[o.jsx("textarea",{value:O,onChange:e=>q(e.target.value),placeholder:"Texto de boas-vindas"}),o.jsx("input",{type:"text",value:W,onChange:e=>Y(e.target.value),placeholder:"Texto do botão"})]}),o.jsx("button",{className:"common-button w-full",onClick:()=>B(!1),children:"Concluir"})]})}),o.jsx(n,{isOpen:G,onClose:()=>V(!1),currentCurrency:j,onSelect:e=>y(e)})]})};export{l as EditGroup};
