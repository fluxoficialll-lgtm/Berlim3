import{j as e,u as t,e as a,r as s,c as r}from"./index-CipjSFYz.js";import{p as i}from"./postService-0_arHZ6V.js";import{F as l}from"./FeedItem-uWP6OEIi.js";import{U as o}from"./UserBadge-DbbG-9AU.js";import"./UserAvatar-BSqXD0cQ.js";const n=({searchTerm:t,onSearchChange:a,onBack:s,loading:r})=>e.jsxs("header",{className:"flex items-center gap-4 px-6 py-4 bg-[#0c0f14] border-b border-white/5 z-50 h-[80px] shrink-0",children:[e.jsx("button",{onClick:s,className:"w-10 h-10 rounded-full flex items-center justify-center text-gray-400 hover:text-white hover:bg-white/5 transition-all active:scale-90",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 transition-all duration-300 "+(r?"text-[#00c2ff]":"text-gray-600 group-focus-within:text-[#00c2ff]"),children:e.jsx("i",{className:`fa-solid ${r?"fa-circle-notch fa-spin":"fa-magnifying-glass"} text-sm`})}),e.jsx("input",{type:"text",className:"w-full bg-black/40 border border-white/10 rounded-2xl py-3.5 pl-12 pr-4 text-white text-sm outline-none focus:border-[#00c2ff]/40 focus:bg-black/60 transition-all placeholder:text-gray-700 shadow-inner font-medium",placeholder:"O que você deseja encontrar na rede?",value:t,onChange:e=>a(e.target.value),autoFocus:!0}),t&&!r&&e.jsx("button",{onClick:()=>a(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-600 hover:text-white transition-colors",children:e.jsx("i",{className:"fa-solid fa-circle-xmark"})})]})]}),c=({activeTab:t,onTabChange:a,activeFilter:s,onFilterChange:r,show:i})=>{if(!i)return null;return e.jsxs("div",{className:"flex flex-col bg-[#0c0f14] border-b border-white/5 animate-fade-in shrink-0",children:[e.jsx("div",{className:"flex px-6 pt-4 gap-6",children:[{id:"posts",label:"Conteúdo",icon:"fa-layer-group"},{id:"users",label:"Pessoas",icon:"fa-user-astronaut"}].map(s=>e.jsxs("button",{onClick:()=>a(s.id),className:"pb-3 text-[11px] font-black uppercase tracking-[3px] transition-all relative "+(t===s.id?"text-[#00c2ff]":"text-gray-600"),children:[e.jsx("i",{className:`fa-solid ${s.icon} mr-2 opacity-50`}),s.label,t===s.id&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-[2px] bg-[#00c2ff] rounded-full shadow-[0_0_10px_#00c2ff]"})]},s.id))}),"posts"===t&&e.jsxs("div",{className:"flex gap-3 px-6 py-4 items-center overflow-x-auto no-scrollbar animate-slide-up",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-700 uppercase tracking-[2px] mr-2",children:"Ordenar"}),[{id:"relevant",label:"Destaques",icon:"fa-bolt"},{id:"recent",label:"Recentes",icon:"fa-clock"}].map(t=>e.jsxs("button",{onClick:()=>r(t.id),className:"px-5 py-2 rounded-xl text-[10px] font-black uppercase tracking-[2px] transition-all flex items-center gap-2 border "+(s===t.id?"bg-[#00c2ff] text-black border-[#00c2ff] shadow-lg shadow-[#00c2ff]/10":"bg-white/5 border-white/5 text-gray-500 hover:text-gray-300 hover:border-white/10"),children:[e.jsx("i",{className:`fa-solid ${t.icon} ${s===t.id?"opacity-100":"opacity-40"}`}),t.label]},t.id))]})]})},d=({activeTab:s,postResults:r,userResults:n,loading:c,searchTerm:d,currentUser:x})=>{const f=t(),{showConfirm:m}=a();return c&&0===r.length&&0===n.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-32 animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/5 flex items-center justify-center mb-4 border border-white/10",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-[#00c2ff]"})}),e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[4px]",children:"Sincronizando Rede..."})]}):"posts"===s&&r.length>0?e.jsx("div",{className:"max-w-[500px] mx-auto w-full px-3 pb-32 animate-fade-in",children:r.map(t=>e.jsx(l,{post:t,currentUserId:null==x?void 0:x.id,onLike:e=>i.toggleLike(e),onDelete:async(e,t)=>{e.stopPropagation(),await m("Excluir Post","Deseja apagar permanentemente?","Excluir","Cancelar")&&await i.deletePost(t)},onUserClick:e=>f(`/user/${e.replace("@","")}`),onCommentClick:e=>f(`/post/${e}`),onShare:e=>{const t=`${window.location.origin}/#/post/${e.id}`;navigator.share?navigator.share({url:t}):(navigator.clipboard.writeText(t),alert("Link copiado!"))},onVote:()=>{},onCtaClick:e=>(null==e?void 0:e.startsWith("http"))?window.open(e,"_blank"):f(e||"")},t.id))}):"users"===s&&n.length>0?e.jsx("div",{className:"max-w-[500px] mx-auto w-full px-6 pb-32 animate-fade-in grid gap-3 mt-4",children:n.map(t=>{var a,s,r;return e.jsxs("div",{onClick:()=>{var e;return f(`/user/${null==(e=t.profile)?void 0:e.name}`)},className:"flex items-center justify-between p-4 bg-white/[0.02] border border-white/5 rounded-[22px] hover:bg-white/[0.05] transition-all group cursor-pointer",children:[e.jsx(o,{avatarUrl:null==(a=t.profile)?void 0:a.photoUrl,nickname:null==(s=t.profile)?void 0:s.nickname,handle:null==(r=t.profile)?void 0:r.name,isVerified:t.isVerified,avatarSize:"md"}),e.jsx("i",{className:"fa-solid fa-chevron-right text-gray-800 text-[10px] group-hover:text-[#00c2ff] transition-colors"})]},t.id)})}):d.trim().length>0&&!c?e.jsxs("div",{className:"flex flex-col items-center justify-center py-40 opacity-30 text-center animate-fade-in px-12",children:[e.jsx("div",{className:"w-20 h-20 bg-white/5 rounded-[32px] flex items-center justify-center mb-8 border border-white/5",children:e.jsx("i",{className:`fa-solid ${"posts"===s?"fa-layer-group":"fa-user-slash"} text-3xl text-gray-600`})}),e.jsx("h3",{className:"text-sm font-black uppercase tracking-[4px] text-white mb-2",children:"Sem Correspondência"}),e.jsxs("p",{className:"text-[11px] font-bold text-gray-500 uppercase leading-relaxed max-w-[200px] mx-auto",children:["Não encontramos ","posts"===s?"publicações":"usuários"," com este termo."]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-40 text-center animate-fade-in px-12",children:[e.jsxs("div",{className:"relative mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-[#00c2ff0a] to-transparent rounded-[40px] flex items-center justify-center border border-[#00c2ff1a]",children:e.jsx("i",{className:"fa-solid fa-magnifying-glass text-4xl text-[#00c2ff]/40"})}),e.jsx("div",{className:"absolute -bottom-2 -right-2 w-10 h-10 bg-[#0c0f14] rounded-full flex items-center justify-center border border-white/5",children:e.jsx("i",{className:"fa-solid fa-earth-americas text-[#00ff82]/40 text-sm"})})]}),e.jsx("h3",{className:"text-base font-black uppercase tracking-[6px] text-white/80 mb-3 ml-1.5",children:"Pesquisa Flux"}),e.jsx("p",{className:"text-[10px] font-black text-gray-600 uppercase tracking-[2px] max-w-[220px] mx-auto leading-relaxed",children:"Descubra novas mentes, ideias e conexões em toda a rede global."})]})},x=()=>{const a=t(),[l,o]=s.useState(""),[x,f]=s.useState("posts"),[m,p]=s.useState("relevant"),[u,h]=s.useState([]),[b,g]=s.useState([]),[j,v]=s.useState(!1),w=r.getCurrentUser(),y=s.useCallback(async(e,t)=>{if(!e.trim())return h([]),void g([]);v(!0);try{if("posts"===t){const t=await i.searchPosts(e);h(t)}else{const t=await r.searchUsers(e);g(t)}}catch(a){}finally{v(!1)}},[]);s.useEffect(()=>{const e=setTimeout(()=>y(l,x),400);return()=>clearTimeout(e)},[l,x,y]);const N=s.useMemo(()=>{const e=[...u];return"recent"===m?e.sort((e,t)=>t.timestamp-e.timestamp):e.sort((e,t)=>{const a=(e.likes||0)+2*(e.comments||0)+(e.views||0)/10;return(t.likes||0)+2*(t.comments||0)+(t.views||0)/10-a})},[u,m]);return e.jsxs("div",{className:"h-screen bg-[#0a0c10] text-white font-['Inter'] flex flex-col overflow-hidden",children:[e.jsx(n,{searchTerm:l,onSearchChange:o,onBack:()=>{window.history.state&&window.history.state.idx>0?a(-1):a("/feed")},loading:j}),e.jsx(c,{activeTab:x,onTabChange:f,activeFilter:m,onFilterChange:p,show:l.trim().length>0}),e.jsx("main",{className:"flex-1 overflow-y-auto no-scrollbar",children:e.jsx(d,{activeTab:x,postResults:N,userResults:b,loading:j,searchTerm:l,currentUser:w})})]})};export{x as FeedSearch};
