import{j as e,u as t,f as a,r as s,c as l,g as r,v as c}from"./index-Bkpya5GW.js";import{c as i}from"./currencyService-CUGBeSum.js";const n=({onBack:t,groupName:a})=>e.jsxs("header",{className:"flex items-center justify-between p-4 bg-[#0c0f14] sticky top-0 z-50 border-b border-white/10 h-[65px]",children:[e.jsx("button",{onClick:t,className:"text-[#00c2ff] text-xl p-2 hover:bg-white/5 rounded-full transition-all",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-[2px]",children:"Receita Detalhada"}),e.jsx("h1",{className:"text-sm font-bold text-white truncate max-w-[180px]",children:a})]}),e.jsx("div",{className:"w-10"})]}),o=({totalAmount:t,totalSales:a,avgTicket:s,color:l})=>e.jsxs("div",{className:"bg-gradient-to-br from-[#1e2531] to-[#0c0f14] border border-white/10 rounded-[32px] p-8 mb-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[#00c2ff] to-transparent opacity-30"}),e.jsx("span",{className:"text-[10px] font-black text-[#00c2ff] uppercase tracking-[3px] block mb-2 text-center opacity-70",children:"Faturamento Bruto"}),e.jsx("div",{className:"text-5xl font-black text-white text-center drop-shadow-2xl",style:{color:l},children:t}),e.jsxs("div",{className:"flex justify-center gap-10 mt-8 pt-6 border-t border-white/5",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase block mb-1 tracking-widest",children:"Vendas"}),e.jsx("span",{className:"text-xl font-black text-white",children:a})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-500 uppercase block mb-1 tracking-widest",children:"Ticket MÃ©dio"}),e.jsx("span",{className:"text-xl font-black text-[#00ff82]",children:s})]})]})]}),d=({metrics:t})=>e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-10",children:t.map((t,a)=>e.jsxs("div",{className:"bg-white/[0.03] border border-white/5 rounded-2xl p-4 flex flex-col items-center gap-1 transition-all hover:bg-white/[0.05]",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest",children:t.label}),e.jsx("span",{className:"text-[12px] font-bold text-white/90",children:t.value})]},a))}),x={syncpay:"fa-bolt",stripe:"fa-brands fa-stripe",paypal:"fa-brands fa-paypal"},p={BR:"ðŸ‡§ðŸ‡·",US:"ðŸ‡ºðŸ‡¸",DE:"ðŸ‡©ðŸ‡ª",FR:"ðŸ‡«ðŸ‡·",IT:"ðŸ‡®ðŸ‡¹",GB:"ðŸ‡¬ðŸ‡§",ES:"ðŸ‡ªðŸ‡¸",JP:"ðŸ‡¯ðŸ‡µ"},m=({metrics:t})=>e.jsxs("section",{className:"mb-10 animate-slide-up",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5 px-2",children:[e.jsxs("h2",{className:"text-[11px] font-black text-[#00c2ff] uppercase tracking-[3px] flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-chart-pie"})," Mix de Pagamentos"]}),e.jsx("span",{className:"text-[9px] font-bold text-gray-600 uppercase tracking-widest",children:"Desempenho por Canal"})]}),e.jsx("div",{className:"space-y-2",children:t.length>0?t.map((t,a)=>e.jsxs("div",{className:"relative group overflow-hidden bg-white/[0.02] border border-white/5 rounded-2xl transition-all hover:border-[#00c2ff33] hover:bg-white/[0.04]",children:[e.jsx("div",{className:"absolute bottom-0 left-0 h-[2px] bg-[#00c2ff]/30 transition-all duration-1000",style:{width:`${t.percentage}%`}}),e.jsxs("div",{className:"flex items-center justify-between p-4 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-black/40 flex items-center justify-center text-[#00c2ff] border border-white/5",children:e.jsx("i",{className:`fa-solid ${x[t.provider]||"fa-credit-card"}`})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-[13px] font-bold text-white capitalize leading-tight",children:[t.method," ",e.jsx("span",{className:"text-[10px] text-gray-600 lowercase font-medium mx-1",children:"via"})," ",t.provider]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[e.jsx("span",{className:"text-[14px]",children:p[t.country]||"ðŸŒ"}),e.jsx("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-tighter",children:t.country})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-black text-white",children:[t.count," ",e.jsx("span",{className:"text-[10px] text-gray-600 font-normal",children:"vendas"})]}),e.jsxs("div",{className:"text-[11px] font-black text-[#00ff82]",children:[t.percentage.toFixed(1),"%"]})]})]})]},a)):e.jsxs("div",{className:"text-center py-16 opacity-30 border-2 border-dashed border-white/5 rounded-[32px]",children:[e.jsx("i",{className:"fa-solid fa-money-bill-transfer text-4xl mb-4 text-gray-600"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[2px]",children:"Aguardando dados de mercado..."})]})})]}),f={BRL:{symbol:"R$",color:"#00ff82",flag:"ðŸ‡§ðŸ‡·"},USD:{symbol:"$",color:"#00c2ff",flag:"ðŸ‡ºðŸ‡¸"},EUR:{symbol:"â‚¬",color:"#ffd700",flag:"ðŸ‡ªðŸ‡º"}},h=()=>{const x=t(),{id:p}=a(),[h,u]=s.useState(null),[b,g]=s.useState(!0),[j,v]=s.useState(!1),[N,y]=s.useState(null),[w,k]=s.useState("BRL"),[S,R]=s.useState(1);s.useEffect(()=>{(async()=>{const e=l.getCurrentUser();if(!e||!p)return void g(!1);const t=r.getGroupById(p);t&&u(t);try{const t=(await c.getTransactions(e.email)).filter(e=>["paid","completed","approved","settled"].includes((e.status||"").toLowerCase())&&e.groupId===p),a=Date.now(),s=864e5,l=new Date((new Date).setHours(0,0,0,0)).getTime(),r=l-s,i={},n={hoje:0,ontem:0,d30:0,d60:0,d90:0,d180:0,total:0,unifiedMetrics:[],totalSales:t.length};t.forEach(e=>{var t,c,o;const d=parseFloat(e.amount||0),x=new Date(e.created_at||e.createdAt||e.date_created||0).getTime();n.total+=d,x>=l?n.hoje+=d:x>=r&&x<l&&(n.ontem+=d),x>=a-30*s&&(n.d30+=d),x>=a-60*s&&(n.d60+=d),x>=a-90*s&&(n.d90+=d),x>=a-180*s&&(n.d180+=d);const p=(e.provider||(null==(t=e.data)?void 0:t.providerId)||"syncpay").toLowerCase(),m=`${p}|${(e.method||(null==(c=e.data)?void 0:c.method)||("syncpay"===p?"Pix":"Card")).split(" ")[0]}|${(e.country||(null==(o=e.data)?void 0:o.country)||"BR").toUpperCase()}`;i[m]=(i[m]||0)+1}),n.unifiedMetrics=Object.entries(i).map(([e,t])=>{const[a,s,l]=e.split("|");return{provider:a,method:s,country:l,count:t,percentage:t/n.totalSales*100}}).sort((e,t)=>t.count-e.count),y(n)}catch(a){}finally{g(!1)}})()},[p]),s.useEffect(()=>{(async()=>{if("BRL"!==w){v(!0);try{const e=await i.getRate("BRL",w);R(e)}catch(e){}finally{v(!1)}}else R(1)})()},[w]);const B=s.useMemo(()=>{if(!N)return null;if(1===S)return N;const e=S;return{...N,hoje:N.hoje*e,ontem:N.ontem*e,d30:N.d30*e,d60:N.d60*e,d90:N.d90*e,d180:N.d180*e,total:N.total*e}},[N,S]),D=e=>e.toLocaleString(i.getLocale(w),{style:"currency",currency:w}),C=s.useMemo(()=>B?[{label:"Hoje",value:D(B.hoje)},{label:"Ontem",value:D(B.ontem)},{label:"30d",value:D(B.d30)},{label:"60d",value:D(B.d60)},{label:"90d",value:D(B.d90)},{label:"180d",value:D(B.d180)}]:[],[B,w]);return e.jsxs("div",{className:"min-h-screen bg-[#0a0c10] text-white font-['Inter'] flex flex-col pb-10 overflow-x-hidden",children:[e.jsx("style",{children:"\n                .currency-pill {\n                    padding: 8px 16px; border-radius: 12px; font-size: 11px; font-weight: 800; cursor: pointer; transition: 0.2s;\n                    border: 1px solid rgba(255,255,255,0.05); background: rgba(255,255,255,0.02); color: #555; text-transform: uppercase;\n                }\n                .currency-pill.active { color: #fff; background: rgba(255,255,255,0.05); border-color: #00c2ff; }\n            "}),e.jsx(n,{onBack:()=>x(-1),groupName:(null==h?void 0:h.name)||"Carregando..."}),e.jsxs("main",{className:"p-5 max-w-[600px] mx-auto w-full no-scrollbar",children:[e.jsx("div",{className:"flex justify-center gap-3 mb-8 p-1.5 bg-black/40 rounded-2xl border border-white/5 w-fit mx-auto",children:["BRL","USD","EUR"].map(t=>e.jsxs("button",{className:"currency-pill "+(w===t?"active":""),onClick:()=>k(t),children:[f[t].flag," ",t]},t))}),b||!B?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 opacity-30",children:[e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-2xl text-[#00c2ff] mb-4"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[3px]",children:"Auditoria Financeira..."})]}):e.jsxs("div",{className:"animate-fade-in relative",children:[j&&e.jsx("div",{className:"absolute inset-0 bg-[#0a0c10]/60 backdrop-blur-sm z-20 flex items-center justify-center rounded-3xl",children:e.jsx("i",{className:"fa-solid fa-rotate fa-spin text-[#00c2ff] text-2xl"})}),e.jsx(o,{totalAmount:D(B.total),totalSales:B.totalSales,avgTicket:B.totalSales>0?D(B.total/B.totalSales):D(0),color:f[w].color}),e.jsx(d,{metrics:C}),e.jsx(m,{metrics:B.unifiedMetrics}),e.jsx("div",{className:"bg-white/5 p-5 rounded-2xl border border-dashed border-white/10 text-center opacity-40",children:e.jsxs("p",{className:"text-[9px] text-gray-500 uppercase font-black tracking-[2px] leading-relaxed",children:[e.jsx("i",{className:"fa-solid fa-shield-halved mr-1"})," InteligÃªncia Flux: Dados sincronizados em tempo real."]})})]})]})]})};export{h as GroupRevenue};
