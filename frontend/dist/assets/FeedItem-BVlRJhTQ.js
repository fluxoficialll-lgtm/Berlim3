import{u as e,r as t,j as a,c as n,g as s}from"./index-Bkpya5GW.js";import{U as r,A as l}from"./UserBadge-B6APxn0Y.js";import{p as i}from"./postService-B_maMF9u.js";const o=({username:s,time:i,location:o,isAdult:c,isAd:d,onClick:x,isOwner:p,onDelete:f,authorEmail:m})=>{var g,u,h,b;const v=e(),[j,w]=t.useState(null),[N,k]=t.useState(!1),[y,C]=t.useState(!1),[S,$]=t.useState(!0);t.useEffect(()=>{if(!s)return;(async()=>{const e=await n.fetchUserByHandle(s,m);e&&w(e),$(!1)})()},[s,m]);const F=e=>{e.stopPropagation();const t=s.replace("@","").toLowerCase().trim();v(`/user/${t}`,{state:{emailFallback:m}})},A=(null==(g=null==j?void 0:j.profile)?void 0:g.nickname)||(null==(u=null==j?void 0:j.profile)?void 0:u.name)||s.replace("@","");return a.jsxs("div",{className:"flex items-center justify-between mb-3 relative px-4 pt-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(r,{avatarUrl:null==(h=null==j?void 0:j.profile)?void 0:h.photoUrl,nickname:A,handle:s,isVip:!1,avatarSize:"md",showHandle:!1,onAvatarClick:e=>{var t;e.stopPropagation(),(null==(t=null==j?void 0:j.profile)?void 0:t.photoUrl)?C(!0):F(e)},onNameClick:F}),a.jsxs("div",{className:"flex flex-col ml-[-8px]",children:[a.jsx("div",{className:"flex items-center",children:c&&a.jsx("span",{className:"bg-[#ff4d4d] text-white text-[9px] font-bold px-1.5 rounded ml-1",children:"18+"})}),a.jsx("span",{className:"text-[11px] text-[#aaa] font-medium",children:i})]})]}),p&&a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),k(!N)},className:"text-gray-400 p-2 hover:text-white transition-colors",children:a.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})}),N&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:e=>{e.stopPropagation(),k(!1)}}),a.jsx("div",{className:"absolute right-0 top-8 bg-[#1a1e26] border border-white/10 rounded-lg shadow-xl z-20 overflow-hidden w-32",onClick:e=>e.stopPropagation(),children:a.jsxs("button",{onClick:e=>{f(e),k(!1)},className:"w-full text-left px-4 py-3 text-red-400 hover:bg-white/5 text-sm font-semibold flex items-center gap-2",children:[a.jsx("i",{className:"fa-solid fa-trash-can"})," Excluir"]})})]})]}),a.jsx(l,{isOpen:y,onClose:()=>C(!1),imageSrc:(null==(b=null==j?void 0:j.profile)?void 0:b.photoUrl)||"",username:A})]})},c=({text:e,onUserClick:n,className:s="px-4 mb-3"})=>{const[r,l]=t.useState(3),[i,o]=t.useState(0),[c,d]=t.useState(!0),x=t.useRef(null),p=t.useMemo(()=>e.match(/[^.!?]+[.!?]+(\s+|$)|[^.!?]+$/g)||[e],[e]);t.useEffect(()=>{if(!x.current||i>=p.length)return void(i>=p.length&&d(!1));const e=x.current.scrollHeight;Math.round(e/24)<r&&i<p.length?o(e=>e+1):d(!1)},[i,r,p,e]);const f=i>=p.length,m=!f&&!c,g=f&&p.length>1&&r>3;return a.jsxs("div",{className:s,children:[a.jsx("div",{ref:x,className:"text-[15px] leading-[1.6] whitespace-pre-wrap break-words text-gray-200 font-normal overflow-hidden",children:(u=p.slice(0,i).join(""),u.split(/(@\w+)/g).map((e,t)=>e.startsWith("@")?a.jsx("span",{className:"text-[#00c2ff] font-semibold cursor-pointer hover:underline",onClick:t=>{t.stopPropagation(),n(e)},children:e},t):e))}),m&&a.jsx("button",{onClick:e=>{e.stopPropagation(),d(!0),l(e=>e+3)},className:"text-[#00c2ff] font-bold cursor-pointer text-sm hover:underline bg-transparent border-none p-0 mt-1",children:"Ler mais"}),g&&a.jsx("button",{onClick:e=>{e.stopPropagation(),l(3),o(0),d(!0)},className:"text-[#00c2ff] font-bold cursor-pointer text-sm hover:underline bg-transparent border-none p-0 mt-1",children:"Ler menos"})]});var u},d=({images:e,onImageClick:n})=>{const[s,r]=t.useState(0),l=t.useRef(null);return a.jsxs("div",{className:"relative w-full mb-2.5 overflow-hidden rounded-xl bg-black aspect-[4/5]",children:[a.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 text-white text-xs px-2 py-1 rounded-full z-10 backdrop-blur-sm",children:[s+1,"/",e.length]}),a.jsx("div",{ref:l,className:"flex overflow-x-auto snap-x snap-mandatory no-scrollbar w-full h-full",style:{scrollbarWidth:"none",msOverflowStyle:"none"},onScroll:()=>{if(l.current){const e=l.current.scrollLeft,t=l.current.offsetWidth,a=Math.round(e/t);a!==s&&r(a)}},children:e.map((e,t)=>a.jsx("img",{src:e,loading:"lazy",alt:`Slide ${t}`,className:"w-full h-full flex-shrink-0 snap-center object-cover cursor-pointer",onClick:()=>n&&n(e)},t))}),a.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10",children:e.map((e,t)=>a.jsx("div",{className:"w-1.5 h-1.5 rounded-full transition-all "+(s===t?"bg-[#00c2ff] scale-125":"bg-white/50")},t))})]})},x=({groupId:n})=>{const r=e(),[l,i]=t.useState(null);if(t.useEffect(()=>{const e=s.getGroupById(n);e&&i(e)},[n]),!l)return null;const o=l.isVip;return a.jsxs(a.Fragment,{children:[a.jsx("style",{children:`\n                .group-attachment-card {\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                    background: ${o?"linear-gradient(145deg, rgba(255, 215, 0, 0.05), rgba(0, 0, 0, 0.4))":"linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(0, 0, 0, 0.2))"};\n                    border: ${o?"1px solid rgba(255, 215, 0, 0.3)":"1px solid rgba(255, 255, 255, 0.1)"};\n                    border-radius: 12px;\n                    padding: 12px;\n                    margin: 10px 16px;\n                    cursor: pointer;\n                    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\n                    position: relative;\n                    overflow: hidden;\n                }\n                .group-attachment-card:hover {\n                    background: ${o?"rgba(255, 215, 0, 0.1)":"rgba(255, 255, 255, 0.08)"};\n                    transform: translateY(-2px);\n                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);\n                }\n                .ga-left {\n                    display: flex;\n                    align-items: center;\n                    gap: 12px;\n                    overflow: hidden;\n                    flex: 1;\n                }\n                .ga-cover {\n                    width: 48px;\n                    height: 48px;\n                    border-radius: 12px;\n                    object-fit: cover;\n                    flex-shrink: 0;\n                    border: ${o?"2px solid rgba(255, 215, 0, 0.5)":"1px solid rgba(255,255,255,0.2)"};\n                }\n                .ga-cover.placeholder {\n                    background: #1e2531;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                    color: ${o?"#FFD700":"#555"};\n                    font-size: 20px;\n                }\n                .ga-info {\n                    display: flex;\n                    flex-direction: column;\n                    min-width: 0;\n                    gap: 2px;\n                }\n                .ga-name {\n                    font-weight: 700;\n                    font-size: 15px;\n                    color: #fff;\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                }\n                .ga-type {\n                    font-size: 10px;\n                    color: ${o?"#FFD700":"#aaa"};\n                    text-transform: uppercase;\n                    font-weight: 700;\n                    letter-spacing: 0.5px;\n                    display: flex;\n                    align-items: center;\n                    gap: 5px;\n                }\n                .ga-btn {\n                    background: ${o?"linear-gradient(90deg, #FFD700, #FDB931)":"linear-gradient(90deg, #00c2ff, #0099ff)"};\n                    color: ${o?"#000":"#fff"};\n                    border: none;\n                    padding: 8px 18px;\n                    border-radius: 20px;\n                    font-size: 12px;\n                    font-weight: 800;\n                    cursor: pointer;\n                    transition: all 0.2s;\n                    white-space: nowrap;\n                    margin-left: 10px;\n                    box-shadow: ${o?"0 0 15px rgba(255, 215, 0, 0.2)":"0 0 15px rgba(0, 194, 255, 0.2)"};\n                    text-transform: uppercase;\n                    letter-spacing: 0.5px;\n                }\n                .ga-btn:hover {\n                    transform: scale(1.05);\n                    box-shadow: ${o?"0 0 20px rgba(255, 215, 0, 0.4)":"0 0 20px rgba(0, 194, 255, 0.4)"};\n                }\n                .ga-btn:active {\n                    transform: scale(0.95);\n                }\n                .shine-effect {\n                    position: absolute;\n                    top: 0;\n                    left: -100%;\n                    width: 50%;\n                    height: 100%;\n                    background: linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.05) 50%, rgba(255,255,255,0) 100%);\n                    transform: skewX(-25deg);\n                    animation: shine 4s infinite;\n                    pointer-events: none;\n                }\n                @keyframes shine {\n                    0% { left: -100%; }\n                    20% { left: 200%; }\n                    100% { left: 200%; }\n                }\n            `}),a.jsxs("div",{className:"group-attachment-card",onClick:e=>e.stopPropagation(),children:[o&&a.jsx("div",{className:"shine-effect"}),a.jsxs("div",{className:"ga-left",children:[l.coverImage?a.jsx("img",{src:l.coverImage,className:"ga-cover",alt:"Group"}):a.jsx("div",{className:"ga-cover placeholder",children:a.jsx("i",{className:"fa-solid "+(l.isVip?"fa-crown":"fa-users")})}),a.jsxs("div",{className:"ga-info",children:[a.jsx("div",{className:"ga-name",children:l.name}),a.jsx("div",{className:"ga-type",children:o?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fa-solid fa-lock text-[9px]"})," ÁREA RESTRITA"]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fa-solid fa-user-group text-[9px]"})," COMUNIDADE ATIVA"]})})]})]}),a.jsx("button",{className:"ga-btn",onClick:e=>{e.stopPropagation(),l.isVip?r(`/vip-group-sales/${l.id}`):r(`/group-landing/${l.id}`)},children:"ACESSAR"})]})]})},p=({post:e,onVote:t})=>{if(!e.pollOptions)return null;const n=e.pollOptions.reduce((e,t)=>e+t.votes,0);return a.jsxs("div",{className:"mx-4 mt-2.5 mb-2.5 p-3 bg-[#00c2ff0d] rounded-xl border border-[#00c2ff22]",children:[e.pollOptions.map((s,r)=>{const l=(i=s.votes,0===n?0:Math.round(i/n*100));var i;const o=e.votedOptionIndex===r;return a.jsxs("div",{onClick:()=>t(e.id,r),className:"relative mb-2 p-3 rounded-lg cursor-pointer overflow-hidden font-medium transition-colors "+(o?"bg-[#00c2ff] text-black font-bold":"bg-[#1e2531] hover:bg-[#28303f]"),children:[a.jsx("div",{className:"absolute top-0 left-0 h-full bg-[#00c2ff] opacity-30 z-0 transition-all duration-500",style:{width:`${l}%`}}),a.jsxs("div",{className:"relative z-10 flex justify-between items-center text-sm",children:[a.jsx("span",{children:s.text}),a.jsxs("span",{children:[l,"%"]})]})]},r)}),a.jsxs("div",{className:"text-right text-xs text-gray-500 mt-1",children:[(s=n,s?s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString():"0")," votos"]})]});var s},f=e=>e?e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"k":e.toString():"0",m=({post:e,onLike:t,onCommentClick:n,onShare:s})=>a.jsxs("div",{className:"grid grid-cols-4 px-2 py-3 mt-1 border-t border-white/5 gap-1",children:[a.jsxs("button",{onClick:()=>t(e.id),className:"flex items-center justify-center gap-2 transition-all "+(e.liked?"text-red-500 scale-110":"text-gray-400 hover:text-[#00c2ff]"),children:[a.jsx("i",{className:(e.liked?"fa-solid":"fa-regular")+" fa-heart text-xl"}),a.jsx("span",{className:"text-xs font-semibold",children:f(e.likes)})]}),a.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center justify-center gap-2 text-gray-400 hover:text-[#00c2ff] transition-all",children:[a.jsx("i",{className:"fa-regular fa-comment text-xl"}),a.jsx("span",{className:"text-xs font-semibold",children:f(e.comments)})]}),a.jsx("button",{onClick:()=>s(e),className:"flex items-center justify-center text-gray-400 hover:text-[#00c2ff] transition-all",children:a.jsx("i",{className:"fa-regular fa-paper-plane text-xl"})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400 transition-all cursor-default opacity-70",children:[a.jsx("i",{className:"fa-solid fa-eye text-lg"}),a.jsx("span",{className:"text-xs font-semibold",children:f(e.views)})]})]}),g={conferir:"fa-eye",participar:"fa-user-group",comprar:"fa-cart-shopping",assinar:"fa-credit-card",entrar:"fa-arrow-right-to-bracket",descubra:"fa-compass",baixar:"fa-download","saiba mais":"fa-circle-info"},u=({post:e,currentUserId:n,onLike:s,onDelete:r,onUserClick:l,onCommentClick:f,onShare:u,onVote:h,onCtaClick:b})=>{const[v,j]=t.useState(null),w="video"===e.type||"photo"===e.type&&(!!e.image||e.images&&e.images.length>0);return a.jsxs("div",{"data-post-id":e.id,className:"feed-post-item relative bg-[#1a1e26] border border-white/5 rounded-2xl pb-2 mb-6 shadow-lg overflow-hidden animate-fade-in",children:[a.jsx(o,{username:e.username,authorEmail:e.authorEmail,time:i.formatRelativeTime(e.timestamp),location:e.location,isAdult:e.isAdultContent,isAd:e.isAd,onClick:()=>l(e.username),isOwner:!!n&&e.authorId===n,onDelete:t=>r(t,e.id)}),a.jsx(c,{text:e.text||"",onUserClick:l}),"photo"===e.type&&a.jsx("div",{className:"w-full overflow-hidden bg-black mb-0",children:e.images&&e.images.length>1?a.jsx(d,{images:e.images,onImageClick:j}):e.image&&a.jsx("img",{src:e.image,loading:"lazy",alt:"Post content",className:"w-full h-auto max-h-[600px] object-contain cursor-pointer",onClick:()=>j(e.image)})}),"video"===e.type&&e.video&&a.jsx("div",{className:"w-full overflow-hidden bg-black mb-0",children:a.jsx("video",{src:e.video,controls:!0,className:"w-full h-auto max-h-[600px] object-contain"})}),e.isAd&&e.ctaLink?a.jsxs("div",{className:"bg-[#00c2ff]/10 p-4 px-5 flex justify-between items-center border-[#00c2ff]/20 transition-all "+(w?"w-full border-t mb-0":"mx-4 mb-4 rounded-xl border"),children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-[#00c2ff] font-black tracking-[2px] uppercase",children:"Patrocinado"}),a.jsx("span",{className:"text-[11px] text-gray-400 font-bold",children:"Sugestão Flux"})]}),a.jsxs("button",{className:"bg-[#00c2ff] text-black border-none px-6 py-2.5 rounded-xl text-xs font-black flex items-center gap-2.5 hover:bg-white transition-all shadow-[0_4px_15px_rgba(0,194,255,0.3)] active:scale-95",onClick:()=>b(e.ctaLink),children:[a.jsx("i",{className:`fa-solid ${((e="")=>{const t=e.toLowerCase();return g[t]||"fa-arrow-right"})(e.ctaText)}`}),a.jsx("span",{className:"uppercase",children:e.ctaText||"Saiba Mais"})]})]}):e.relatedGroupId&&a.jsx("div",{className:"mt-2 mb-2",children:a.jsx(x,{groupId:e.relatedGroupId})}),"poll"===e.type&&a.jsx(p,{post:e,onVote:h}),a.jsx(m,{post:e,onLike:s,onCommentClick:f,onShare:u}),v&&a.jsxs("div",{className:"fixed inset-0 z-[60] bg-black bg-opacity-95 flex items-center justify-center p-2",onClick:()=>j(null),children:[a.jsx("button",{className:"absolute top-4 right-4 text-white text-4xl bg-black/50 rounded-full w-10 h-10 flex items-center justify-center",onClick:()=>j(null),children:"×"}),a.jsx("img",{src:v,alt:"Zoom",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:e=>e.stopPropagation()})]})]})};export{u as F};
