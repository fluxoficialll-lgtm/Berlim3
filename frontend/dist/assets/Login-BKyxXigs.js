import{j as e,L as t,u as a,a as s,r as l,l as r,b as o,t as i,c as n,A as c}from"./index-CipjSFYz.js";const d=({onSelectEmail:a,googleButtonId:s,loading:l,googleProcessing:r})=>e.jsxs("div",{className:"w-full flex flex-col items-center animate-fade-in",children:[e.jsxs("div",{className:"mb-8 w-[80px] h-[80px] bg-white/5 rounded-2xl flex items-center justify-center relative border border-white/10 shadow-[0_0_30px_rgba(0,194,255,0.2)]",children:[e.jsx("div",{className:"absolute w-[50px] h-[28px] rounded-[50%] border-[4px] border-[#00c2ff] rotate-[25deg]"}),e.jsx("div",{className:"absolute w-[50px] h-[28px] rounded-[50%] border-[4px] border-[#00c2ff] -rotate-[25deg]"})]}),e.jsx("h1",{className:"text-3xl font-bold text-center mb-3 text-white",children:"Flux"}),e.jsx("p",{className:"text-gray-400 text-sm text-center mb-8 leading-relaxed",children:"Sua plataforma de conexão e conteúdo."}),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"relative min-h-[50px]",children:[e.jsxs("div",{className:"w-full h-[50px] bg-white text-gray-700 border border-gray-300 rounded-lg font-bold flex items-center justify-center gap-3 shadow-sm pointer-events-none",children:[e.jsx("i",{className:"fa-brands fa-google text-lg"}),e.jsx("span",{className:"text-sm",children:"Entrar com Google"})]}),e.jsx("div",{id:s,className:"absolute inset-0 z-10 opacity-0 overflow-hidden cursor-pointer"})]}),e.jsxs("button",{onClick:a,className:"w-full py-3.5 bg-white/5 border border-white/10 text-white font-bold rounded-lg hover:bg-white/10 transition-all flex items-center justify-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-envelope"}),"Entrar com E-mail e Senha"]})]}),e.jsxs("div",{className:"mt-8 flex flex-col gap-3 items-center text-sm w-full",children:[e.jsx("div",{className:"w-full h-[1px] bg-white/5"}),e.jsxs("div",{className:"flex gap-6 mt-2",children:[e.jsx(t,{to:"/register",className:"text-[#00c2ff] hover:underline font-semibold",children:"Criar conta"}),e.jsx("span",{className:"text-gray-700",children:"|"}),e.jsx(t,{to:"/forgot-password",title:"Esqueci a senha",className:"text-gray-400 hover:text-white transition-colors",children:"Esqueci a senha"})]})]})]}),x=({email:a,setEmail:s,password:l,setPassword:r,onSubmit:o,onBackToGoogle:i,loading:n,error:c})=>e.jsxs("div",{className:"w-full animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"mb-4 w-[60px] h-[60px] bg-white/5 rounded-xl flex items-center justify-center relative border border-white/10",children:[e.jsx("div",{className:"absolute w-[35px] h-[20px] rounded-[50%] border-[3px] border-[#00c2ff] rotate-[25deg]"}),e.jsx("div",{className:"absolute w-[35px] h-[20px] rounded-[50%] border-[3px] border-[#00c2ff] -rotate-[25deg]"})]}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Acesse sua conta"}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Insira suas credenciais abaixo"})]}),c&&e.jsxs("div",{className:"mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-red-400 text-xs text-center animate-shake",children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation mr-2"}),c]}),e.jsxs("form",{onSubmit:o,className:"w-full space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-at absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-sm"}),e.jsx("input",{type:"email",placeholder:"E-mail",value:a,onChange:e=>s(e.target.value),className:"w-full p-3.5 pl-11 bg-black/20 border border-white/10 rounded-xl text-white outline-none focus:border-[#00c2ff] transition-all placeholder-gray-600",required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 text-sm"}),e.jsx("input",{type:"password",placeholder:"Senha",value:l,onChange:e=>r(e.target.value),className:"w-full p-3.5 pl-11 bg-black/20 border border-white/10 rounded-xl text-white outline-none focus:border-[#00c2ff] transition-all placeholder-gray-600",required:!0})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full py-4 bg-[#00c2ff] text-black font-black rounded-xl hover:bg-[#00aaff] transition-all shadow-lg shadow-[#00c2ff]/20 disabled:opacity-50 active:scale-[0.98]",children:n?e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin"}):"ENTRAR"})]}),e.jsxs("div",{className:"mt-6 flex flex-col items-center gap-4",children:[e.jsxs("button",{onClick:i,className:"text-sm font-bold text-[#00c2ff] hover:text-white transition-colors flex items-center gap-2",children:[e.jsx("i",{className:"fa-brands fa-google"}),"Entrar com Google"]}),e.jsx("div",{className:"w-full h-[1px] bg-white/5"}),e.jsxs("div",{className:"flex gap-4 text-xs font-semibold",children:[e.jsx(t,{to:"/register",className:"text-gray-400 hover:text-[#00c2ff] transition-colors",children:"CRIAR CONTA"}),e.jsx("span",{className:"text-gray-800",children:"•"}),e.jsx(t,{to:"/forgot-password",title:"Esqueci a senha",className:"text-gray-400 hover:text-white transition-colors",children:"RECUPERAR SENHA"})]})]})]}),f=()=>{const t=a(),f=s(),[u,m]=l.useState(!1),[h,g]=l.useState(null),b=l.useRef(!1),p=l.useCallback(async e=>{if(!b.current){b.current=!0,r.info(o.AUTH,"Tentativa de login com Google iniciada"),m(!0),g(null);try{const a=i.getAffiliateRef()||void 0,s=await n.loginWithGoogle(e,a);if(!(s&&s.user&&s.nextStep))throw new Error("Resposta de autenticação inválida do servidor.");r.info(o.AUTH,"Login com Google bem-sucedido, navegando",{userId:s.user.id,nextStep:s.nextStep}),t(s.nextStep,{replace:!0})}catch(a){r.error(o.AUTH,"Falha no login com Google",a),g(a.message||"Falha ao autenticar com Google."),m(!1),b.current=!1}}},[t]),w=l.useCallback(async(e,a)=>{if(!b.current){b.current=!0,m(!0),g(null);try{const s=await n.login(e,a);if(!(s&&s.user&&s.nextStep))throw new Error("Resposta de autenticação de e-mail inválida.");t(s.nextStep,{replace:!0})}catch(s){g(s.message||"Credenciais de e-mail inválidas."),m(!1),b.current=!1}}},[t]),[v,j]=l.useState(!0),[N,y]=l.useState(!1),[E,S]=l.useState(""),[k,A]=l.useState(""),C="googleButtonDiv";l.useEffect(()=>{i.captureUrlParams()},[f]),l.useEffect(()=>{n.isAuthenticated()?t("/feed",{replace:!0}):j(!1)},[t]);const R=l.useCallback(e=>{(null==e?void 0:e.credential)?p(e.credential):r.error(o.AUTH,"Resposta de credencial do Google inválida",e)},[p]);return l.useEffect(()=>{if(v||N)return;let e=!0;return(async()=>{try{const t=await fetch(`${c}/api/auth/config`),a=(await t.json()).clientId;if(!e||!a||a.includes("CONFIGURADO"))return;const s=setInterval(()=>{const e=document.getElementById(C);"undefined"!=typeof google&&google.accounts&&e&&(clearInterval(s),google.accounts.id.initialize({client_id:a,callback:R,auto_select:!1}),google.accounts.id.renderButton(e,{theme:"filled_black",size:"large",width:"400"}))},100)}catch(t){r.error(o.AUTH,"Falha ao inicializar Google Client",t)}})(),()=>{e=!1}},[v,N,R]),v?null:e.jsxs("div",{className:"min-h-screen w-full flex flex-col items-center justify-center bg-[#050505] text-white font-['Inter'] relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-20%] left-[-10%] w-[600px] h-[600px] bg-blue-900/10 rounded-full blur-[120px]"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[500px] h-[500px] bg-indigo-900/10 rounded-full blur-[100px]"})]}),e.jsxs("div",{className:"w-full max-w-[400px] mx-4 bg-white/5 backdrop-blur-2xl rounded-[32px] p-10 border border-white/10 shadow-2xl relative z-10 flex flex-col items-center",children:[N?e.jsx(x,{email:E,setEmail:S,password:k,setPassword:A,onSubmit:e=>{e.preventDefault(),w(E,k)},onBackToGoogle:()=>y(!1),loading:u,error:h||""}):e.jsx(d,{onSelectEmail:()=>y(!0),googleButtonId:C,loading:v,googleProcessing:u}),u&&e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm rounded-[32px] flex items-center justify-center z-50",children:e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-[#00c2ff] text-2xl"})})]})]})};export{f as Login};
