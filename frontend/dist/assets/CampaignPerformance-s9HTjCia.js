import{j as e,u as B,f as L,e as P,r as c,h as y}from"./index-BC19Iu_T.js";import{A as I,C as O}from"./AdPreview-0jQ92R6c.js";import"./FeedItem-DGLoJJDB.js";import"./UserBadge-CHMRiDZl.js";import"./UserAvatar-BWaKHm2D.js";import"./postService-XFLx8Vj8.js";import"./ProductCard-CO49MvpN.js";const q=({campaign:a})=>{const r=o=>o.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});return e.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 mb-8 shadow-xl animate-fade-in",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-[#00c2ff] tracking-widest mb-1",children:"Configuração da Campanha"}),e.jsx("h2",{className:"text-xl font-bold text-white leading-tight",children:a.name})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wider ${a.status==="active"?"bg-[#00ff82]/10 text-[#00ff82] border border-[#00ff82]/20":"bg-gray-500/10 text-gray-400 border border-gray-500/20"}`,children:a.status==="active"?"Veiculando":"Finalizada"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-4 border-y border-white/5",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-tight",children:"Orçamento Total"}),e.jsx("span",{className:"text-lg font-bold text-white",children:a.pricingModel==="commission"?e.jsx("span",{className:"text-[#FFD700]",children:"CPA (Comissão)"}):r(a.budget||0)})]}),e.jsxs("div",{className:"flex flex-col gap-1 text-right",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-tight",children:"Duração"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-200 flex items-center justify-end gap-2",children:[e.jsx("i",{className:`fa-solid ${a.scheduleType==="continuous"?"fa-infinity text-[#00c2ff]":"fa-calendar-day"}`}),a.scheduleType==="continuous"?"Contínua":"Data Fixa"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-tight",children:"Legenda / Criativo"}),e.jsxs("div",{className:"bg-black/20 p-4 rounded-xl border border-white/5 italic text-sm text-gray-300 leading-relaxed",children:['"',a.creative?.text,'"']})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-bullseye text-[#ff4d4d] text-xs"}),e.jsx("span",{className:"text-[11px] font-bold text-gray-400 uppercase",children:a.campaignObjective})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-map-pin text-[#00c2ff] text-xs"}),e.jsx("span",{className:"text-[11px] font-bold text-gray-400 uppercase",children:a.placements?.join(" • ")})]})]})]})})},i=({label:a,value:r,trend:o,description:f,icon:u})=>e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 flex flex-col gap-1 hover:border-white/20 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-gray-500 tracking-widest",children:a}),u&&e.jsx("i",{className:`${u} text-[#00c2ff] opacity-40 text-xs`})]}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsx("span",{className:"text-xl font-bold text-white",children:r}),o&&e.jsxs("span",{className:`text-[10px] font-bold ${o.isUp?"text-[#00ff82]":"text-red-400"}`,children:[e.jsx("i",{className:`fa-solid fa-caret-${o.isUp?"up":"down"} mr-0.5`}),o.val]})]}),f&&e.jsx("p",{className:"text-[9px] text-gray-600 leading-tight mt-1",children:f})]}),V=({data:a})=>e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsx(i,{label:"Impressões",value:a.impressions.toLocaleString(),icon:"fa-solid fa-eye",description:"Total de vezes que o anúncio foi renderizado."}),e.jsx(i,{label:"Alcance",value:a.reach.toLocaleString(),icon:"fa-solid fa-users",description:"Pessoas únicas que viram o anúncio."}),e.jsx(i,{label:"Frequência",value:`${a.frequency}x`,icon:"fa-solid fa-repeat",description:"Média de visualizações por pessoa."}),e.jsx(i,{label:"CPM",value:`R$ ${a.cpm.toFixed(2)}`,icon:"fa-solid fa-money-bill-1",description:"Custo médio para cada 1.000 impressões."})]}),G=({data:a})=>e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsx(i,{label:"Cliques",value:a.clicks.toLocaleString(),icon:"fa-solid fa-arrow-pointer"}),e.jsx(i,{label:"CTR",value:`${a.ctr.toFixed(2)}%`,trend:{val:"0.4%",isUp:!0},icon:"fa-solid fa-percent",description:"Relação entre cliques e impressões."}),e.jsx(i,{label:"CPC",value:`R$ ${a.cpc.toFixed(2)}`,icon:"fa-solid fa-tag"}),e.jsx(i,{label:"Engajamento",value:`${a.engagement.toFixed(1)}%`,icon:"fa-solid fa-heart",description:"Interações sobre impressões totais."})]}),_=({data:a})=>e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsx(i,{label:"Conversões",value:a.conversions,icon:"fa-solid fa-trophy",description:"Ações de compra ou assinatura concluídas."}),e.jsx(i,{label:"Taxa Conv.",value:`${a.conversionRate.toFixed(2)}%`,icon:"fa-solid fa-bullseye"}),e.jsx(i,{label:"CPA",value:`R$ ${a.cpa.toFixed(2)}`,icon:"fa-solid fa-hand-holding-dollar",description:"Custo por cada conversão realizada."}),e.jsx(i,{label:"Valor Total",value:`R$ ${a.conversionValue.toFixed(2)}`,icon:"fa-solid fa-coins"})]}),W=({data:a})=>{const r=o=>`R$ ${o.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsx(i,{label:"Valor Investido",value:r(a.totalBudget||0),icon:"fa-solid fa-wallet",description:"Orçamento total alocado para esta campanha."}),e.jsx(i,{label:"Valor Usado",value:r(a.spent||0),icon:"fa-solid fa-chart-pie",trend:{val:`${(a.spent/a.totalBudget*100).toFixed(1)}%`,isUp:!0},description:"Total consumido do orçamento até o momento."}),e.jsx(i,{label:"ROAS",value:`${a.roas.toFixed(1)}x`,icon:"fa-solid fa-chart-line",description:"Retorno sobre investimento direto."}),e.jsx(i,{label:"ROI",value:`${a.roi.toFixed(0)}%`,icon:"fa-solid fa-sack-dollar",description:"Lucro líquido sobre o gasto."}),e.jsx(i,{label:"Ticket Médio",value:`R$ ${a.avgTicket.toFixed(2)}`,icon:"fa-solid fa-receipt"}),e.jsx(i,{label:"LTV Est.",value:`R$ ${a.ltv.toFixed(2)}`,icon:"fa-solid fa-infinity",description:"Valor estimado do cliente a longo prazo."})]})},ee=()=>{const a=B(),{id:r}=L(),{showAlert:o,showOptions:f}=P(),[u,C]=c.useState(!0),[b,w]=c.useState(!1),[s,k]=c.useState(null),[x,A]=c.useState(null),[F,h]=c.useState(null),[l,R]=c.useState("feed"),[p,$]=c.useState(""),[m,j]=c.useState(""),[g,v]=c.useState(void 0),[T,N]=c.useState("image"),S=n=>n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),U=c.useMemo(()=>s?p!==s.creative?.text||m!==(s.placementCtas?.[l]||s.ctaButton)||g!==(s.placementCreatives?.[l]?.mediaUrl||s.creative?.mediaUrl):!1,[s,p,m,g,l]);c.useEffect(()=>{(async()=>{if(!r){a("/my-store");return}C(!0),h(null);try{const t=y.getCampaignById(r);if(t){k(t),$(t.creative?.text||""),j(t.placementCtas?.[l]||t.ctaButton||"saiba mais"),v(t.placementCreatives?.[l]?.mediaUrl||t.creative?.mediaUrl),N(t.placementCreatives?.[l]?.mediaType||t.creative?.mediaType||"image");const d=await y.getCampaignPerformance(r);d?A(d):h("Não foi possível processar as métricas desta campanha.")}else h("Campanha não encontrada no banco de dados.")}catch(t){console.error("Dashboard error:",t),h("Ocorreu um erro ao sincronizar os dados.")}finally{C(!1)}})()},[r,a]),c.useEffect(()=>{s&&(j(s.placementCtas?.[l]||s.ctaButton||"saiba mais"),v(s.placementCreatives?.[l]?.mediaUrl||s.creative?.mediaUrl),N(s.placementCreatives?.[l]?.mediaType||s.creative?.mediaType||"image"))},[l,s]);const D=n=>{const t=n.target.files?.[0];if(t){const d=new FileReader;d.onload=z=>{v(z.target?.result),N(t.type.startsWith("video/")?"video":"image")},d.readAsDataURL(t)}},M=async()=>{if(!(!r||!s||b)){w(!0);try{const n={creative:{...s.creative,text:p},placementCtas:{...s.placementCtas,[l]:m},placementCreatives:{...s.placementCreatives,[l]:{mediaUrl:g,mediaType:T}}};await y.updateCampaign(r,n),k({...s,...n}),await o("Sucesso","Criativo atualizado com sucesso na rede Flux Ads.")}catch{await o("Erro","Falha ao atualizar o anúncio.")}finally{w(!1)}}},E=async()=>{const n=O.map(d=>({label:d.label,value:d.label,icon:`fa-solid ${d.icon}`})),t=await f("Escolher Ação",n);t&&j(t)};return e.jsxs("div",{className:"min-h-screen bg-[#0a0c10] text-white font-['Inter'] pb-12",children:[e.jsx("style",{children:`
                .edit-section {
                    background: #15191f; border: 1px solid rgba(255,255,255,0.05);
                    border-radius: 24px; padding: 24px; margin-bottom: 30px;
                }
                .update-btn {
                    width: 100%; padding: 16px; background: #00c2ff; color: #000;
                    border-radius: 14px; font-weight: 900; font-size: 13px;
                    text-transform: uppercase; letter-spacing: 1px; transition: 0.3s;
                    box-shadow: 0 4px 20px rgba(0,194,255,0.3); margin-top: 20px;
                }
                .update-btn:disabled { background: #333; color: #555; box-shadow: none; cursor: not-allowed; }
                .edit-input {
                    width: 100%; background: #0a0c10; border: 1px solid rgba(255,255,255,0.1);
                    padding: 14px; border-radius: 12px; color: #fff; font-size: 14px; outline: none; transition: 0.3s;
                }
                .edit-input:focus { border-color: #00c2ff; }
                .highlight-card {
                    background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.01) 100%);
                    border: 1px solid rgba(255,255,255,0.08);
                    border-radius: 20px;
                    padding: 20px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                    position: relative;
                    overflow: hidden;
                }
                .highlight-card.invested { border-left: 4px solid #00ff82; }
                .highlight-card.used { border-left: 4px solid #ff4d4d; }
            `}),e.jsxs("header",{className:"flex items-center gap-4 p-4 bg-[#0c0f14] sticky top-0 z-50 border-b border-white/10 h-[65px]",children:[e.jsx("button",{onClick:()=>a(-1),className:"text-[#00c2ff] text-xl p-2 hover:bg-white/5 rounded-full transition-all",children:e.jsx("i",{className:"fa-solid fa-arrow-left"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Dashboard de Performance"}),e.jsx("span",{className:"text-base font-bold text-white truncate max-w-[200px]",children:s?.name||"Carregando..."})]})]}),e.jsx("main",{className:"p-5 max-w-[600px] mx-auto",children:u?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50",children:[e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin text-2xl text-[#00c2ff] mb-2"}),e.jsx("p",{className:"text-[10px] uppercase font-bold tracking-widest",children:"Sincronizando Flux de Dados..."})]}):F?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("i",{className:"fa-solid fa-triangle-exclamation text-4xl text-red-500 mb-4 opacity-50"}),e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Ops! Algo deu errado"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6 px-10",children:F}),e.jsx("button",{onClick:()=>a("/my-store"),className:"text-[#00c2ff] font-bold uppercase text-xs tracking-widest underline",children:"Voltar para meus negócios"})]}):s?e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(q,{campaign:s}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-8",children:[e.jsxs("div",{className:"highlight-card invested shadow-lg animate-slide-up",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Grana Investida"}),e.jsx("div",{className:"text-xl font-black text-white",children:S(x.financial.totalBudget||0)}),e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx("i",{className:"fa-solid fa-wallet text-4xl"})})]}),e.jsxs("div",{className:"highlight-card used shadow-lg animate-slide-up",style:{animationDelay:"0.1s"},children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Grana Usada"}),e.jsx("div",{className:"text-xl font-black text-white",children:S(x.financial.spent||0)}),e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx("i",{className:"fa-solid fa-chart-pie text-4xl"})})]})]}),e.jsxs("section",{className:"mb-12",children:[e.jsxs("h2",{className:"text-[10px] font-black text-[#FFD700] uppercase tracking-[2px] mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-[#FFD700] rounded-full"}),"Gestão de Criativos"]}),e.jsx(I,{campaign:{...s,creative:{text:p,mediaUrl:g,mediaType:T},placementCtas:{...s.placementCtas,[l]:m}},previewTab:l,setPreviewTab:R,destinationMode:s.destinationType||"url"}),e.jsxs("div",{className:"edit-section mt-6 animate-fade-in",children:[e.jsx("h3",{className:"text-xs font-black text-gray-500 uppercase tracking-widest mb-4",children:"Ajustar Comunicação"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase mb-2 block",children:"Legenda (Copy)"}),e.jsx("textarea",{className:"edit-input min-h-[100px] resize-none",value:p,onChange:n=>$(n.target.value),placeholder:"Sua legenda impactante..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase mb-2 block",children:"Mídia do Anúncio"}),e.jsxs("button",{onClick:()=>document.getElementById("edit-file-input")?.click(),className:"w-full py-3.5 bg-black/20 border border-white/10 rounded-xl text-xs font-bold text-white hover:border-[#00c2ff] transition-all",children:[e.jsx("i",{className:"fa-solid fa-cloud-arrow-up mr-2 text-[#00c2ff]"})," Alterar"]}),e.jsx("input",{type:"file",id:"edit-file-input",hidden:!0,accept:"image/*,video/*",onChange:D})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black text-gray-600 uppercase mb-2 block",children:"Botão de Ação"}),e.jsxs("button",{onClick:E,className:"w-full py-3.5 bg-black/20 border border-white/10 rounded-xl text-xs font-bold text-white hover:border-[#00c2ff] transition-all flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-mouse-pointer text-[#00c2ff]"})," ",m.toUpperCase()]})]})]}),e.jsx("button",{className:"update-btn",disabled:!U||b,onClick:M,children:b?e.jsx("i",{className:"fa-solid fa-circle-notch fa-spin mr-2"}):"Salvar Alterações no Criativo"})]})]})]}),e.jsxs("section",{className:"mb-8",children:[e.jsxs("h2",{className:"text-[10px] font-black text-[#00c2ff] uppercase tracking-[2px] mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-[#00c2ff] rounded-full"}),"Entrega e Alcance"]}),e.jsx(V,{data:x.delivery})]}),e.jsxs("section",{className:"mb-8",children:[e.jsxs("h2",{className:"text-[10px] font-black text-[#00c2ff] uppercase tracking-[2px] mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-[#00c2ff] rounded-full"}),"Cliques e Relevância"]}),e.jsx(G,{data:x.click})]}),e.jsxs("section",{className:"mb-8",children:[e.jsxs("h2",{className:"text-[10px] font-black text-[#00ff82] uppercase tracking-[2px] mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-[#00ff82] rounded-full"}),"Conversão"]}),e.jsx(_,{data:x.conversion})]}),e.jsxs("section",{className:"mb-8",children:[e.jsxs("h2",{className:"text-[10px] font-black text-[#FFD700] uppercase tracking-[2px] mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-3 bg-[#FFD700] rounded-full"}),"Métricas Financeiras"]}),e.jsx(W,{data:x.financial})]}),e.jsx("div",{className:"bg-white/5 p-5 rounded-2xl border border-dashed border-white/10 text-center opacity-40",children:e.jsxs("p",{className:"text-[10px] text-gray-500 uppercase font-black tracking-[2px] leading-relaxed",children:[e.jsx("i",{className:"fa-solid fa-shield-halved mr-1"})," Dados auditados via Flux API."]})})]}):null})]})};export{ee as CampaignPerformance};
